(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},92048:e=>{"use strict";e.exports=require("fs")},76162:e=>{"use strict";e.exports=require("stream")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},86513:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>h}),i(90908),i(17781),i(35866);var r=i(23191),s=i(88716),n=i(37922),a=i.n(n),o=i(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);i.d(t,l);let h=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,90908)),"/var/www/flask_app/ast_chat/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,17781)),"/var/www/flask_app/ast_chat/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/var/www/flask_app/ast_chat/app/page.tsx"],d="/page",u={require:i,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:h}})},71834:(e,t,i)=>{Promise.resolve().then(i.bind(i,23295))},23295:(e,t,i)=>{"use strict";let r;i.r(t),i.d(t,{default:()=>a1});var s,n,a=i(10326),o=i(17577),l=i(90772),h=i(54432),c=i(77863);let d=o.forwardRef(({className:e,...t},i)=>a.jsx("textarea",{className:(0,c.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...t}));d.displayName="Textarea";var u=i(33071),p=i(34474),m=i(82561),f=i(93095),g=i(52067),y=i(65819),v=i(48051),x=i(45226),b=i(9815),w=i(88957),k="Collapsible",[T,C]=(0,f.b)(k),[j,E]=T(k),P=o.forwardRef((e,t)=>{let{__scopeCollapsible:i,open:r,defaultOpen:s,disabled:n,onOpenChange:l,...h}=e,[c,d]=(0,g.T)({prop:r,defaultProp:s??!1,onChange:l,caller:k});return(0,a.jsx)(j,{scope:i,disabled:n,contentId:(0,w.M)(),open:c,onOpenToggle:o.useCallback(()=>d(e=>!e),[d]),children:(0,a.jsx)(x.WV.div,{"data-state":R(c),"data-disabled":n?"":void 0,...h,ref:t})})});P.displayName=k;var A="CollapsibleTrigger",_=o.forwardRef((e,t)=>{let{__scopeCollapsible:i,...r}=e,s=E(A,i);return(0,a.jsx)(x.WV.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":R(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:t,onClick:(0,m.M)(e.onClick,s.onOpenToggle)})});_.displayName=A;var S="CollapsibleContent",N=o.forwardRef((e,t)=>{let{forceMount:i,...r}=e,s=E(S,e.__scopeCollapsible);return(0,a.jsx)(b.z,{present:i||s.open,children:({present:e})=>(0,a.jsx)(M,{...r,ref:t,present:e})})});N.displayName=S;var M=o.forwardRef((e,t)=>{let{__scopeCollapsible:i,present:r,children:s,...n}=e,l=E(S,i),[h,c]=o.useState(r),d=o.useRef(null),u=(0,v.e)(t,d),p=o.useRef(0),m=p.current,f=o.useRef(0),g=f.current,b=l.open||h,w=o.useRef(b),k=o.useRef(void 0);return o.useEffect(()=>{let e=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,y.b)(()=>{let e=d.current;if(e){k.current=k.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();p.current=t.height,f.current=t.width,w.current||(e.style.transitionDuration=k.current.transitionDuration,e.style.animationName=k.current.animationName),c(r)}},[l.open,r]),(0,a.jsx)(x.WV.div,{"data-state":R(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!b,...n,ref:u,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:b&&s})});function R(e){return e?"open":"closed"}var D=i(80851);let I=(0,D.Z)("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),L=(0,D.Z)("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h0.01",key:"hsw7lv"}],["path",{d:"M12 4h0.01",key:"1e3d8f"}],["path",{d:"M17 4h0.01",key:"p7cxgy"}]]),O=(0,D.Z)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),B=(0,D.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),V=(0,D.Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),F=(0,D.Z)("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),$=(0,D.Z)("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),U=(0,D.Z)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),z=(0,D.Z)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),Y=(0,D.Z)("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]),H=(0,D.Z)("Church",[["path",{d:"m18 7 4 2v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9l4-2",key:"gy5gyo"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 22V5l-6-3-6 3v17",key:"1hsnhq"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M10 9h4",key:"u4k05v"}]]),W=(0,D.Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),q=(0,D.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Z=(0,D.Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var G=i(12714);let K=(0,D.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var J=i(1572);let Q=(0,D.Z)("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),X=(0,D.Z)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var ee=i(94019),et=i(88378),ei=i(941);let er=(0,D.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var es=i(82685);let en=(0,D.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var ea=i(90434),eo=i(85999),el=i(567),eh=i(62288),ec=i(77506),ed=i(30361),eu=i(41291);let ep=(0,D.Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),em=(0,D.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),ef=(0,D.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),eg=(0,D.Z)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),ey=(0,D.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var ev=i(39183);let ex=(0,D.Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),eb=(0,D.Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var ew=i(43810);let ek=(0,D.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);function eT(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function eC(e){let t=[{},{}];return e?.values.forEach((e,i)=>{t[0][i]=e.get(),t[1][i]=e.getVelocity()}),t}function ej(e,t,i,r){if("function"==typeof t){let[s,n]=eC(r);t=t(void 0!==i?i:e.custom,s,n)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[s,n]=eC(r);t=t(void 0!==i?i:e.custom,s,n)}return t}function eE(e,t,i){let r=e.getProps();return ej(r,t,void 0!==i?i:r.custom,e)}function eP(e,t){return e?.[t]??e?.default??e}let eA=e=>e,e_={},eS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],eN={value:null,addProjectionMetrics:null};function eM(e,t){let i=!1,r=!0,s={delta:0,timestamp:0,isProcessing:!1},n=()=>i=!0,a=eS.reduce((e,i)=>(e[i]=function(e,t){let i=new Set,r=new Set,s=!1,n=!1,a=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1},l=0;function h(t){a.has(t)&&(c.schedule(t),e()),l++,t(o)}let c={schedule:(e,t=!1,n=!1)=>{let o=n&&s?i:r;return t&&a.add(e),o.has(e)||o.add(e),e},cancel:e=>{r.delete(e),a.delete(e)},process:e=>{if(o=e,s){n=!0;return}s=!0,[i,r]=[r,i],i.forEach(h),t&&eN.value&&eN.value.frameloop[t].push(l),l=0,i.clear(),s=!1,n&&(n=!1,c.process(e))}};return c}(n,t?i:void 0),e),{}),{setup:o,read:l,resolveKeyframes:h,preUpdate:c,update:d,preRender:u,render:p,postRender:m}=a,f=()=>{let n=e_.useManualTiming?s.timestamp:performance.now();i=!1,e_.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(n-s.timestamp,40),1)),s.timestamp=n,s.isProcessing=!0,o.process(s),l.process(s),h.process(s),c.process(s),d.process(s),u.process(s),p.process(s),m.process(s),s.isProcessing=!1,i&&t&&(r=!1,e(f))},g=()=>{i=!0,r=!0,s.isProcessing||e(f)};return{schedule:eS.reduce((e,t)=>{let r=a[t];return e[t]=(e,t=!1,s=!1)=>(i||g(),r.schedule(e,t,s)),e},{}),cancel:e=>{for(let t=0;t<eS.length;t++)a[eS[t]].cancel(e)},state:s,steps:a}}let{schedule:eR,cancel:eD,state:eI,steps:eL}=eM("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:eA,!0),eO=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],eB=new Set(eO),eV=new Set(["width","height","top","left","right","bottom",...eO]);function eF(e,t){-1===e.indexOf(t)&&e.push(t)}function e$(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}class eU{constructor(){this.subscriptions=[]}add(e){return eF(this.subscriptions,e),()=>e$(this.subscriptions,e)}notify(e,t,i){let r=this.subscriptions.length;if(r){if(1===r)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){let r=this.subscriptions[s];r&&r(e,t,i)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ez(){r=void 0}let eY={now:()=>(void 0===r&&eY.set(eI.isProcessing||e_.useManualTiming?eI.timestamp:performance.now()),r),set:e=>{r=e,queueMicrotask(ez)}},eH=e=>!isNaN(parseFloat(e)),eW={current:void 0};class eq{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(e,t=!0)=>{let i=eY.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let e of this.dependents)e.dirty();t&&this.events.renderRequest?.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=eY.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=eH(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new eU);let i=this.events[e].add(t);return"change"===e?()=>{i(),eR.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return eW.current&&eW.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=eY.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let i=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),i?1e3/i*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function eZ(e,t){return new eq(e,t)}let eG=e=>Array.isArray(e),eK=e=>!!(e&&e.getVelocity);function eJ(e,t){let i=e.getValue("willChange");if(eK(i)&&i.add)return i.add(t);if(!i&&e_.WillChange){let i=new e_.WillChange("auto");e.addValue("willChange",i),i.add(t)}}let eQ=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),eX="data-"+eQ("framerAppearId"),e0=(e,t)=>i=>t(e(i)),e1=(...e)=>e.reduce(e0),e2=(e,t,i)=>i>t?t:i<e?e:i,e3=e=>1e3*e,e4=e=>e/1e3,e5={layout:0,mainThread:0,waapi:0},e6=()=>{},e8=()=>{},e7=e=>t=>"string"==typeof t&&t.startsWith(e),e9=e7("--"),te=e7("var(--"),tt=e=>!!te(e)&&ti.test(e.split("/*")[0].trim()),ti=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,tr={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},ts={...tr,transform:e=>e2(0,1,e)},tn={...tr,default:1},ta=e=>Math.round(1e5*e)/1e5,to=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,tl=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,th=(e,t)=>i=>!!("string"==typeof i&&tl.test(i)&&i.startsWith(e)||t&&null!=i&&Object.prototype.hasOwnProperty.call(i,t)),tc=(e,t,i)=>r=>{if("string"!=typeof r)return r;let[s,n,a,o]=r.match(to);return{[e]:parseFloat(s),[t]:parseFloat(n),[i]:parseFloat(a),alpha:void 0!==o?parseFloat(o):1}},td=e=>e2(0,255,e),tu={...tr,transform:e=>Math.round(td(e))},tp={test:th("rgb","red"),parse:tc("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:r=1})=>"rgba("+tu.transform(e)+", "+tu.transform(t)+", "+tu.transform(i)+", "+ta(ts.transform(r))+")"},tm={test:th("#"),parse:function(e){let t="",i="",r="",s="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,i+=i,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}},transform:tp.transform},tf=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),tg=tf("deg"),ty=tf("%"),tv=tf("px"),tx=tf("vh"),tb=tf("vw"),tw={...ty,parse:e=>ty.parse(e)/100,transform:e=>ty.transform(100*e)},tk={test:th("hsl","hue"),parse:tc("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:r=1})=>"hsla("+Math.round(e)+", "+ty.transform(ta(t))+", "+ty.transform(ta(i))+", "+ta(ts.transform(r))+")"},tT={test:e=>tp.test(e)||tm.test(e)||tk.test(e),parse:e=>tp.test(e)?tp.parse(e):tk.test(e)?tk.parse(e):tm.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?tp.transform(e):tk.transform(e),getAnimatableNone:e=>{let t=tT.parse(e);return t.alpha=0,tT.transform(t)}},tC=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,tj="number",tE="color",tP=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function tA(e){let t=e.toString(),i=[],r={color:[],number:[],var:[]},s=[],n=0,a=t.replace(tP,e=>(tT.test(e)?(r.color.push(n),s.push(tE),i.push(tT.parse(e))):e.startsWith("var(")?(r.var.push(n),s.push("var"),i.push(e)):(r.number.push(n),s.push(tj),i.push(parseFloat(e))),++n,"${}")).split("${}");return{values:i,split:a,indexes:r,types:s}}function t_(e){return tA(e).values}function tS(e){let{split:t,types:i}=tA(e),r=t.length;return e=>{let s="";for(let n=0;n<r;n++)if(s+=t[n],void 0!==e[n]){let t=i[n];t===tj?s+=ta(e[n]):t===tE?s+=tT.transform(e[n]):s+=e[n]}return s}}let tN=e=>"number"==typeof e?0:tT.test(e)?tT.getAnimatableNone(e):e,tM={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(to)?.length||0)+(e.match(tC)?.length||0)>0},parse:t_,createTransformer:tS,getAnimatableNone:function(e){let t=t_(e);return tS(e)(t.map(tN))}};function tR(e,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?e+(t-e)*6*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function tD(e,t){return i=>i>0?t:e}let tI=(e,t,i)=>e+(t-e)*i,tL=(e,t,i)=>{let r=e*e,s=i*(t*t-r)+r;return s<0?0:Math.sqrt(s)},tO=[tm,tp,tk],tB=e=>tO.find(t=>t.test(e));function tV(e){let t=tB(e);if(e6(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`),!t)return!1;let i=t.parse(e);return t===tk&&(i=function({hue:e,saturation:t,lightness:i,alpha:r}){e/=360,i/=100;let s=0,n=0,a=0;if(t/=100){let r=i<.5?i*(1+t):i+t-i*t,o=2*i-r;s=tR(o,r,e+1/3),n=tR(o,r,e),a=tR(o,r,e-1/3)}else s=n=a=i;return{red:Math.round(255*s),green:Math.round(255*n),blue:Math.round(255*a),alpha:r}}(i)),i}let tF=(e,t)=>{let i=tV(e),r=tV(t);if(!i||!r)return tD(e,t);let s={...i};return e=>(s.red=tL(i.red,r.red,e),s.green=tL(i.green,r.green,e),s.blue=tL(i.blue,r.blue,e),s.alpha=tI(i.alpha,r.alpha,e),tp.transform(s))},t$=new Set(["none","hidden"]);function tU(e,t){return i=>tI(e,t,i)}function tz(e){return"number"==typeof e?tU:"string"==typeof e?tt(e)?tD:tT.test(e)?tF:tW:Array.isArray(e)?tY:"object"==typeof e?tT.test(e)?tF:tH:tD}function tY(e,t){let i=[...e],r=i.length,s=e.map((e,i)=>tz(e)(e,t[i]));return e=>{for(let t=0;t<r;t++)i[t]=s[t](e);return i}}function tH(e,t){let i={...e,...t},r={};for(let s in i)void 0!==e[s]&&void 0!==t[s]&&(r[s]=tz(e[s])(e[s],t[s]));return e=>{for(let t in r)i[t]=r[t](e);return i}}let tW=(e,t)=>{let i=tM.createTransformer(t),r=tA(e),s=tA(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?t$.has(e)&&!s.values.length||t$.has(t)&&!r.values.length?function(e,t){return t$.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}(e,t):e1(tY(function(e,t){let i=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){let n=t.types[s],a=e.indexes[n][r[n]],o=e.values[a]??0;i[s]=o,r[n]++}return i}(r,s),s.values),i):(e6(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),tD(e,t))};function tq(e,t,i){return"number"==typeof e&&"number"==typeof t&&"number"==typeof i?tI(e,t,i):tz(e)(e,t)}let tZ=e=>{let t=({timestamp:t})=>e(t);return{start:(e=!0)=>eR.update(t,e),stop:()=>eD(t),now:()=>eI.isProcessing?eI.timestamp:eY.now()}},tG=(e,t,i=10)=>{let r="",s=Math.max(Math.round(t/i),2);for(let t=0;t<s;t++)r+=Math.round(1e4*e(t/(s-1)))/1e4+", ";return`linear(${r.substring(0,r.length-2)})`};function tK(e){let t=0,i=e.next(t);for(;!i.done&&t<2e4;)t+=50,i=e.next(t);return t>=2e4?1/0:t}function tJ(e,t,i){var r,s;let n=Math.max(t-5,0);return r=i-e(n),(s=t-n)?1e3/s*r:0}let tQ={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};function tX(e,t){return e*Math.sqrt(1-t*t)}let t0=["duration","bounce"],t1=["stiffness","damping","mass"];function t2(e,t){return t.some(t=>void 0!==e[t])}function t3(e=tQ.visualDuration,t=tQ.bounce){let i;let r="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:s,restDelta:n}=r,a=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:h,damping:c,mass:d,duration:u,velocity:p,isResolvedFromDuration:m}=function(e){let t={velocity:tQ.velocity,stiffness:tQ.stiffness,damping:tQ.damping,mass:tQ.mass,isResolvedFromDuration:!1,...e};if(!t2(e,t1)&&t2(e,t0)){if(e.visualDuration){let i=2*Math.PI/(1.2*e.visualDuration),r=i*i,s=2*e2(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:tQ.mass,stiffness:r,damping:s}}else{let i=function({duration:e=tQ.duration,bounce:t=tQ.bounce,velocity:i=tQ.velocity,mass:r=tQ.mass}){let s,n;e6(e<=e3(tQ.maxDuration),"Spring duration must be 10 seconds or less");let a=1-t;a=e2(tQ.minDamping,tQ.maxDamping,a),e=e2(tQ.minDuration,tQ.maxDuration,e4(e)),a<1?(s=t=>{let r=t*a,s=r*e;return .001-(r-i)/tX(t,a)*Math.exp(-s)},n=t=>{let r=t*a*e,n=Math.pow(a,2)*Math.pow(t,2)*e,o=tX(Math.pow(t,2),a);return(r*i+i-n)*Math.exp(-r)*(-s(t)+.001>0?-1:1)/o}):(s=t=>-.001+Math.exp(-t*e)*((t-i)*e+1),n=t=>e*e*(i-t)*Math.exp(-t*e));let o=function(e,t,i){let r=i;for(let i=1;i<12;i++)r-=e(r)/t(r);return r}(s,n,5/e);if(e=e3(e),isNaN(o))return{stiffness:tQ.stiffness,damping:tQ.damping,duration:e};{let t=Math.pow(o,2)*r;return{stiffness:t,damping:2*a*Math.sqrt(r*t),duration:e}}}(e);(t={...t,...i,mass:tQ.mass}).isResolvedFromDuration=!0}}return t}({...r,velocity:-e4(r.velocity||0)}),f=p||0,g=c/(2*Math.sqrt(h*d)),y=o-a,v=e4(Math.sqrt(h/d)),x=5>Math.abs(y);if(s||(s=x?tQ.restSpeed.granular:tQ.restSpeed.default),n||(n=x?tQ.restDelta.granular:tQ.restDelta.default),g<1){let e=tX(v,g);i=t=>o-Math.exp(-g*v*t)*((f+g*v*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}else if(1===g)i=e=>o-Math.exp(-v*e)*(y+(f+v*y)*e);else{let e=v*Math.sqrt(g*g-1);i=t=>{let i=Math.exp(-g*v*t),r=Math.min(e*t,300);return o-i*((f+g*v*y)*Math.sinh(r)+e*y*Math.cosh(r))/e}}let b={calculatedDuration:m&&u||null,next:e=>{let t=i(e);if(m)l.done=e>=u;else{let r=0===e?f:0;g<1&&(r=0===e?e3(f):tJ(i,e,t));let a=Math.abs(r)<=s,h=Math.abs(o-t)<=n;l.done=a&&h}return l.value=l.done?o:t,l},toString:()=>{let e=Math.min(tK(b),2e4),t=tG(t=>b.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return b}function t4({keyframes:e,velocity:t=0,power:i=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:n=500,modifyTarget:a,min:o,max:l,restDelta:h=.5,restSpeed:c}){let d,u;let p=e[0],m={done:!1,value:p},f=e=>void 0!==o&&e<o||void 0!==l&&e>l,g=e=>void 0===o?l:void 0===l?o:Math.abs(o-e)<Math.abs(l-e)?o:l,y=i*t,v=p+y,x=void 0===a?v:a(v);x!==v&&(y=x-p);let b=e=>-y*Math.exp(-e/r),w=e=>x+b(e),k=e=>{let t=b(e),i=w(e);m.done=Math.abs(t)<=h,m.value=m.done?x:i},T=e=>{f(m.value)&&(d=e,u=t3({keyframes:[m.value,g(m.value)],velocity:tJ(w,e,m.value),damping:s,stiffness:n,restDelta:h,restSpeed:c}))};return T(0),{calculatedDuration:null,next:e=>{let t=!1;return(u||void 0!==d||(t=!0,k(e),T(e)),void 0!==d&&e>=d)?u.next(e-d):(t||k(e),m)}}}t3.applyToOptions=e=>{let t=function(e,t=100,i){let r=i({...e,keyframes:[0,t]}),s=Math.min(tK(r),2e4);return{type:"keyframes",ease:e=>r.next(s*e).value/t,duration:e4(s)}}(e,100,t3);return e.ease=t.ease,e.duration=e3(t.duration),e.type="keyframes",e};let t5=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e;function t6(e,t,i,r){if(e===t&&i===r)return eA;let s=t=>(function(e,t,i,r,s){let n,a;let o=0;do(n=t5(a=t+(i-t)/2,r,s)-e)>0?i=a:t=a;while(Math.abs(n)>1e-7&&++o<12);return a})(t,0,1,e,i);return e=>0===e||1===e?e:t5(s(e),t,r)}let t8=t6(.42,0,1,1),t7=t6(0,0,.58,1),t9=t6(.42,0,.58,1),ie=e=>Array.isArray(e)&&"number"!=typeof e[0],it=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ii=e=>t=>1-e(1-t),ir=t6(.33,1.53,.69,.99),is=ii(ir),ia=it(is),io=e=>(e*=2)<1?.5*is(e):.5*(2-Math.pow(2,-10*(e-1))),il=e=>1-Math.sin(Math.acos(e)),ih=ii(il),ic=it(il),id=e=>Array.isArray(e)&&"number"==typeof e[0],iu={linear:eA,easeIn:t8,easeInOut:t9,easeOut:t7,circIn:il,circInOut:ic,circOut:ih,backIn:is,backInOut:ia,backOut:ir,anticipate:io},ip=e=>"string"==typeof e,im=e=>{if(id(e)){e8(4===e.length,"Cubic bezier arrays must contain four numerical values.");let[t,i,r,s]=e;return t6(t,i,r,s)}return ip(e)?(e8(void 0!==iu[e],`Invalid easing type '${e}'`),iu[e]):e},ig=(e,t,i)=>{let r=t-e;return 0===r?1:(i-e)/r};function iy({duration:e=300,keyframes:t,times:i,ease:r="easeInOut"}){let s=ie(r)?r.map(im):im(r),n={done:!1,value:t[0]},a=function(e,t,{clamp:i=!0,ease:r,mixer:s}={}){let n=e.length;if(e8(n===t.length,"Both input and output ranges must be the same length"),1===n)return()=>t[0];if(2===n&&t[0]===t[1])return()=>t[1];let a=e[0]===e[1];e[0]>e[n-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,i){let r=[],s=i||e_.mix||tq,n=e.length-1;for(let i=0;i<n;i++){let n=s(e[i],e[i+1]);t&&(n=e1(Array.isArray(t)?t[i]||eA:t,n)),r.push(n)}return r}(t,r,s),l=o.length,h=i=>{if(a&&i<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(i<e[r+1]);r++);let s=ig(e[r],e[r+1],i);return o[r](s)};return i?t=>h(e2(e[0],e[n-1],t)):h}((i&&i.length===t.length?i:function(e){let t=[0];return function(e,t){let i=e[e.length-1];for(let r=1;r<=t;r++){let s=ig(0,t,r);e.push(tI(i,1,s))}}(t,e.length-1),t}(t)).map(t=>t*e),t,{ease:Array.isArray(s)?s:t.map(()=>s||t9).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(n.value=a(t),n.done=t>=e,n)}}let iv=e=>null!==e;function ix(e,{repeat:t,repeatType:i="loop"},r,s=1){let n=e.filter(iv),a=s<0||t&&"loop"!==i&&t%2==1?0:n.length-1;return a&&void 0!==r?r:n[a]}let ib={decay:t4,inertia:t4,tween:iy,keyframes:iy,spring:t3};function iw(e){"string"==typeof e.type&&(e.type=ib[e.type])}class ik{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}let iT=e=>e/100;class iC extends ik{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:e}=this.options;e&&e.updatedAt!==eY.now()&&this.tick(eY.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},e5.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){let{options:e}=this;iw(e);let{type:t=iy,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:n=0}=e,{keyframes:a}=e,o=t||iy;o!==iy&&"number"!=typeof a[0]&&(this.mixKeyframes=e1(iT,tq(a[0],a[1])),a=[0,100]);let l=o({...e,keyframes:a});"mirror"===s&&(this.mirroredGenerator=o({...e,keyframes:[...a].reverse(),velocity:-n})),null===l.calculatedDuration&&(l.calculatedDuration=tK(l));let{calculatedDuration:h}=l;this.calculatedDuration=h,this.resolvedDuration=h+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=l}updateTime(e){let t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){let{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:n,resolvedDuration:a,calculatedDuration:o}=this;if(null===this.startTime)return i.next(0);let{delay:l=0,keyframes:h,repeat:c,repeatType:d,repeatDelay:u,type:p,onUpdate:m,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);let g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?g<0:g>r;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let v=this.currentTime,x=i;if(c){let e=Math.min(this.currentTime,r)/a,t=Math.floor(e),i=e%1;!i&&e>=1&&(i=1),1===i&&t--,(t=Math.min(t,c+1))%2&&("reverse"===d?(i=1-i,u&&(i-=u/a)):"mirror"===d&&(x=n)),v=e2(0,1,i)*a}let b=y?{done:!1,value:h[0]}:x.next(v);s&&(b.value=s(b.value));let{done:w}=b;y||null===o||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);let k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&p!==t4&&(b.value=ix(h,this.options,f,this.speed)),m&&m(b.value),k&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return e4(this.calculatedDuration)}get time(){return e4(this.currentTime)}set time(e){e=e3(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(eY.now());let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=e4(this.currentTime))}play(){if(this.isStopped)return;let{driver:e=tZ,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();let i=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=i):null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime||(this.startTime=t??i),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(eY.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,e5.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}let ij=e=>180*e/Math.PI,iE=e=>iA(ij(Math.atan2(e[1],e[0]))),iP={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:iE,rotateZ:iE,skewX:e=>ij(Math.atan(e[1])),skewY:e=>ij(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},iA=e=>((e%=360)<0&&(e+=360),e),i_=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),iS=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),iN={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:i_,scaleY:iS,scale:e=>(i_(e)+iS(e))/2,rotateX:e=>iA(ij(Math.atan2(e[6],e[5]))),rotateY:e=>iA(ij(Math.atan2(-e[2],e[0]))),rotateZ:iE,rotate:iE,skewX:e=>ij(Math.atan(e[4])),skewY:e=>ij(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function iM(e){return e.includes("scale")?1:0}function iR(e,t){let i,r;if(!e||"none"===e)return iM(t);let s=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(s)i=iN,r=s;else{let t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=iP,r=t}if(!r)return iM(t);let n=i[t],a=r[1].split(",").map(iI);return"function"==typeof n?n(a):a[n]}let iD=(e,t)=>{let{transform:i="none"}=getComputedStyle(e);return iR(i,t)};function iI(e){return parseFloat(e.trim())}let iL=e=>e===tr||e===tv,iO=new Set(["x","y","z"]),iB=eO.filter(e=>!iO.has(e)),iV={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>iR(t,"x"),y:(e,{transform:t})=>iR(t,"y")};iV.translateX=iV.x,iV.translateY=iV.y;let iF=new Set,i$=!1,iU=!1,iz=!1;function iY(){if(iU){let e=Array.from(iF).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),i=new Map;t.forEach(e=>{let t=function(e){let t=[];return iB.forEach(i=>{let r=e.getValue(i);void 0!==r&&(t.push([i,r.get()]),r.set(i.startsWith("scale")?1:0))}),t}(e);t.length&&(i.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=i.get(e);t&&t.forEach(([t,i])=>{e.getValue(t)?.set(i)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}iU=!1,i$=!1,iF.forEach(e=>e.complete(iz)),iF.clear()}function iH(){iF.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(iU=!0)})}class iW{constructor(e,t,i,r,s,n=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=n}scheduleResolve(){this.state="scheduled",this.isAsync?(iF.add(this),i$||(i$=!0,eR.read(iH),eR.resolveKeyframes(iY))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;if(null===e[0]){let s=r?.get(),n=e[e.length-1];if(void 0!==s)e[0]=s;else if(i&&t){let r=i.readValue(t,n);null!=r&&(e[0]=r)}void 0===e[0]&&(e[0]=n),r&&void 0===s&&r.set(e[0])}!function(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),iF.delete(this)}cancel(){"scheduled"===this.state&&(iF.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}let iq=e=>e.startsWith("--");function iZ(e){let t;return()=>(void 0===t&&(t=e()),t)}let iG=iZ(()=>void 0!==window.ScrollTimeline),iK={},iJ=function(e,t){let i=iZ(e);return()=>iK[t]??i()}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),iQ=([e,t,i,r])=>`cubic-bezier(${e}, ${t}, ${i}, ${r})`,iX={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:iQ([0,.65,.55,1]),circOut:iQ([.55,0,1,.45]),backIn:iQ([.31,.01,.66,-.59]),backOut:iQ([.33,1.53,.69,.99])};function i0(e){return"function"==typeof e&&"applyToOptions"in e}class i1 extends ik{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;let{element:t,name:i,keyframes:r,pseudoElement:s,allowFlatten:n=!1,finalKeyframe:a,onComplete:o}=e;this.isPseudoElement=!!s,this.allowFlatten=n,this.options=e,e8("string"!=typeof e.type,'animateMini doesn\'t support "type" as a string. Did you mean to import { spring } from "motion"?');let l=function({type:e,...t}){return i0(e)&&iJ()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=function(e,t,i,{delay:r=0,duration:s=300,repeat:n=0,repeatType:a="loop",ease:o="easeOut",times:l}={},h){let c={[t]:i};l&&(c.offset=l);let d=function e(t,i){if(t)return"function"==typeof t?iJ()?tG(t,i):"ease-out":id(t)?iQ(t):Array.isArray(t)?t.map(t=>e(t,i)||iX.easeOut):iX[t]}(o,s);Array.isArray(d)&&(c.easing=d),eN.value&&e5.waapi++;let u={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:n+1,direction:"reverse"===a?"alternate":"normal"};h&&(u.pseudoElement=h);let p=e.animate(c,u);return eN.value&&p.finished.finally(()=>{e5.waapi--}),p}(t,i,r,l,s),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){let e=ix(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,i){iq(t)?e.style.setProperty(t,i):e.style[t]=i}(t,i,e),this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){return e4(Number(this.animation.effect?.getComputedTiming?.().duration||0))}get time(){return e4(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=e3(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&iG())?(this.animation.timeline=e,eA):t(this)}}let i2={anticipate:io,backInOut:ia,circInOut:ic};class i3 extends i1{constructor(e){(function(e){"string"==typeof e.ease&&e.ease in i2&&(e.ease=i2[e.ease])})(e),iw(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:t,onUpdate:i,onComplete:r,element:s,...n}=this.options;if(!t)return;if(void 0!==e){t.set(e);return}let a=new iC({...n,autoplay:!1}),o=e3(this.finishedTime??this.time);t.setWithVelocity(a.sample(o-10).value,a.sample(o).value,10),a.stop()}}let i4=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(tM.test(e)||"0"===e)&&!e.startsWith("url("));function i5(e){return"object"==typeof e&&null!==e}function i6(e){return i5(e)&&"offsetHeight"in e}let i8=new Set(["opacity","clipPath","filter","transform"]),i7=iZ(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class i9 extends ik{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:n="loop",keyframes:a,name:o,motionValue:l,element:h,...c}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=eY.now();let d={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:n,name:o,motionValue:l,element:h,...c},u=h?.KeyframeResolver||iW;this.keyframeResolver=new u(a,(e,t,i)=>this.onKeyframesResolved(e,t,d,!i),o,l,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,i,r){this.keyframeResolver=void 0;let{name:s,type:n,velocity:a,delay:o,isHandoff:l,onUpdate:h}=i;this.resolvedAt=eY.now(),!function(e,t,i,r){let s=e[0];if(null===s)return!1;if("display"===t||"visibility"===t)return!0;let n=e[e.length-1],a=i4(s,t),o=i4(n,t);return e6(a===o,`You are trying to animate ${t} from "${s}" to "${n}". ${s} is not an animatable value - to enable this animation set ${s} to a value animatable to ${n} via the \`style\` property.`),!!a&&!!o&&(function(e){let t=e[0];if(1===e.length)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}(e)||("spring"===i||i0(i))&&r)}(e,s,n,a)&&((e_.instantAnimations||!o)&&h?.(ix(e,i,t)),e[0]=e[e.length-1],i.duration=0,i.repeat=0);let c={startTime:r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...i,keyframes:e},d=!l&&function(e){let{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:n,type:a}=e;if(!i6(t?.owner?.current))return!1;let{onUpdate:o,transformTemplate:l}=t.owner.getProps();return i7()&&i&&i8.has(i)&&("transform"!==i||!l)&&!o&&!r&&"mirror"!==s&&0!==n&&"inertia"!==a}(c)?new i3({...c,element:c.motionValue.owner.current}):new iC(c);d.finished.then(()=>this.notifyFinished()).catch(eA),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),iz=!0,iH(),iY(),iz=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let re=e=>null!==e,rt={type:"spring",stiffness:500,damping:25,restSpeed:10},ri=e=>({type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}),rr={type:"keyframes",duration:.8},rs={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},rn=(e,{keyframes:t})=>t.length>2?rr:eB.has(e)?e.startsWith("scale")?ri(t[1]):rt:rs,ra=(e,t,i,r={},s,n)=>a=>{let o=eP(r,e)||{},l=o.delay||r.delay||0,{elapsed:h=0}=r;h-=e3(l);let c={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-h,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:n?void 0:s};!function({when:e,delay:t,delayChildren:i,staggerChildren:r,staggerDirection:s,repeat:n,repeatType:a,repeatDelay:o,from:l,elapsed:h,...c}){return!!Object.keys(c).length}(o)&&Object.assign(c,rn(e,c)),c.duration&&(c.duration=e3(c.duration)),c.repeatDelay&&(c.repeatDelay=e3(c.repeatDelay)),void 0!==c.from&&(c.keyframes[0]=c.from);let d=!1;if(!1!==c.type&&(0!==c.duration||c.repeatDelay)||(c.duration=0,0!==c.delay||(d=!0)),(e_.instantAnimations||e_.skipAnimations)&&(d=!0,c.duration=0,c.delay=0),c.allowFlatten=!o.type&&!o.ease,d&&!n&&void 0!==t.get()){let e=function(e,{repeat:t,repeatType:i="loop"},r){let s=e.filter(re),n=t&&"loop"!==i&&t%2==1?0:s.length-1;return s[n]}(c.keyframes,o);if(void 0!==e){eR.update(()=>{c.onUpdate(e),c.onComplete()});return}}return o.isSync?new iC(c):new i9(c)};function ro(e,t,{delay:i=0,transitionOverride:r,type:s}={}){let{transition:n=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(n=r);let l=[],h=s&&e.animationState&&e.animationState.getState()[s];for(let t in o){let r=e.getValue(t,e.latestValues[t]??null),s=o[t];if(void 0===s||h&&function({protectedKeys:e,needsAnimating:t},i){let r=e.hasOwnProperty(i)&&!0!==t[i];return t[i]=!1,r}(h,t))continue;let a={delay:i,...eP(n||{},t)},c=r.get();if(void 0!==c&&!r.isAnimating&&!Array.isArray(s)&&s===c&&!a.velocity)continue;let d=!1;if(window.MotionHandoffAnimation){let i=e.props[eX];if(i){let e=window.MotionHandoffAnimation(i,t,eR);null!==e&&(a.startTime=e,d=!0)}}eJ(e,t),r.start(ra(t,r,s,e.shouldReduceMotion&&eV.has(t)?{type:!1}:a,e,d));let u=r.animation;u&&l.push(u)}return a&&Promise.all(l).then(()=>{eR.update(()=>{a&&function(e,t){let{transitionEnd:i={},transition:r={},...s}=eE(e,t)||{};for(let t in s={...s,...i}){var n;let i=eG(n=s[t])?n[n.length-1]||0:n;e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,eZ(i))}}(e,a)})}),l}function rl(e,t,i={}){let r=eE(e,t,"exit"===i.type?e.presenceContext?.custom:void 0),{transition:s=e.getDefaultTransition()||{}}=r||{};i.transitionOverride&&(s=i.transitionOverride);let n=r?()=>Promise.all(ro(e,r,i)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(r=0)=>{let{delayChildren:n=0,staggerChildren:a,staggerDirection:o}=s;return function(e,t,i=0,r=0,s=1,n){let a=[],o=(e.variantChildren.size-1)*r,l=1===s?(e=0)=>e*r:(e=0)=>o-e*r;return Array.from(e.variantChildren).sort(rh).forEach((e,r)=>{e.notify("AnimationStart",t),a.push(rl(e,t,{...n,delay:i+l(r)}).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(a)}(e,t,n+r,a,o,i)}:()=>Promise.resolve(),{when:o}=s;if(!o)return Promise.all([n(),a(i.delay)]);{let[e,t]="beforeChildren"===o?[n,a]:[a,n];return e().then(()=>t())}}function rh(e,t){return e.sortNodePosition(t)}function rc(e,t){if(!Array.isArray(t))return!1;let i=t.length;if(i!==e.length)return!1;for(let r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}function rd(e){return"string"==typeof e||Array.isArray(e)}let ru=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],rp=["initial",...ru],rm=rp.length,rf=[...ru].reverse(),rg=ru.length;function ry(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rv(){return{animate:ry(!0),whileInView:ry(),whileHover:ry(),whileTap:ry(),whileDrag:ry(),whileFocus:ry(),exit:ry()}}class rx{constructor(e){this.isMounted=!1,this.node=e}update(){}}class rb extends rx{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:i})=>(function(e,t,i={}){let r;if(e.notify("AnimationStart",t),Array.isArray(t))r=Promise.all(t.map(t=>rl(e,t,i)));else if("string"==typeof t)r=rl(e,t,i);else{let s="function"==typeof t?eE(e,t,i.custom):t;r=Promise.all(ro(e,s,i))}return r.then(()=>{e.notify("AnimationComplete",t)})})(e,t,i))),i=rv(),r=!0,s=t=>(i,r)=>{let s=eE(e,r,"exit"===t?e.presenceContext?.custom:void 0);if(s){let{transition:e,transitionEnd:t,...r}=s;i={...i,...r,...t}}return i};function n(n){let{props:a}=e,o=function e(t){if(!t)return;if(!t.isControllingVariants){let i=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(i.initial=t.props.initial),i}let i={};for(let e=0;e<rm;e++){let r=rp[e],s=t.props[r];(rd(s)||!1===s)&&(i[r]=s)}return i}(e.parent)||{},l=[],h=new Set,c={},d=1/0;for(let t=0;t<rg;t++){var u;let p=rf[t],m=i[p],f=void 0!==a[p]?a[p]:o[p],g=rd(f),y=p===n?m.isActive:null;!1===y&&(d=t);let v=f===o[p]&&f!==a[p]&&g;if(v&&r&&e.manuallyAnimateOnMount&&(v=!1),m.protectedKeys={...c},!m.isActive&&null===y||!f&&!m.prevProp||eT(f)||"boolean"==typeof f)continue;let x=(u=m.prevProp,"string"==typeof f?f!==u:!!Array.isArray(f)&&!rc(f,u)),b=x||p===n&&m.isActive&&!v&&g||t>d&&g,w=!1,k=Array.isArray(f)?f:[f],T=k.reduce(s(p),{});!1===y&&(T={});let{prevResolvedValues:C={}}=m,j={...C,...T},E=t=>{b=!0,h.has(t)&&(w=!0,h.delete(t)),m.needsAnimating[t]=!0;let i=e.getValue(t);i&&(i.liveStyle=!1)};for(let e in j){let t=T[e],i=C[e];if(!c.hasOwnProperty(e))(eG(t)&&eG(i)?rc(t,i):t===i)?void 0!==t&&h.has(e)?E(e):m.protectedKeys[e]=!0:null!=t?E(e):h.add(e)}m.prevProp=f,m.prevResolvedValues=T,m.isActive&&(c={...c,...T}),r&&e.blockInitialAnimation&&(b=!1);let P=!(v&&x)||w;b&&P&&l.push(...k.map(e=>({animation:e,options:{type:p}})))}if(h.size){let t={};if("boolean"!=typeof a.initial){let i=eE(e,Array.isArray(a.initial)?a.initial[0]:a.initial);i&&i.transition&&(t.transition=i.transition)}h.forEach(i=>{let r=e.getBaseTarget(i),s=e.getValue(i);s&&(s.liveStyle=!0),t[i]=r??null}),l.push({animation:t})}let p=!!l.length;return r&&(!1===a.initial||a.initial===a.animate)&&!e.manuallyAnimateOnMount&&(p=!1),r=!1,p?t(l):Promise.resolve()}return{animateChanges:n,setActive:function(t,r){if(i[t].isActive===r)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,r)),i[t].isActive=r;let s=n(t);for(let e in i)i[e].protectedKeys={};return s},setAnimateFunction:function(i){t=i(e)},getState:()=>i,reset:()=>{i=rv(),r=!0}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();eT(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let rw=0;class rk extends rx{constructor(){super(...arguments),this.id=rw++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;let r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){let{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}let rT={x:!1,y:!1};function rC(e,t,i,r={passive:!0}){return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i)}let rj=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function rE(e){return{point:{x:e.pageX,y:e.pageY}}}let rP=e=>t=>rj(t)&&e(t,rE(t));function rA(e,t,i,r){return rC(e,t,rP(i),r)}function r_({top:e,left:t,right:i,bottom:r}){return{x:{min:t,max:i},y:{min:e,max:r}}}function rS(e){return e.max-e.min}function rN(e,t,i,r=.5){e.origin=r,e.originPoint=tI(t.min,t.max,e.origin),e.scale=rS(i)/rS(t),e.translate=tI(i.min,i.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function rM(e,t,i,r){rN(e.x,t.x,i.x,r?r.originX:void 0),rN(e.y,t.y,i.y,r?r.originY:void 0)}function rR(e,t,i){e.min=i.min+t.min,e.max=e.min+rS(t)}function rD(e,t,i){e.min=t.min-i.min,e.max=e.min+rS(t)}function rI(e,t,i){rD(e.x,t.x,i.x),rD(e.y,t.y,i.y)}let rL=()=>({translate:0,scale:1,origin:0,originPoint:0}),rO=()=>({x:rL(),y:rL()}),rB=()=>({min:0,max:0}),rV=()=>({x:rB(),y:rB()});function rF(e){return[e("x"),e("y")]}function r$(e){return void 0===e||1===e}function rU({scale:e,scaleX:t,scaleY:i}){return!r$(e)||!r$(t)||!r$(i)}function rz(e){return rU(e)||rY(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function rY(e){var t,i;return(t=e.x)&&"0%"!==t||(i=e.y)&&"0%"!==i}function rH(e,t,i,r,s){return void 0!==s&&(e=r+s*(e-r)),r+i*(e-r)+t}function rW(e,t=0,i=1,r,s){e.min=rH(e.min,t,i,r,s),e.max=rH(e.max,t,i,r,s)}function rq(e,{x:t,y:i}){rW(e.x,t.translate,t.scale,t.originPoint),rW(e.y,i.translate,i.scale,i.originPoint)}function rZ(e,t){e.min=e.min+t,e.max=e.max+t}function rG(e,t,i,r,s=.5){let n=tI(e.min,e.max,s);rW(e,t,i,n,r)}function rK(e,t){rG(e.x,t.x,t.scaleX,t.scale,t.originX),rG(e.y,t.y,t.scaleY,t.scale,t.originY)}function rJ(e,t){return r_(function(e,t){if(!t)return e;let i=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}let rQ=({current:e})=>e?e.ownerDocument.defaultView:null;function rX(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}let r0=(e,t)=>Math.abs(e-t);class r1{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=r4(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,i=function(e,t){return Math.sqrt(r0(e.x,t.x)**2+r0(e.y,t.y)**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!i)return;let{point:r}=e,{timestamp:s}=eI;this.history.push({...r,timestamp:s});let{onStart:n,onMove:a}=this.handlers;t||(n&&n(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),a&&a(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=r2(t,this.transformPagePoint),eR.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:i,onSessionEnd:r,resumeAnimation:s}=this.handlers;if(this.dragSnapToOrigin&&s&&s(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let n=r4("pointercancel"===e.type?this.lastMoveEventInfo:r2(t,this.transformPagePoint),this.history);this.startEvent&&i&&i(e,n),r&&r(e,n)},!rj(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;let n=r2(rE(e),this.transformPagePoint),{point:a}=n,{timestamp:o}=eI;this.history=[{...a,timestamp:o}];let{onSessionStart:l}=t;l&&l(e,r4(n,this.history)),this.removeListeners=e1(rA(this.contextWindow,"pointermove",this.handlePointerMove),rA(this.contextWindow,"pointerup",this.handlePointerUp),rA(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),eD(this.updatePoint)}}function r2(e,t){return t?{point:t(e.point)}:e}function r3(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r4({point:e},t){return{point:e,delta:r3(e,r5(t)),offset:r3(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,r=null,s=r5(e);for(;i>=0&&(r=e[i],!(s.timestamp-r.timestamp>e3(.1)));)i--;if(!r)return{x:0,y:0};let n=e4(s.timestamp-r.timestamp);if(0===n)return{x:0,y:0};let a={x:(s.x-r.x)/n,y:(s.y-r.y)/n};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}(t,0)}}function r5(e){return e[e.length-1]}function r6(e,t,i){return{min:void 0!==t?e.min+t:void 0,max:void 0!==i?e.max+i-(e.max-e.min):void 0}}function r8(e,t){let i=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,r]=[r,i]),{min:i,max:r}}function r7(e,t,i){return{min:r9(e,t),max:r9(e,i)}}function r9(e,t){return"number"==typeof e?e:e[t]||0}let se=new WeakMap;class st{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rV(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){let{presenceContext:i}=this.visualElement;if(i&&!1===i.isPresent)return;let{dragSnapToOrigin:r}=this.getProps();this.panSession=new r1(e,{onSessionStart:e=>{let{dragSnapToOrigin:i}=this.getProps();i?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(rE(e).point)},onStart:(e,t)=>{let{drag:i,dragPropagation:r,onDragStart:s}=this.getProps();if(i&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===i||"y"===i?rT[i]?null:(rT[i]=!0,()=>{rT[i]=!1}):rT.x||rT.y?null:(rT.x=rT.y=!0,()=>{rT.x=rT.y=!1}),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),rF(e=>{let t=this.getAxisMotionValue(e).get()||0;if(ty.test(t)){let{projection:i}=this.visualElement;if(i&&i.layout){let r=i.layout.layoutBox[e];if(r){let e=rS(r);t=parseFloat(t)/100*e}}}this.originPoint[e]=t}),s&&eR.postRender(()=>s(e,t)),eJ(this.visualElement,"transform");let{animationState:n}=this.visualElement;n&&n.setActive("whileDrag",!0)},onMove:(e,t)=>{let{dragPropagation:i,dragDirectionLock:r,onDirectionLock:s,onDrag:n}=this.getProps();if(!i&&!this.openDragLock)return;let{offset:a}=t;if(r&&null===this.currentDirection){this.currentDirection=function(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}(a),null!==this.currentDirection&&s&&s(this.currentDirection);return}this.updateAxis("x",t.point,a),this.updateAxis("y",t.point,a),this.visualElement.render(),n&&n(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>rF(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play())},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:rQ(this.visualElement)})}stop(e,t){let i=this.isDragging;if(this.cancel(),!i)return;let{velocity:r}=t;this.startAnimation(r);let{onDragEnd:s}=this.getProps();s&&eR.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){let{drag:r}=this.getProps();if(!i||!si(e,r,this.currentDirection))return;let s=this.getAxisMotionValue(e),n=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(n=function(e,{min:t,max:i},r){return void 0!==t&&e<t?e=r?tI(t,e,r.min):Math.max(e,t):void 0!==i&&e>i&&(e=r?tI(i,e,r.max):Math.min(e,i)),e}(n,this.constraints[e],this.elastic[e])),s.set(n)}resolveConstraints(){let{dragConstraints:e,dragElastic:t}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;e&&rX(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=function(e,{top:t,left:i,bottom:r,right:s}){return{x:r6(e.x,i,s),y:r6(e.y,t,r)}}(i.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:r7(e,"left","right"),y:r7(e,"top","bottom")}}(t),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&rF(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){let i={};return void 0!==t.min&&(i.min=t.min-e.min),void 0!==t.max&&(i.max=t.max-e.min),i}(i.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!rX(t))return!1;let r=t.current;e8(null!==r,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:s}=this.visualElement;if(!s||!s.layout)return!1;let n=function(e,t,i){let r=rJ(e,i),{scroll:s}=t;return s&&(rZ(r.x,s.offset.x),rZ(r.y,s.offset.y)),r}(r,s.root,this.visualElement.getTransformPagePoint()),a={x:r8((e=s.layout.layoutBox).x,n.x),y:r8(e.y,n.y)};if(i){let e=i(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(a));this.hasMutatedConstraints=!!e,e&&(a=r_(e))}return a}startAnimation(e){let{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:n,onDragTransitionEnd:a}=this.getProps(),o=this.constraints||{};return Promise.all(rF(a=>{if(!si(a,t,this.currentDirection))return;let l=o&&o[a]||{};n&&(l={min:0,max:0});let h={type:"inertia",velocity:i?e[a]:0,bounceStiffness:r?200:1e6,bounceDamping:r?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...s,...l};return this.startAxisValueAnimation(a,h)})).then(a)}startAxisValueAnimation(e,t){let i=this.getAxisMotionValue(e);return eJ(this.visualElement,e),i.start(ra(e,i,0,t,this.visualElement,!1))}stopAnimation(){rF(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){rF(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps();return i[t]||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){rF(t=>{let{drag:i}=this.getProps();if(!si(t,i,this.currentDirection))return;let{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){let{min:i,max:n}=r.layout.layoutBox[t];s.set(e[t]-tI(i,n,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!rX(t)||!i||!this.constraints)return;this.stopAnimation();let r={x:0,y:0};rF(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){let i=t.get();r[e]=function(e,t){let i=.5,r=rS(e),s=rS(t);return s>r?i=ig(t.min,t.max-r,e.min):r>s&&(i=ig(e.min,e.max-s,t.min)),e2(0,1,i)}({min:i,max:i},this.constraints[e])}});let{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),rF(t=>{if(!si(t,e,null))return;let i=this.getAxisMotionValue(t),{min:s,max:n}=this.constraints[t];i.set(tI(s,n,r[t]))})}addListeners(){if(!this.visualElement.current)return;se.set(this.visualElement,this);let e=rA(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:i=!0}=this.getProps();t&&i&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();rX(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",t);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),eR.read(t);let s=rC(window,"resize",()=>this.scalePositionWithinConstraints()),n=i.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(rF(t=>{let i=this.getAxisMotionValue(t);i&&(this.originPoint[t]+=e[t].translate,i.set(i.get()+e[t].translate))}),this.visualElement.render())});return()=>{s(),e(),r(),n&&n()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:n=.35,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:n,dragMomentum:a}}}function si(e,t,i){return(!0===t||t===e)&&(null===i||i===e)}class sr extends rx{constructor(e){super(e),this.removeGroupControls=eA,this.removeListeners=eA,this.controls=new st(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||eA}unmount(){this.removeGroupControls(),this.removeListeners()}}let ss=e=>(t,i)=>{e&&eR.postRender(()=>e(t,i))};class sn extends rx{constructor(){super(...arguments),this.removePointerDownListener=eA}onPointerDown(e){this.session=new r1(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:rQ(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:ss(e),onStart:ss(t),onMove:i,onEnd:(e,t)=>{delete this.session,r&&eR.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=rA(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let{schedule:sa,cancel:so}=eM(queueMicrotask,!1),sl=(0,o.createContext)(null);function sh(e=!0){let t=(0,o.useContext)(sl);if(null===t)return[!0,null];let{isPresent:i,onExitComplete:r,register:s}=t,n=(0,o.useId)();(0,o.useEffect)(()=>{if(e)return s(n)},[e]);let a=(0,o.useCallback)(()=>e&&r&&r(n),[n,r,e]);return!i&&r?[!1,a]:[!0]}let sc=(0,o.createContext)({}),sd=(0,o.createContext)({}),su={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function sp(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let sm={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!tv.test(e))return e;e=parseFloat(e)}let i=sp(e,t.target.x),r=sp(e,t.target.y);return`${i}% ${r}%`}},sf={};class sg extends o.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;(function(e){for(let t in e)sf[t]=e[t],e9(t)&&(sf[t].isCSSVariable=!0)})(sv),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),su.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,{projection:n}=i;return n&&(n.isPresent=s,r||e.layoutDependency!==t||void 0===t||e.isPresent!==s?n.willUpdate():this.safeToRemove(),e.isPresent===s||(s?n.promote():n.relegate()||eR.postRender(()=>{let e=n.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),sa.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function sy(e){let[t,i]=sh(),r=(0,o.useContext)(sc);return(0,a.jsx)(sg,{...e,layoutGroup:r,switchLayoutGroup:(0,o.useContext)(sd),isPresent:t,safeToRemove:i})}let sv={borderRadius:{...sm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:sm,borderTopRightRadius:sm,borderBottomLeftRadius:sm,borderBottomRightRadius:sm,boxShadow:{correct:(e,{treeScale:t,projectionDelta:i})=>{let r=tM.parse(e);if(r.length>5)return e;let s=tM.createTransformer(e),n="number"!=typeof r[0]?1:0,a=i.x.scale*t.x,o=i.y.scale*t.y;r[0+n]/=a,r[1+n]/=o;let l=tI(a,o,.5);return"number"==typeof r[2+n]&&(r[2+n]/=l),"number"==typeof r[3+n]&&(r[3+n]/=l),s(r)}}};function sx(e){return i5(e)&&"ownerSVGElement"in e}let sb=(e,t)=>e.depth-t.depth;class sw{constructor(){this.children=[],this.isDirty=!1}add(e){eF(this.children,e),this.isDirty=!0}remove(e){e$(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(sb),this.isDirty=!1,this.children.forEach(e)}}function sk(e){return eK(e)?e.get():e}let sT=["TopLeft","TopRight","BottomLeft","BottomRight"],sC=sT.length,sj=e=>"string"==typeof e?parseFloat(e):e,sE=e=>"number"==typeof e||tv.test(e);function sP(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let sA=sS(0,.5,ih),s_=sS(.5,.95,eA);function sS(e,t,i){return r=>r<e?0:r>t?1:i(ig(e,t,r))}function sN(e,t){e.min=t.min,e.max=t.max}function sM(e,t){sN(e.x,t.x),sN(e.y,t.y)}function sR(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function sD(e,t,i,r,s){return e-=t,e=r+1/i*(e-r),void 0!==s&&(e=r+1/s*(e-r)),e}function sI(e,t,[i,r,s],n,a){!function(e,t=0,i=1,r=.5,s,n=e,a=e){if(ty.test(t)&&(t=parseFloat(t),t=tI(a.min,a.max,t/100)-a.min),"number"!=typeof t)return;let o=tI(n.min,n.max,r);e===n&&(o-=t),e.min=sD(e.min,t,i,o,s),e.max=sD(e.max,t,i,o,s)}(e,t[i],t[r],t[s],t.scale,n,a)}let sL=["x","scaleX","originX"],sO=["y","scaleY","originY"];function sB(e,t,i,r){sI(e.x,t,sL,i?i.x:void 0,r?r.x:void 0),sI(e.y,t,sO,i?i.y:void 0,r?r.y:void 0)}function sV(e){return 0===e.translate&&1===e.scale}function sF(e){return sV(e.x)&&sV(e.y)}function s$(e,t){return e.min===t.min&&e.max===t.max}function sU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function sz(e,t){return sU(e.x,t.x)&&sU(e.y,t.y)}function sY(e){return rS(e.x)/rS(e.y)}function sH(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class sW{constructor(){this.members=[]}add(e){eF(this.members,e),e.scheduleRender()}remove(e){if(e$(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t;let i=this.members.findIndex(t=>e===t);if(0===i)return!1;for(let e=i;e>=0;e--){let i=this.members[e];if(!1!==i.isPresent){t=i;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:r}=e.options;!1===r&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let sq={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},sZ=["","X","Y","Z"],sG={visibility:"hidden"},sK=0;function sJ(e,t,i,r){let{latestValues:s}=t;s[e]&&(i[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function sQ({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(e={},i=t?.()){this.id=sK++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,eN.value&&(sq.nodes=sq.calculatedTargetDeltas=sq.calculatedProjections=0),this.nodes.forEach(s1),this.nodes.forEach(s7),this.nodes.forEach(s9),this.nodes.forEach(s2),eN.addProjectionMetrics&&eN.addProjectionMetrics(sq)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new sw)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new eU),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let i=this.eventHandlers.get(e);i&&i.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;this.isSVG=sx(t)&&!(sx(t)&&"svg"===t.tagName),this.instance=t;let{layoutId:i,layout:r,visualElement:s}=this.options;if(s&&!s.current&&s.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(r||i)&&(this.isLayoutDirty=!0),e){let i;let r=()=>this.root.updateBlockedByResize=!1;e(t,()=>{this.root.updateBlockedByResize=!0,i&&i(),i=function(e,t){let i=eY.now(),r=({timestamp:t})=>{let s=t-i;s>=250&&(eD(r),e(s-250))};return eR.setup(r,!0),()=>eD(r)}(r,250),su.hasAnimatedSinceResize&&(su.hasAnimatedSinceResize=!1,this.nodes.forEach(s8))})}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&s&&(i||r)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:i,layout:r})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let n=this.options.transition||s.getDefaultTransition()||nn,{onLayoutAnimationStart:a,onLayoutAnimationComplete:o}=s.getProps(),l=!this.targetLayout||!sz(this.targetLayout,r),h=!t&&i;if(this.options.layoutRoot||this.resumeFrom||h||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let t={...eP(n,"layout"),onPlay:a,onComplete:o};(s.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,h)}else t||s8(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),eD(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ne),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:i}=t.options;if(!i)return;let r=i.props[eX];if(window.MotionHasOptimisedAnimation(r,"transform")){let{layout:e,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",eR,!(e||i))}let{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&e(s)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:i}=this.options;if(void 0===t&&!i)return;let r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(s4);return}this.isUpdating||this.nodes.forEach(s5),this.isUpdating=!1,this.nodes.forEach(s6),this.nodes.forEach(sX),this.nodes.forEach(s0),this.clearAllSnapshots();let e=eY.now();eI.delta=e2(0,1e3/60,e-eI.timestamp),eI.timestamp=e,eI.isProcessing=!0,eL.update.process(eI),eL.preRender.process(eI),eL.render.process(eI),eI.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,sa.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(s3),this.sharedNodes.forEach(nt)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,eR.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){eR.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),!this.snapshot||rS(this.snapshot.measuredBox.x)||rS(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=rV(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){let t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!s)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!sF(this.projectionDelta),i=this.getTransformTemplate(),r=i?i(this.latestValues,""):void 0,n=r!==this.prevTransformTemplateValue;e&&this.instance&&(t||rz(this.latestValues)||n)&&(s(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let i=this.measurePageBox(),r=this.removeElementScroll(i);return e&&(r=this.removeTransform(r)),nl((t=r).x),nl(t.y),{animationId:this.root.animationId,measuredBox:i,layoutBox:r,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return rV();let t=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(nc))){let{scroll:e}=this.root;e&&(rZ(t.x,e.offset.x),rZ(t.y,e.offset.y))}return t}removeElementScroll(e){let t=rV();if(sM(t,e),this.scroll?.wasRoot)return t;for(let i=0;i<this.path.length;i++){let r=this.path[i],{scroll:s,options:n}=r;r!==this.root&&s&&n.layoutScroll&&(s.wasRoot&&sM(t,e),rZ(t.x,s.offset.x),rZ(t.y,s.offset.y))}return t}applyTransform(e,t=!1){let i=rV();sM(i,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];!t&&r.options.layoutScroll&&r.scroll&&r!==r.root&&rK(i,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),rz(r.latestValues)&&rK(i,r.latestValues)}return rz(this.latestValues)&&rK(i,this.latestValues),i}removeTransform(e){let t=rV();sM(t,e);for(let e=0;e<this.path.length;e++){let i=this.path[e];if(!i.instance||!rz(i.latestValues))continue;rU(i.latestValues)&&i.updateSnapshot();let r=rV();sM(r,i.measurePageBox()),sB(t,i.latestValues,i.snapshot?i.snapshot.layoutBox:void 0,r)}return rz(this.latestValues)&&sB(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==eI.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){let t=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=t.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=t.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=t.isSharedProjectionDirty);let i=!!this.resumingFrom||this!==t;if(!(e||i&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:r,layoutId:s}=this.options;if(this.layout&&(r||s)){if(this.resolvedRelativeTargetAt=eI.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rV(),this.relativeTargetOrigin=rV(),rI(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),sM(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if(this.target||(this.target=rV(),this.targetWithTransforms=rV()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target){var n,a,o;this.forceRelativeParentToResolveTarget(),n=this.target,a=this.relativeTarget,o=this.relativeParent.target,rR(n.x,a.x,o.x),rR(n.y,a.y,o.y)}else this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):sM(this.target,this.layout.layoutBox),rq(this.target,this.targetDelta)):sM(this.target,this.layout.layoutBox);if(this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rV(),this.relativeTargetOrigin=rV(),rI(this.relativeTargetOrigin,this.target,e.target),sM(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}eN.value&&sq.calculatedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||rU(this.parent.latestValues)||rY(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){let e=this.getLead(),t=!!this.resumingFrom||this!==e,i=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(i=!1),t&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===eI.timestamp&&(i=!1),i)return;let{layout:r,layoutId:s}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(r||s))return;sM(this.layoutCorrected,this.layout.layoutBox);let n=this.treeScale.x,a=this.treeScale.y;(function(e,t,i,r=!1){let s,n;let a=i.length;if(a){t.x=t.y=1;for(let o=0;o<a;o++){n=(s=i[o]).projectionDelta;let{visualElement:a}=s.options;(!a||!a.props.style||"contents"!==a.props.style.display)&&(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&rK(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),n&&(t.x*=n.x.scale,t.y*=n.y.scale,rq(e,n)),r&&rz(s.latestValues)&&rK(e,s.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}})(this.layoutCorrected,this.treeScale,this.path,t),e.layout&&!e.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(e.target=e.layout.layoutBox,e.targetWithTransforms=rV());let{target:o}=e;if(!o){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(sR(this.prevProjectionDelta.x,this.projectionDelta.x),sR(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),rM(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===n&&this.treeScale.y===a&&sH(this.projectionDelta.x,this.prevProjectionDelta.x)&&sH(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o)),eN.value&&sq.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=rO(),this.projectionDelta=rO(),this.projectionDeltaWithTransform=rO()}setAnimationOrigin(e,t=!1){let i;let r=this.snapshot,s=r?r.latestValues:{},n={...this.latestValues},a=rO();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let o=rV(),l=(r?r.source:void 0)!==(this.layout?this.layout.source:void 0),h=this.getStack(),c=!h||h.members.length<=1,d=!!(l&&!c&&!0===this.options.crossfade&&!this.path.some(ns));this.animationProgress=0,this.mixTargetDelta=t=>{let r=t/1e3;if(ni(a.x,e.x,r),ni(a.y,e.y,r),this.setTargetDelta(a),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var h,u,p,m;rI(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,m=this.relativeTargetOrigin,nr(p.x,m.x,o.x,r),nr(p.y,m.y,o.y,r),i&&(h=this.relativeTarget,u=i,s$(h.x,u.x)&&s$(h.y,u.y))&&(this.isProjectionDirty=!1),i||(i=rV()),sM(i,this.relativeTarget)}l&&(this.animationValues=n,function(e,t,i,r,s,n){s?(e.opacity=tI(0,i.opacity??1,sA(r)),e.opacityExit=tI(t.opacity??1,0,s_(r))):n&&(e.opacity=tI(t.opacity??1,i.opacity??1,r));for(let s=0;s<sC;s++){let n=`border${sT[s]}Radius`,a=sP(t,n),o=sP(i,n);(void 0!==a||void 0!==o)&&(a||(a=0),o||(o=0),0===a||0===o||sE(a)===sE(o)?(e[n]=Math.max(tI(sj(a),sj(o),r),0),(ty.test(o)||ty.test(a))&&(e[n]+="%")):e[n]=o)}(t.rotate||i.rotate)&&(e.rotate=tI(t.rotate||0,i.rotate||0,r))}(n,s,this.latestValues,r,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=r},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(eD(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=eR.update(()=>{su.hasAnimatedSinceResize=!0,e5.layout++,this.motionValue||(this.motionValue=eZ(0)),this.currentAnimation=function(e,t,i){let r=eK(e)?e:eZ(e);return r.start(ra("",r,t,i)),r.animation}(this.motionValue,[0,1e3],{...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{e5.layout--},onComplete:()=>{e5.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:i,layout:r,latestValues:s}=e;if(t&&i&&r){if(this!==e&&this.layout&&r&&nh(this.options.animationType,this.layout.layoutBox,r.layoutBox)){i=this.target||rV();let t=rS(this.layout.layoutBox.x);i.x.min=e.target.x.min,i.x.max=i.x.min+t;let r=rS(this.layout.layoutBox.y);i.y.min=e.target.y.min,i.y.max=i.y.min+r}sM(t,i),rK(t,s),rM(this.projectionDeltaWithTransform,this.layoutCorrected,t,s)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new sW),this.sharedNodes.get(e).add(t);let i=t.options.initialPromotionConfig;t.promote({transition:i?i.transition:void 0,preserveFollowOpacity:i&&i.shouldPreserveFollowOpacity?i.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){let{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:i}={}){let r=this.getStack();r&&r.promote(this,i),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:i}=e;if((i.z||i.rotate||i.rotateX||i.rotateY||i.rotateZ||i.skewX||i.skewY)&&(t=!0),!t)return;let r={};i.z&&sJ("z",e,r,this.animationValues);for(let t=0;t<sZ.length;t++)sJ(`rotate${sZ[t]}`,e,r,this.animationValues),sJ(`skew${sZ[t]}`,e,r,this.animationValues);for(let t in e.render(),r)e.setStaticValue(t,r[t]),this.animationValues&&(this.animationValues[t]=r[t]);e.scheduleRender()}getProjectionStyles(e){if(!this.instance||this.isSVG)return;if(!this.isVisible)return sG;let t={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,t.opacity="",t.pointerEvents=sk(e?.pointerEvents)||"",t.transform=i?i(this.latestValues,""):"none",t;let r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target){let t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=sk(e?.pointerEvents)||""),this.hasProjected&&!rz(this.latestValues)&&(t.transform=i?i({},""):"none",this.hasProjected=!1),t}let s=r.animationValues||r.latestValues;this.applyTransformsToTarget(),t.transform=function(e,t,i){let r="",s=e.x.translate/t.x,n=e.y.translate/t.y,a=i?.z||0;if((s||n||a)&&(r=`translate3d(${s}px, ${n}px, ${a}px) `),(1!==t.x||1!==t.y)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),i){let{transformPerspective:e,rotate:t,rotateX:s,rotateY:n,skewX:a,skewY:o}=i;e&&(r=`perspective(${e}px) ${r}`),t&&(r+=`rotate(${t}deg) `),s&&(r+=`rotateX(${s}deg) `),n&&(r+=`rotateY(${n}deg) `),a&&(r+=`skewX(${a}deg) `),o&&(r+=`skewY(${o}deg) `)}let o=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==o||1!==l)&&(r+=`scale(${o}, ${l})`),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,s),i&&(t.transform=i(s,t.transform));let{x:n,y:a}=this.projectionDelta;for(let e in t.transformOrigin=`${100*n.origin}% ${100*a.origin}% 0`,r.animationValues?t.opacity=r===this?s.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:s.opacityExit:t.opacity=r===this?void 0!==s.opacity?s.opacity:"":void 0!==s.opacityExit?s.opacityExit:0,sf){if(void 0===s[e])continue;let{correct:i,applyTo:n,isCSSVariable:a}=sf[e],o="none"===t.transform?s[e]:i(s[e],r);if(n){let e=n.length;for(let i=0;i<e;i++)t[n[i]]=o}else a?this.options.visualElement.renderState.vars[e]=o:t[e]=o}return this.options.layoutId&&(t.pointerEvents=r===this?sk(e?.pointerEvents)||"":"none"),t}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(s4),this.root.sharedNodes.clear()}}}function sX(e){e.updateLayout()}function s0(e){let t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){let{layoutBox:i,measuredBox:r}=e.layout,{animationType:s}=e.options,n=t.source!==e.layout.source;"size"===s?rF(e=>{let r=n?t.measuredBox[e]:t.layoutBox[e],s=rS(r);r.min=i[e].min,r.max=r.min+s}):nh(s,t.layoutBox,i)&&rF(r=>{let s=n?t.measuredBox[r]:t.layoutBox[r],a=rS(i[r]);s.max=s.min+a,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+a)});let a=rO();rM(a,i,t.layoutBox);let o=rO();n?rM(o,e.applyTransform(r,!0),t.measuredBox):rM(o,i,t.layoutBox);let l=!sF(a),h=!1;if(!e.resumeFrom){let r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){let{snapshot:s,layout:n}=r;if(s&&n){let a=rV();rI(a,t.layoutBox,s.layoutBox);let o=rV();rI(o,i,n.layoutBox),sz(a,o)||(h=!0),r.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=a,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:o,layoutDelta:a,hasLayoutChanged:l,hasRelativeLayoutChanged:h})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function s1(e){eN.value&&sq.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function s2(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function s3(e){e.clearSnapshot()}function s4(e){e.clearMeasurements()}function s5(e){e.isLayoutDirty=!1}function s6(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function s8(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function s7(e){e.resolveTargetDelta()}function s9(e){e.calcProjection()}function ne(e){e.resetSkewAndRotation()}function nt(e){e.removeLeadSnapshot()}function ni(e,t,i){e.translate=tI(t.translate,0,i),e.scale=tI(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function nr(e,t,i,r){e.min=tI(t.min,i.min,r),e.max=tI(t.max,i.max,r)}function ns(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let nn={duration:.45,ease:[.4,0,.1,1]},na=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),no=na("applewebkit/")&&!na("chrome/")?Math.round:eA;function nl(e){e.min=no(e.min),e.max=no(e.max)}function nh(e,t,i){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(sY(t)-sY(i)))}function nc(e){return e!==e.root&&e.scroll?.wasRoot}let nd=sQ({attachResizeListener:(e,t)=>rC(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),nu={current:void 0},np=sQ({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!nu.current){let e=new nd({});e.mount(window),e.setOptions({layoutScroll:!0}),nu.current=e}return nu.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function nm(e,t){let i=function(e,t,i){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document,i=(void 0)??t.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}(e),r=new AbortController;return[i,{passive:!0,...t,signal:r.signal},()=>r.abort()]}function nf(e){return!("touch"===e.pointerType||rT.x||rT.y)}function ng(e,t,i){let{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===i);let s=r["onHover"+i];s&&eR.postRender(()=>s(t,rE(t)))}class ny extends rx{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,i={}){let[r,s,n]=nm(e,i),a=e=>{if(!nf(e))return;let{target:i}=e,r=t(i,e);if("function"!=typeof r||!i)return;let n=e=>{nf(e)&&(r(e),i.removeEventListener("pointerleave",n))};i.addEventListener("pointerleave",n,s)};return r.forEach(e=>{e.addEventListener("pointerenter",a,s)}),n}(e,(e,t)=>(ng(this.node,t,"Start"),e=>ng(this.node,e,"End"))))}unmount(){}}class nv extends rx{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=e1(rC(this.node.current,"focus",()=>this.onFocus()),rC(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}let nx=(e,t)=>!!t&&(e===t||nx(e,t.parentElement)),nb=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),nw=new WeakSet;function nk(e){return t=>{"Enter"===t.key&&e(t)}}function nT(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}let nC=(e,t)=>{let i=e.currentTarget;if(!i)return;let r=nk(()=>{if(nw.has(i))return;nT(i,"down");let e=nk(()=>{nT(i,"up")});i.addEventListener("keyup",e,t),i.addEventListener("blur",()=>nT(i,"cancel"),t)});i.addEventListener("keydown",r,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",r),t)};function nj(e){return rj(e)&&!(rT.x||rT.y)}function nE(e,t,i){let{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===i);let s=r["onTap"+("End"===i?"":i)];s&&eR.postRender(()=>s(t,rE(t)))}class nP extends rx{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,i={}){let[r,s,n]=nm(e,i),a=e=>{let r=e.currentTarget;if(!nj(e))return;nw.add(r);let n=t(r,e),a=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),nw.has(r)&&nw.delete(r),nj(e)&&"function"==typeof n&&n(e,{success:t})},o=e=>{a(e,r===window||r===document||i.useGlobalTarget||nx(r,e.target))},l=e=>{a(e,!1)};window.addEventListener("pointerup",o,s),window.addEventListener("pointercancel",l,s)};return r.forEach(e=>{(i.useGlobalTarget?window:e).addEventListener("pointerdown",a,s),i6(e)&&(e.addEventListener("focus",e=>nC(e,s)),nb.has(e.tagName)||-1!==e.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),n}(e,(e,t)=>(nE(this.node,t,"Start"),(e,{success:t})=>nE(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}let nA=new WeakMap,n_=new WeakMap,nS=e=>{let t=nA.get(e.target);t&&t(e)},nN=e=>{e.forEach(nS)},nM={some:0,all:1};class nR extends rx{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,n={root:t?t.current:void 0,rootMargin:i,threshold:"number"==typeof r?r:nM[r]};return function(e,t,i){let r=function({root:e,...t}){let i=e||document;n_.has(i)||n_.set(i,{});let r=n_.get(i),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(nN,{root:e,...t})),r[s]}(t);return nA.set(e,i),r.observe(e),()=>{nA.delete(e),r.unobserve(e)}}(this.node.current,n,e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,s&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:i,onViewportLeave:r}=this.node.getProps(),n=t?i:r;n&&n(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}(e,t))&&this.startObserver()}unmount(){}}let nD=(0,o.createContext)({strict:!1}),nI=(0,o.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),nL=(0,o.createContext)({});function nO(e){return eT(e.animate)||rp.some(t=>rd(e[t]))}function nB(e){return!!(nO(e)||e.variants)}function nV(e){return Array.isArray(e)?e.join(" "):e}let nF="undefined"!=typeof window,n$={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nU={};for(let e in n$)nU[e]={isEnabled:t=>n$[e].some(e=>!!t[e])};let nz=Symbol.for("motionComponentSymbol"),nY=nF?o.useLayoutEffect:o.useEffect;function nH(e,{layout:t,layoutId:i}){return eB.has(e)||e.startsWith("origin")||(t||void 0!==i)&&(!!sf[e]||"opacity"===e)}let nW=(e,t)=>t&&"number"==typeof e?t.transform(e):e,nq={...tr,transform:Math.round},nZ={borderWidth:tv,borderTopWidth:tv,borderRightWidth:tv,borderBottomWidth:tv,borderLeftWidth:tv,borderRadius:tv,radius:tv,borderTopLeftRadius:tv,borderTopRightRadius:tv,borderBottomRightRadius:tv,borderBottomLeftRadius:tv,width:tv,maxWidth:tv,height:tv,maxHeight:tv,top:tv,right:tv,bottom:tv,left:tv,padding:tv,paddingTop:tv,paddingRight:tv,paddingBottom:tv,paddingLeft:tv,margin:tv,marginTop:tv,marginRight:tv,marginBottom:tv,marginLeft:tv,backgroundPositionX:tv,backgroundPositionY:tv,rotate:tg,rotateX:tg,rotateY:tg,rotateZ:tg,scale:tn,scaleX:tn,scaleY:tn,scaleZ:tn,skew:tg,skewX:tg,skewY:tg,distance:tv,translateX:tv,translateY:tv,translateZ:tv,x:tv,y:tv,z:tv,perspective:tv,transformPerspective:tv,opacity:ts,originX:tw,originY:tw,originZ:tv,zIndex:nq,fillOpacity:ts,strokeOpacity:ts,numOctaves:nq},nG={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nK=eO.length;function nJ(e,t,i){let{style:r,vars:s,transformOrigin:n}=e,a=!1,o=!1;for(let e in t){let i=t[e];if(eB.has(e)){a=!0;continue}if(e9(e)){s[e]=i;continue}{let t=nW(i,nZ[e]);e.startsWith("origin")?(o=!0,n[e]=t):r[e]=t}}if(!t.transform&&(a||i?r.transform=function(e,t,i){let r="",s=!0;for(let n=0;n<nK;n++){let a=eO[n],o=e[a];if(void 0===o)continue;let l=!0;if(!(l="number"==typeof o?o===(a.startsWith("scale")?1:0):0===parseFloat(o))||i){let e=nW(o,nZ[a]);if(!l){s=!1;let t=nG[a]||a;r+=`${t}(${e}) `}i&&(t[a]=e)}}return r=r.trim(),i?r=i(t,s?"":r):s&&(r="none"),r}(t,e.transform,i):r.transform&&(r.transform="none")),o){let{originX:e="50%",originY:t="50%",originZ:i=0}=n;r.transformOrigin=`${e} ${t} ${i}`}}let nQ=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function nX(e,t,i){for(let r in t)eK(t[r])||nH(r,i)||(e[r]=t[r])}let n0={offset:"stroke-dashoffset",array:"stroke-dasharray"},n1={offset:"strokeDashoffset",array:"strokeDasharray"};function n2(e,{attrX:t,attrY:i,attrScale:r,pathLength:s,pathSpacing:n=1,pathOffset:a=0,...o},l,h,c){if(nJ(e,o,h),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:d,style:u}=e;d.transform&&(u.transform=d.transform,delete d.transform),(u.transform||d.transformOrigin)&&(u.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),u.transform&&(u.transformBox=c?.transformBox??"fill-box",delete d.transformBox),void 0!==t&&(d.x=t),void 0!==i&&(d.y=i),void 0!==r&&(d.scale=r),void 0!==s&&function(e,t,i=1,r=0,s=!0){e.pathLength=1;let n=s?n0:n1;e[n.offset]=tv.transform(-r);let a=tv.transform(t),o=tv.transform(i);e[n.array]=`${a} ${o}`}(d,s,n,a,!1)}let n3=()=>({...nQ(),attrs:{}}),n4=e=>"string"==typeof e&&"svg"===e.toLowerCase(),n5=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function n6(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||n5.has(e)}let n8=e=>!n6(e);try{!function(e){"function"==typeof e&&(n8=t=>t.startsWith("on")?!n6(t):e(t))}(require("@emotion/is-prop-valid").default)}catch{}let n7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function n9(e){if("string"!=typeof e||e.includes("-"));else if(n7.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}function ae(e){let t=(0,o.useRef)(null);return null===t.current&&(t.current=e()),t.current}let at=e=>(t,i)=>{let r=(0,o.useContext)(nL),s=(0,o.useContext)(sl),n=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t},i,r,s){return{latestValues:function(e,t,i,r){let s={},n=r(e,{});for(let e in n)s[e]=sk(n[e]);let{initial:a,animate:o}=e,l=nO(e),h=nB(e);t&&h&&!l&&!1!==e.inherit&&(void 0===a&&(a=t.initial),void 0===o&&(o=t.animate));let c=!!i&&!1===i.initial,d=(c=c||!1===a)?o:a;if(d&&"boolean"!=typeof d&&!eT(d)){let t=Array.isArray(d)?d:[d];for(let i=0;i<t.length;i++){let r=ej(e,t[i]);if(r){let{transitionEnd:e,transition:t,...i}=r;for(let e in i){let t=i[e];if(Array.isArray(t)){let e=c?t.length-1:0;t=t[e]}null!==t&&(s[e]=t)}for(let t in e)s[t]=e[t]}}}return s}(i,r,s,e),renderState:t()}})(e,t,r,s);return i?n():ae(n)};function ai(e,t,i){let{style:r}=e,s={};for(let n in r)(eK(r[n])||t.style&&eK(t.style[n])||nH(n,e)||i?.getValue(n)?.liveStyle!==void 0)&&(s[n]=r[n]);return s}let ar={useVisualState:at({scrapeMotionValuesFromProps:ai,createRenderState:nQ})};function as(e,t,i){let r=ai(e,t,i);for(let i in e)(eK(e[i])||eK(t[i]))&&(r[-1!==eO.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=e[i]);return r}let an={useVisualState:at({scrapeMotionValuesFromProps:as,createRenderState:n3})},aa=e=>t=>t.test(e),ao=[tr,tv,ty,tg,tb,tx,{test:e=>"auto"===e,parse:e=>e}],al=e=>ao.find(aa(e)),ah=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),ac=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,ad=e=>/^0[^.\s]+$/u.test(e),au=new Set(["brightness","contrast","saturate","opacity"]);function ap(e){let[t,i]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[r]=i.match(to)||[];if(!r)return e;let s=i.replace(r,""),n=au.has(t)?1:0;return r!==i&&(n*=100),t+"("+n+s+")"}let am=/\b([a-z-]*)\(.*?\)/gu,af={...tM,getAnimatableNone:e=>{let t=e.match(am);return t?t.map(ap).join(" "):e}},ag={...nZ,color:tT,backgroundColor:tT,outlineColor:tT,fill:tT,stroke:tT,borderColor:tT,borderTopColor:tT,borderRightColor:tT,borderBottomColor:tT,borderLeftColor:tT,filter:af,WebkitFilter:af},ay=e=>ag[e];function av(e,t){let i=ay(e);return i!==af&&(i=tM),i.getAnimatableNone?i.getAnimatableNone(t):void 0}let ax=new Set(["auto","none","0"]);class ab extends iW{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let i=0;i<e.length;i++){let r=e[i];if("string"==typeof r&&tt(r=r.trim())){let s=function e(t,i,r=1){e8(r<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`);let[s,n]=function(e){let t=ac.exec(e);if(!t)return[,];let[,i,r,s]=t;return[`--${i??r}`,s]}(t);if(!s)return;let a=window.getComputedStyle(i).getPropertyValue(s);if(a){let e=a.trim();return ah(e)?parseFloat(e):e}return tt(n)?e(n,i,r+1):n}(r,t.current);void 0!==s&&(e[i]=s),i===e.length-1&&(this.finalKeyframe=r)}}if(this.resolveNoneKeyframes(),!eV.has(i)||2!==e.length)return;let[r,s]=e,n=al(r),a=al(s);if(n!==a){if(iL(n)&&iL(a))for(let t=0;t<e.length;t++){let i=e[t];"string"==typeof i&&(e[t]=parseFloat(i))}else iV[i]&&(this.needsMeasurement=!0)}}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,i=[];for(let t=0;t<e.length;t++){var r;(null===e[t]||("number"==typeof(r=e[t])?0===r:null===r||"none"===r||"0"===r||ad(r)))&&i.push(t)}i.length&&function(e,t,i){let r,s=0;for(;s<e.length&&!r;){let t=e[s];"string"==typeof t&&!ax.has(t)&&tA(t).values.length&&(r=e[s]),s++}if(r&&i)for(let s of t)e[s]=av(i,r)}(e,i,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;"height"===i&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=iV[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let r=t[t.length-1];void 0!==r&&e.getValue(i,r).jump(r,!1)}measureEndState(){let{element:e,name:t,unresolvedKeyframes:i}=this;if(!e||!e.current)return;let r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);let s=i.length-1,n=i[s];i[s]=iV[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==n&&void 0===this.finalKeyframe&&(this.finalKeyframe=n),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,i])=>{e.getValue(t).set(i)}),this.resolveNoneKeyframes()}}let aw=[...ao,tT,tM],ak=e=>aw.find(aa(e)),aT={current:null},aC={current:!1},aj=new WeakMap,aE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class aP{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:n},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=iW,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=eY.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,eR.render(this.render,!1,!0))};let{latestValues:o,renderState:l}=n;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=nO(t),this.isVariantNode=nB(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:h,...c}=this.scrapeMotionValuesFromProps(t,{},this);for(let e in c){let t=c[e];void 0!==o[e]&&eK(t)&&t.set(o[e],!1)}}mount(e){this.current=e,aj.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),aC.current||function(){if(aC.current=!0,nF){if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>aT.current=e.matches;e.addListener(t),t()}else aT.current=!1}}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||aT.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in this.projection&&this.projection.unmount(),eD(this.notifyUpdate),eD(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){let i;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let r=eB.has(e);r&&this.onBindTransform&&this.onBindTransform();let s=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&eR.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),n=t.on("renderRequest",this.scheduleRender);window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),n(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in nU){let t=nU[e];if(!t)continue;let{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rV()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<aE.length;t++){let i=aE[t];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);let r=e["on"+i];r&&(this.propEventSubscriptions[i]=this.on(i,r))}this.prevMotionValues=function(e,t,i){for(let r in t){let s=t[r],n=i[r];if(eK(s))e.addValue(r,s);else if(eK(n))e.addValue(r,eZ(s,{owner:e}));else if(n!==s){if(e.hasValue(r)){let t=e.getValue(r);!0===t.liveStyle?t.jump(s):t.hasAnimated||t.set(s)}else{let t=e.getStaticValue(r);e.addValue(r,eZ(void 0!==t?t:s,{owner:e}))}}}for(let r in i)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return void 0===i&&void 0!==t&&(i=eZ(null===t?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){let i=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return null!=i&&("string"==typeof i&&(ah(i)||ad(i))?i=parseFloat(i):!ak(i)&&tM.test(t)&&(i=av(e,t)),this.setBaseTarget(e,eK(i)?i.get():i)),eK(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){let t;let{initial:i}=this.props;if("string"==typeof i||"object"==typeof i){let r=ej(this.props,i,this.presenceContext?.custom);r&&(t=r[e])}if(i&&void 0!==t)return t;let r=this.getBaseTargetFromProps(this.props,e);return void 0===r||eK(r)?void 0!==this.initialValues[e]&&void 0===t?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new eU),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class aA extends aP{constructor(){super(...arguments),this.KeyframeResolver=ab}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;eK(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function a_(e,{style:t,vars:i},r,s){for(let n in Object.assign(e.style,t,s&&s.getProjectionStyles(r)),i)e.style.setProperty(n,i[n])}class aS extends aA{constructor(){super(...arguments),this.type="html",this.renderInstance=a_}readValueFromInstance(e,t){if(eB.has(t))return this.projection?.isProjecting?iM(t):iD(e,t);{let i=window.getComputedStyle(e),r=(e9(t)?i.getPropertyValue(t):i[t])||0;return"string"==typeof r?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return rJ(e,t)}build(e,t,i){nJ(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return ai(e,t,i)}}let aN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class aM extends aA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rV}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(eB.has(t)){let e=ay(t);return e&&e.default||0}return t=aN.has(t)?t:eQ(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return as(e,t,i)}build(e,t,i){n2(e,t,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,t,i,r){!function(e,t,i,r){for(let i in a_(e,t,void 0,r),t.attrs)e.setAttribute(aN.has(i)?i:eQ(i),t.attrs[i])}(e,t,0,r)}mount(e){this.isSVGTag=n4(e.tagName),super.mount(e)}}let aR=function(e){if("undefined"==typeof Proxy)return e;let t=new Map;return new Proxy((...t)=>e(...t),{get:(i,r)=>"create"===r?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}((s={animation:{Feature:rb},exit:{Feature:rk},inView:{Feature:nR},tap:{Feature:nP},focus:{Feature:nv},hover:{Feature:ny},pan:{Feature:sn},drag:{Feature:sr,ProjectionNode:np,MeasureLayout:sy},layout:{ProjectionNode:np,MeasureLayout:sy}},n=(e,t)=>n9(e)?new aM(t):new aS(t,{allowProjection:e!==o.Fragment}),function(e,{forwardMotionProps:t}={forwardMotionProps:!1}){return function({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:r,Component:s}){function n(e,n){var l;let h;let c={...(0,o.useContext)(nI),...e,layoutId:function({layoutId:e}){let t=(0,o.useContext)(sc).id;return t&&void 0!==e?t+"-"+e:e}(e)},{isStatic:d}=c,u=function(e){let{initial:t,animate:i}=function(e,t){if(nO(e)){let{initial:t,animate:i}=e;return{initial:!1===t||rd(t)?t:void 0,animate:rd(i)?i:void 0}}return!1!==e.inherit?t:{}}(e,(0,o.useContext)(nL));return(0,o.useMemo)(()=>({initial:t,animate:i}),[nV(t),nV(i)])}(e),p=r(e,d);if(!d&&nF){(0,o.useContext)(nD).strict;let e=function(e){let{drag:t,layout:i}=nU;if(!t&&!i)return{};let r={...t,...i};return{MeasureLayout:t?.isEnabled(e)||i?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(c);h=e.MeasureLayout,u.visualElement=function(e,t,i,r,s){let{visualElement:n}=(0,o.useContext)(nL),a=(0,o.useContext)(nD),l=(0,o.useContext)(sl),h=(0,o.useContext)(nI).reducedMotion,c=(0,o.useRef)(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:n,props:i,presenceContext:l,blockInitialAnimation:!!l&&!1===l.initial,reducedMotionConfig:h}));let d=c.current,u=(0,o.useContext)(sd);d&&!d.projection&&s&&("html"===d.type||"svg"===d.type)&&function(e,t,i,r){let{layoutId:s,layout:n,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:h,layoutCrossfade:c}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:s,layout:n,alwaysMeasureLayout:!!a||o&&rX(o),visualElement:e,animationType:"string"==typeof n?n:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:h})}(c.current,i,s,u);let p=(0,o.useRef)(!1);(0,o.useInsertionEffect)(()=>{d&&p.current&&d.update(i,l)});let m=i[eX],f=(0,o.useRef)(!!m&&!window.MotionHandoffIsComplete?.(m)&&window.MotionHasOptimisedAnimation?.(m));return nY(()=>{d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),sa.render(d.render),f.current&&d.animationState&&d.animationState.animateChanges())}),(0,o.useEffect)(()=>{d&&(!f.current&&d.animationState&&d.animationState.animateChanges(),f.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(m)}),f.current=!1))}),d}(s,p,c,t,e.ProjectionNode)}return(0,a.jsxs)(nL.Provider,{value:u,children:[h&&u.visualElement?(0,a.jsx)(h,{visualElement:u.visualElement,...c}):null,i(s,e,(l=u.visualElement,(0,o.useCallback)(e=>{e&&p.onMount&&p.onMount(e),l&&(e?l.mount(e):l.unmount()),n&&("function"==typeof n?n(e):rX(n)&&(n.current=e))},[l])),p,d,u.visualElement)]})}e&&function(e){for(let t in e)nU[t]={...nU[t],...e[t]}}(e),n.displayName=`motion.${"string"==typeof s?s:`create(${s.displayName??s.name??""})`}`;let l=(0,o.forwardRef)(n);return l[nz]=s,l}({...n9(e)?an:ar,preloadedFeatures:s,useRender:function(e=!1){return(t,i,r,{latestValues:s},n)=>{let a=(n9(t)?function(e,t,i,r){let s=(0,o.useMemo)(()=>{let i=n3();return n2(i,t,n4(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){let t={};nX(t,e.style,e),s.style={...t,...s.style}}return s}:function(e,t){let i={},r=function(e,t){let i=e.style||{},r={};return nX(r,i,e),Object.assign(r,function({transformTemplate:e},t){return(0,o.useMemo)(()=>{let i=nQ();return nJ(i,t,e),Object.assign({},i.vars,i.style)},[t])}(e,t)),r}(e,t);return e.drag&&!1!==e.dragListener&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=r,i})(i,s,n,t),l=function(e,t,i){let r={};for(let s in e)("values"!==s||"object"!=typeof e.values)&&(n8(s)||!0===i&&n6(s)||!t&&!n6(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}(i,"string"==typeof t,e),h=t!==o.Fragment?{...l,...a,ref:r}:{},{children:c}=i,d=(0,o.useMemo)(()=>eK(c)?c.get():c,[c]);return(0,o.createElement)(t,{...h,children:d})}}(t),createVisualElement:n,Component:e})}));class aD extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,i=i6(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=i-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function aI({children:e,isPresent:t,anchorX:i}){let r=(0,o.useId)(),s=(0,o.useRef)(null),n=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=(0,o.useContext)(nI);return(0,o.useInsertionEffect)(()=>{let{width:e,height:a,top:o,left:h,right:c}=n.current;if(t||!s.current||!e||!a)return;let d="left"===i?`left: ${h}`:`right: ${c}`;s.current.dataset.motionPopId=r;let u=document.createElement("style");return l&&(u.nonce=l),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${d}px !important;
            top: ${o}px !important;
          }
        `),()=>{document.head.contains(u)&&document.head.removeChild(u)}},[t]),(0,a.jsx)(aD,{isPresent:t,childRef:s,sizeRef:n,children:o.cloneElement(e,{ref:s})})}let aL=({children:e,initial:t,isPresent:i,onExitComplete:r,custom:s,presenceAffectsLayout:n,mode:l,anchorX:h})=>{let c=ae(aO),d=(0,o.useId)(),u=!0,p=(0,o.useMemo)(()=>(u=!1,{id:d,initial:t,isPresent:i,custom:s,onExitComplete:e=>{for(let t of(c.set(e,!0),c.values()))if(!t)return;r&&r()},register:e=>(c.set(e,!1),()=>c.delete(e))}),[i,c,r]);return n&&u&&(p={...p}),(0,o.useMemo)(()=>{c.forEach((e,t)=>c.set(t,!1))},[i]),o.useEffect(()=>{i||c.size||!r||r()},[i]),"popLayout"===l&&(e=(0,a.jsx)(aI,{isPresent:i,anchorX:h,children:e})),(0,a.jsx)(sl.Provider,{value:p,children:e})};function aO(){return new Map}let aB=e=>e.key||"";function aV(e){let t=[];return o.Children.forEach(e,e=>{(0,o.isValidElement)(e)&&t.push(e)}),t}let aF=({children:e,custom:t,initial:i=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:n="sync",propagate:l=!1,anchorX:h="left"})=>{let[c,d]=sh(l),u=(0,o.useMemo)(()=>aV(e),[e]),p=l&&!c?[]:u.map(aB),m=(0,o.useRef)(!0),f=(0,o.useRef)(u),g=ae(()=>new Map),[y,v]=(0,o.useState)(u),[x,b]=(0,o.useState)(u);nY(()=>{m.current=!1,f.current=u;for(let e=0;e<x.length;e++){let t=aB(x[e]);p.includes(t)?g.delete(t):!0!==g.get(t)&&g.set(t,!1)}},[x,p.length,p.join("-")]);let w=[];if(u!==y){let e=[...u];for(let t=0;t<x.length;t++){let i=x[t],r=aB(i);p.includes(r)||(e.splice(t,0,i),w.push(i))}return"wait"===n&&w.length&&(e=w),b(aV(e)),v(u),null}let{forceRender:k}=(0,o.useContext)(sc);return(0,a.jsx)(a.Fragment,{children:x.map(e=>{let o=aB(e),y=(!l||!!c)&&(u===x||p.includes(o));return(0,a.jsx)(aL,{isPresent:y,initial:(!m.current||!!i)&&void 0,custom:t,presenceAffectsLayout:s,mode:n,onExitComplete:y?void 0:()=>{if(!g.has(o))return;g.set(o,!0);let e=!0;g.forEach(t=>{t||(e=!1)}),e&&(k?.(),b(f.current),l&&d?.(),r&&r())},anchorX:h,children:e},o)})})},a$={enter:e=>({x:e>0?1e3:-1e3,opacity:0,scale:.8}),center:{zIndex:1,x:0,opacity:1,scale:1},exit:e=>({zIndex:0,x:e<0?1e3:-1e3,opacity:0,scale:.8})},aU=(e,t)=>Math.abs(e)*t;function az({card:e,onCardUpdate:t,isFrontBackOnly:i=!1,onPrint:r,paperConfig:s,sectionLoadingStates:n}){let[c,u]=(0,o.useState)(0),[p,m]=(0,o.useState)(0),[f,g]=(0,o.useState)(!1),[y,v]=(0,o.useState)(null),[x,b]=(0,o.useState)(!1),[w,k]=(0,o.useState)(null),[T,C]=(0,o.useState)(""),[j,E]=(0,o.useState)(!1),[P,A]=(0,o.useState)({}),[_,S]=(0,o.useState)({}),[N,M]=(0,o.useState)(!1),[R,D]=(0,o.useState)(""),[I,L]=(0,o.useState)(!1),[O,B]=(0,o.useState)(""),[V,F]=(0,o.useState)(!1),$=(e,t)=>{let i=P[e],r=_[e];return i&&i.length>0&&void 0!==r?i[r]:t},U=e=>{let t=_[e];return void 0!==t&&t>0},z=e=>{let t=P[e],i=_[e];return t&&void 0!==i&&i<t.length-1},Y=e=>{U(e)&&S(t=>({...t,[e]:t[e]-1}))},H=e=>{z(e)&&S(t=>({...t,[e]:t[e]+1}))},W=(e,t)=>{let i=P[e]||[],r=_[e]||-1,s=[...i.slice(0,r+1),t];A(t=>({...t,[e]:s})),S(t=>({...t,[e]:s.length-1}))},q=t=>{switch(t){case"front-cover":return e.frontCover;case"back-cover":return e.backCover;case"left-interior":return e.leftPage;case"right-interior":return e.rightPage;default:return null}},Z=[{id:"front-cover",title:"Front Cover",subtitle:"What recipients see first",image:$("front-cover",e.frontCover),originalImage:e.frontCover,description:"The front cover design that recipients will see first.",color:"bg-blue-500",type:"single",editLabel:"Edit Front Cover"},{id:"left-interior",title:"Left Interior",subtitle:"Decorative page",image:$("left-interior",e.leftPage),originalImage:e.leftPage,description:"The decorative left page when the card is opened.",color:"bg-emerald-500",type:"single",editLabel:"Edit Left Interior"},{id:"right-interior",title:"Right Interior",subtitle:"Message page",image:$("right-interior",e.rightPage),originalImage:e.rightPage,description:"The right page with your message when the card is opened.",color:"bg-emerald-600",type:"single",editLabel:"Edit Right Interior"},{id:"back-cover",title:"Back Cover",subtitle:"What's on the back",image:$("back-cover",e.backCover),originalImage:e.backCover,description:"The back of the card with subtle design elements.",color:"bg-gray-500",type:"single",editLabel:"Edit Back Cover"}],G=i?Z.filter(e=>!e.id.includes("interior")):Z,K=e=>{m(e),u(t=>1===e?t===G.length-1?0:t+1:0===t?G.length-1:t-1)},J=e=>{m(e>c?1:-1),u(e)},Q=()=>{f?(y&&(clearInterval(y),v(null)),g(!1)):(v(setInterval(()=>{K(1)},3e3)),g(!0))},et=()=>{b(!0),document.body.style.overflow="hidden"},ei=()=>{b(!1),document.body.style.overflow="unset"},er=e=>{k(e),C("")},en=async()=>{if(!w||!T.trim()){eo.Am.error("Please enter an edit prompt");return}let i=q(w);if(!i){eo.Am.error("Could not find source image for editing");return}E(!0);try{let r,n=`CRITICAL: This is a greeting card ${w.replace("-"," ")} in portrait format.

Your edit request: "${T}"

IMPORTANT INSTRUCTIONS:
- This is a portrait (vertical) image for a greeting card
- You must PRESERVE the portrait format and dimensions
- Only modify what was specifically requested in the edit
- Keep the overall layout structure intact - do not crop or cut off any sections
- Maintain the aspect ratio and size of the original image
- Ensure the edited result is suitable for printing as part of a greeting card
- Position any text elements safely away from edges with generous margins
- The image should remain focused on its specific purpose: ${w.replace("-"," ")}

Apply the requested changes while preserving the complete image structure and portrait format.`,a=await fetch("/internal/call_mcp_tool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool_name:"edit_images",arguments:{images:[i],edit_prompt:n,user_number:"+17145986105",model:"gpt-image-1",output_format:"jpeg",quality:"auto",output_compression:100,size:s?.dimensions||"1024x1536",n:1}})});if(!a.ok)throw Error(`HTTP ${a.status}`);let o=await a.json();if(o.error&&"None"!==o.error&&null!==o.error)throw Error(o.error);if("string"==typeof o.result)try{r=JSON.parse(o.result)}catch{throw Error("Invalid JSON response")}else r=o.result;if("error"===r.status)throw Error(r.message);let l=r.results[0];if("error"===l.status)throw Error(l.message);let h=l.edited_url;if(!h)throw Error("No edited image URL returned");if(W(w,h),t){let i={...e};switch(w){case"front-cover":i.frontCover=h;break;case"back-cover":i.backCover=h;break;case"left-interior":i.leftPage=h;break;case"right-interior":i.rightPage=h}t(i)}eo.Am.success(` ${G.find(e=>e.id===w)?.title} edited successfully!`),k(null),C("")}catch(e){console.error("Edit failed:",e),eo.Am.error(`Failed to edit image: ${e instanceof Error?e.message:"Unknown error"}`)}finally{E(!1)}},ea=e=>{A(t=>{let i={...t};return delete i[e],i}),S(t=>{let i={...t};return delete i[e],i}),eo.Am.success("Reset to original image")},eT=e=>{if(!n)return"idle";switch(e){case"front-cover":return n.frontCover;case"back-cover":return n.backCover;case"left-interior":return n.leftInterior;case"right-interior":return n.rightInterior;case"interior":let t=n.leftInterior,i=n.rightInterior;if("loading"===t||"loading"===i)return"loading";if("error"===t||"error"===i)return"error";if("completed"===t&&"completed"===i)return"completed";return"idle";default:return"idle"}},eC=async()=>{M(!0);try{if(e.shareUrl){D(e.shareUrl),L(!0),eo.Am.success("Card is ready to share!"),M(!1);return}let i=await fetch("/api/cards/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e.prompt,frontCover:e.frontCover,backCover:e.backCover,leftPage:e.leftPage,rightPage:e.rightPage})});if(!i.ok)throw Error("Failed to store card");let r=await i.json();D(r.share_url),t&&t({...e,shareUrl:r.share_url}),L(!0),eo.Am.success("Card is ready to share!")}catch(e){console.error("Error sharing card:",e),eo.Am.error("Failed to prepare card for sharing")}finally{M(!1)}},ej=async()=>{try{await navigator.clipboard.writeText(R),eo.Am.success("Link copied to clipboard!")}catch(e){eo.Am.error("Failed to copy link")}},eE=async()=>{if(!O.trim()){eo.Am.error("Please enter an email address");return}F(!0);try{let t=await fetch("/api/cards/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:O,share_url:R,card_prompt:e.prompt})}),i=await t.json();t.ok&&"success"===i.status?(eo.Am.success(" Card sent successfully via email!"),L(!1),B("")):eo.Am.error(`Failed to send email: ${i.message||"Unknown error"}`)}catch(e){console.error("Error sending email:",e),eo.Am.error("Failed to send email. Please try again.")}finally{F(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(aR.div,{className:"text-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Card Preview"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:i?"Swipe through your card: front cover and back cover":"Swipe through your card: front cover, left interior, right interior, and back cover"})]}),(0,a.jsxs)(aR.div,{className:"relative bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-2xl p-6 overflow-hidden shadow-xl",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6,delay:.2},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:G.map((e,t)=>a.jsx(aR.button,{className:`w-3 h-3 rounded-full transition-all duration-300 ${t===c?"bg-blue-500 scale-125":"bg-gray-300 dark:bg-gray-600 hover:bg-gray-400"}`,onClick:()=>J(t),whileHover:{scale:1.2},whileTap:{scale:.9}},t))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[c+1," / ",G.length]}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:Q,className:"h-8 w-8 p-0",children:f?a.jsx(ep,{className:"w-4 h-4"}):a.jsx(em,{className:"w-4 h-4"})}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>u(0),className:"h-8 w-8 p-0",children:a.jsx(ef,{className:"w-4 h-4"})}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:et,className:"h-8 w-8 p-0",title:"View in fullscreen",children:a.jsx(eg,{className:"w-4 h-4"})})]})]}),a.jsx("div",{className:"relative h-[60vh] sm:h-80 md:h-96 overflow-hidden rounded-xl",children:a.jsx(aF,{initial:!1,custom:p,children:a.jsx(aR.div,{custom:p,variants:a$,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2},scale:{duration:.2}},drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(e,{offset:t,velocity:i})=>{let r=aU(t.x,i.x);r<-1e4?K(1):r>1e4&&K(-1)},className:"absolute inset-0 cursor-grab active:cursor-grabbing",children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[a.jsx(aR.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsxs)(el.C,{className:`${G[c].color} text-white w-full justify-center py-2 mb-4 text-sm font-medium`,children:[G[c].title," (",G[c].subtitle,")"]})}),a.jsx(aR.div,{className:"flex-1 relative border-2 border-white/20 rounded-lg overflow-hidden shadow-2xl bg-white group",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.4},children:G[c].image?(0,a.jsxs)("div",{className:"w-full h-full relative cursor-pointer group/image",onClick:et,title:"Click to view fullscreen",children:[a.jsx("img",{src:G[c].image,alt:G[c].title,className:"w-full h-full object-contain bg-white",draggable:!1}),a.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover/image:bg-black/10 transition-all duration-200 flex items-center justify-center",children:a.jsx("div",{className:"opacity-0 group-hover/image:opacity-100 transition-opacity duration-200 bg-white/90 rounded-full p-3 shadow-lg",children:a.jsx(eg,{className:"w-6 h-6 text-gray-700"})})}),(0,a.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[a.jsx("div",{className:"absolute top-3 left-3 pointer-events-auto",children:(e=>{switch(e){case"loading":return a.jsx("div",{className:"absolute top-3 left-16 bg-blue-500/90 text-white rounded-full p-2 shadow-lg",children:a.jsx(ec.Z,{className:"w-4 h-4 animate-spin"})});case"completed":return a.jsx("div",{className:"absolute top-3 left-16 bg-green-500/90 text-white rounded-full p-2 shadow-lg",children:a.jsx(ed.Z,{className:"w-4 h-4"})});case"error":return a.jsx("div",{className:"absolute top-3 left-16 bg-red-500/90 text-white rounded-full p-2 shadow-lg",children:a.jsx(eu.Z,{className:"w-4 h-4"})});default:return null}})(eT(G[c].id))}),a.jsx("button",{onClick:e=>{e.stopPropagation(),er(G[c].id)},className:"absolute top-3 right-3 bg-white/90 hover:bg-white text-gray-700 rounded-full p-2 shadow-lg transition-all duration-200 pointer-events-auto",title:G[c].editLabel,children:a.jsx(es.Z,{className:"w-4 h-4"})}),P[G[c].id]&&P[G[c].id].length>0&&a.jsx("button",{onClick:e=>{e.stopPropagation(),ea(G[c].id)},className:"absolute top-3 left-3 bg-amber-500/90 hover:bg-amber-500 text-white rounded-full p-2 shadow-lg transition-all duration-200 pointer-events-auto",title:"Reset to original",children:a.jsx(ef,{className:"w-3 h-3"})}),P[G[c].id]&&P[G[c].id].length>0&&(0,a.jsxs)("div",{className:"absolute bottom-3 left-3 bg-white/90 rounded-lg shadow-lg p-2 flex items-center gap-2 pointer-events-auto",children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),Y(G[c].id)},disabled:!U(G[c].id),className:"p-1 rounded-full hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",title:"Previous version",children:a.jsx(ey,{className:"w-3 h-3"})}),(0,a.jsxs)("span",{className:"text-xs text-gray-700 px-1",children:[(_[G[c].id]||0)+1,"/",P[G[c].id].length]}),a.jsx("button",{onClick:e=>{e.stopPropagation(),H(G[c].id)},disabled:!z(G[c].id),className:"p-1 rounded-full hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",title:"Next version",children:a.jsx(ev.Z,{className:"w-3 h-3"})})]}),P[G[c].id]&&P[G[c].id].length>0&&(0,a.jsxs)("div",{className:"absolute bottom-3 right-3 bg-emerald-500 text-white text-xs px-2 py-1 rounded-full flex items-center gap-1 pointer-events-auto",children:[a.jsx(X,{className:"w-3 h-3"}),"Edited"]})]})]}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800",children:a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading section..."})})}),a.jsx(aR.p,{className:"text-sm text-gray-600 dark:text-gray-400 text-center mt-3 px-4 leading-relaxed",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:G[c].description})]})},c)})}),a.jsx(aR.button,{className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-full p-2 shadow-lg hover:bg-white dark:hover:bg-gray-700 transition-colors z-10",onClick:()=>K(-1),whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(ey,{className:"w-5 h-5"})}),a.jsx(aR.button,{className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-full p-2 shadow-lg hover:bg-white dark:hover:bg-gray-700 transition-colors z-10",onClick:()=>K(1),whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(ev.Z,{className:"w-5 h-5"})})]}),a.jsx(aR.div,{className:`grid ${i?"grid-cols-2":"grid-cols-2 sm:grid-cols-4"} gap-3`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:G.map((e,t)=>{let i=eT(e.id);return(0,a.jsxs)(aR.button,{onClick:()=>J(t),className:`p-3 rounded-lg border-2 transition-all duration-300 text-left relative ${t===c?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,a.jsxs)("div",{className:"absolute top-2 right-2",children:["loading"===i&&a.jsx(ec.Z,{className:"w-3 h-3 animate-spin text-blue-500"}),"completed"===i&&a.jsx(ed.Z,{className:"w-3 h-3 text-green-500"}),"error"===i&&a.jsx(eu.Z,{className:"w-3 h-3 text-red-500"})]}),a.jsx("div",{className:`w-3 h-3 rounded-full mb-2 ${e.color}`}),a.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.title}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.subtitle})]},e.id)})}),(0,a.jsxs)(aR.div,{className:"flex flex-col sm:flex-row gap-3 pt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},children:[r&&(0,a.jsxs)(l.z,{onClick:r,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white",children:[a.jsx(ex,{className:"w-4 h-4 mr-2"}),"Print Card"]}),a.jsx(l.z,{onClick:eC,disabled:N,variant:"outline",className:"flex-1 border-blue-500 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:N?(0,a.jsxs)(a.Fragment,{children:[a.jsx(ec.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Preparing..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(eb,{className:"w-4 h-4 mr-2"}),"Share Card"]})})]}),a.jsx(eh.Vq,{open:I,onOpenChange:L,children:(0,a.jsxs)(eh.cZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(eh.fK,{children:[(0,a.jsxs)(eh.$N,{className:"flex items-center gap-2",children:[a.jsx(eb,{className:"w-5 h-5"}),"Share Your Card"]}),a.jsx(eh.Be,{children:"Your card is ready to share! Copy the link or send it via email."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Share URL"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(h.I,{value:R,readOnly:!0,className:"flex-1"}),a.jsx(l.z,{onClick:ej,variant:"outline",size:"sm",children:a.jsx(ew.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Send via Email"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(h.I,{type:"email",placeholder:"recipient@example.com",value:O,onChange:e=>B(e.target.value),className:"flex-1"}),a.jsx(l.z,{onClick:eE,variant:"outline",size:"sm",disabled:!O.trim()||V,children:V?a.jsx(ec.Z,{className:"w-4 h-4 animate-spin"}):a.jsx(ek,{className:"w-4 h-4"})})]}),a.jsx("p",{className:"text-xs text-gray-500",children:V?"Sending email...":"Sends the card directly via email"})]})]})]})}),a.jsx(aF,{children:x&&a.jsx(aR.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-sm",onClick:ei,children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(el.C,{className:`${G[c].color} text-white px-4 py-2`,children:G[c].title}),a.jsx("span",{className:"text-white/80 text-sm hidden md:block",children:G[c].subtitle})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-white/80 text-sm",children:[c+1," / ",G.length]}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),Q()},className:"h-9 w-9 p-0 text-white hover:bg-white/10",children:f?a.jsx(ep,{className:"w-5 h-5"}):a.jsx(em,{className:"w-5 h-5"})}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),ei()},className:"h-9 w-9 p-0 text-white hover:bg-white/10",children:a.jsx(ee.Z,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"flex-1 relative px-4 md:px-6 pb-6",children:(0,a.jsxs)("div",{className:"h-full relative",children:[a.jsx(aF,{initial:!1,custom:p,children:a.jsx(aR.div,{custom:p,variants:a$,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2},scale:{duration:.2}},drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(e,{offset:t,velocity:i})=>{let r=aU(t.x,i.x);r<-1e4?K(1):r>1e4&&K(-1)},className:"absolute inset-0 cursor-grab active:cursor-grabbing",onClick:e=>e.stopPropagation(),children:a.jsx("div",{className:"h-full flex items-center justify-center",children:G[c].image?a.jsx("img",{src:G[c].image,alt:G[c].title,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",draggable:!1}):a.jsx("div",{className:"flex items-center justify-center bg-gray-800 rounded-lg p-8",children:a.jsx("p",{className:"text-white/70",children:"Loading section..."})})})},`fullscreen-${c}`)}),a.jsx(aR.button,{className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black/50 backdrop-blur-sm rounded-full p-3 text-white hover:bg-black/70 transition-colors z-10",onClick:e=>{e.stopPropagation(),K(-1)},whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(ey,{className:"w-6 h-6"})}),a.jsx(aR.button,{className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black/50 backdrop-blur-sm rounded-full p-3 text-white hover:bg-black/70 transition-colors z-10",onClick:e=>{e.stopPropagation(),K(1)},whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(ev.Z,{className:"w-6 h-6"})})]})}),a.jsx("div",{className:"flex items-center justify-center gap-3 pb-6",children:G.map((e,t)=>a.jsx(aR.button,{className:`transition-all duration-300 ${t===c?"w-8 h-3 bg-white rounded-full":"w-3 h-3 bg-white/40 rounded-full hover:bg-white/60"}`,onClick:e=>{e.stopPropagation(),J(t)},whileHover:{scale:1.2},whileTap:{scale:.9}},`fullscreen-indicator-${e.id}`))}),a.jsx("div",{className:"px-6 pb-6",children:a.jsx(aR.p,{className:"text-white/80 text-center text-sm md:text-base leading-relaxed max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:G[c].description})})]})})}),a.jsx(eh.Vq,{open:!!w,onOpenChange:e=>!e&&k(null),children:(0,a.jsxs)(eh.cZ,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(eh.fK,{children:[(0,a.jsxs)(eh.$N,{className:"flex items-center gap-2",children:[a.jsx(X,{className:"w-5 h-5 text-blue-600"}),w?G.find(e=>e.id===w)?.editLabel:"Edit Section"]}),a.jsx(eh.Be,{children:"interior"===w?(0,a.jsxs)(a.Fragment,{children:["Describe how you'd like to modify this section of your card. This interior has ",a.jsx("strong",{children:"two areas"}),": decorative artwork on the left and your message on the right. Be specific about which area you want to change and what modifications you want.",a.jsx("br",{}),a.jsx("br",{}),(0,a.jsxs)("span",{className:"text-amber-600 dark:text-amber-400 text-sm",children:["\uD83D\uDCA1 ",a.jsx("strong",{children:"Tip:"}),' Specify "left side" for decorative changes or "right side" for message changes to ensure both areas are preserved.']})]}):"Describe how you'd like to modify this section of your card. Be specific about colors, style, content, or any changes you want to make."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[w&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Current Image","left-interior"===w||"right-interior"===w?"s":""]}),a.jsx("div",{className:"border-2 border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden bg-white",children:"left-interior"===w||"right-interior"===w?(0,a.jsxs)("div",{className:"flex h-64",children:[(0,a.jsxs)("div",{className:"w-1/2 relative",children:[a.jsx("img",{src:$("left-interior",e.leftPage),alt:"Left Interior",className:"w-full h-full object-contain"}),"left-interior"===w&&a.jsx("div",{className:"absolute inset-0 border-4 border-blue-500 bg-blue-500/10"})]}),a.jsx("div",{className:"w-px bg-gray-300"}),(0,a.jsxs)("div",{className:"w-1/2 relative",children:[a.jsx("img",{src:$("right-interior",e.rightPage),alt:"Right Interior",className:"w-full h-full object-contain"}),"right-interior"===w&&a.jsx("div",{className:"absolute inset-0 border-4 border-blue-500 bg-blue-500/10"})]})]}):a.jsx("img",{src:G.find(e=>e.id===w)?.image||"",alt:"Current section",className:"w-full h-64 object-contain"})}),("left-interior"===w||"right-interior"===w)&&a.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"The highlighted area shows which side you're editing. Both sides are shown for context."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Edit Instructions"}),a.jsx(d,{placeholder:"e.g., Change the background to a sunset sky, make the flowers more colorful, add sparkles, change the text style to handwritten...",value:T,onChange:e=>C(e.target.value),rows:4,className:"resize-none",style:{fontSize:"16px"}}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Be specific about what you want to change. Only the areas you describe will be modified while keeping the rest intact."})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx(l.z,{onClick:()=>k(null),variant:"outline",className:"flex-1",disabled:j,children:"Cancel"}),a.jsx(l.z,{onClick:en,disabled:!T.trim()||j,className:"flex-1 bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700",children:j?(0,a.jsxs)(a.Fragment,{children:[a.jsx(ec.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Editing..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(X,{className:"w-4 h-4 mr-2"}),"Apply Edit"]})})]})]})]})})]})}var aY=i(31270),aH=i(22665),aW=i(94150);let aq="https://vibecarding.com",aZ=[{id:"custom",label:"Custom",description:"Create your own unique card type",icon:I},{id:"birthday",label:"Birthday",description:"Celebrate another year of life",icon:L},{id:"thank-you",label:"Thank You",description:"Express gratitude and appreciation",icon:O},{id:"anniversary",label:"Anniversary",description:"Commemorate special milestones",icon:B},{id:"congratulations",label:"Congratulations",description:"Celebrate achievements and success",icon:V},{id:"holiday",label:"Holiday",description:"Seasonal and holiday greetings",icon:F},{id:"get-well",label:"Get Well Soon",description:"Send healing wishes and support",icon:$},{id:"sympathy",label:"Sympathy",description:"Offer comfort during difficult times",icon:U},{id:"love",label:"Love & Romance",description:"Express romantic feelings",icon:B},{id:"graduation",label:"Graduation",description:"Celebrate educational achievements",icon:z},{id:"new-baby",label:"New Baby",description:"Welcome new arrivals",icon:Y},{id:"wedding",label:"Wedding",description:"Celebrate unions and marriages",icon:H},{id:"retirement",label:"Retirement",description:"Honor career achievements",icon:W},{id:"housewarming",label:"Housewarming",description:"Welcome to new homes",icon:q},{id:"apology",label:"Apology",description:"Make amends and seek forgiveness",icon:Z},{id:"thinking-of-you",label:"Thinking of You",description:"Show you care and remember",icon:G.Z}],aG=[{id:"funny",label:"\uD83D\uDE04 Funny",description:"Humorous and lighthearted"},{id:"genz-humor",label:"\uD83D\uDC80 GenZ Humor",description:"Internet memes, chaotic energy, and unhinged vibes"},{id:"romantic",label:"\uD83D\uDC95 Romantic",description:"Sweet and loving"},{id:"professional",label:"\uD83D\uDC54 Professional",description:"Formal and business-appropriate"},{id:"heartfelt",label:" Heartfelt",description:"Sincere and emotional"},{id:"playful",label:"\uD83C\uDF89 Playful",description:"Fun and energetic"},{id:"elegant",label:" Elegant",description:"Sophisticated and refined"},{id:"casual",label:"\uD83D\uDE0A Casual",description:"Relaxed and friendly"},{id:"inspirational",label:"\uD83C\uDF1F Inspirational",description:"Motivating and uplifting"},{id:"quirky",label:"\uD83E\uDD2A Quirky",description:"Unique and unconventional"},{id:"traditional",label:"\uD83C\uDFAD Traditional",description:"Classic and timeless"}],aK=[{id:"ai-smart-style",label:" Smart Style",description:"Let our experts choose the perfect style for your card",promptModifier:""},{id:"custom",label:" Custom Style",description:"Define your own unique artistic style",promptModifier:""},{id:"watercolor",label:"\uD83C\uDFA8 Watercolor",description:"Soft, flowing paint effects (our personal favorite)",promptModifier:"in watercolor painting style, with soft flowing colors, artistic brush strokes, paper texture, and organic paint bleeds"},{id:"minimalist",label:" Minimalist",description:"Clean, simple, elegant design",promptModifier:"in minimalist style with clean lines, simple shapes, plenty of white space, sophisticated typography, and elegant simplicity"},{id:"dreamy-fantasy",label:"\uD83C\uDF38 Dreamy Fantasy",description:"Enchanting anime-inspired art",promptModifier:"in dreamy fantasy anime style, with soft pastels, magical atmosphere, detailed nature elements, whimsical characters, and enchanting fairy-tale qualities"},{id:"art-deco",label:" Art Deco",description:"Elegant 1920s geometric luxury",promptModifier:"in vintage Art Deco style with geometric patterns, gold accents, elegant typography, luxurious details, and 1920s glamour"},{id:"pop-art",label:"\uD83C\uDFAD Pop Art",description:"Bold, colorful comic book style",promptModifier:"in pop art style like Andy Warhol and Roy Lichtenstein, with bold colors, comic book elements, halftone dots, and graphic design aesthetics"},{id:"impressionist",label:"\uD83D\uDDBC Impressionist",description:"Soft brushstrokes like Monet",promptModifier:"in impressionist painting style like Monet and Renoir, with soft brush strokes, light and shadow play, and dreamy atmospheric effects"},{id:"retro-vintage",label:"\uD83D\uDCFB Retro Vintage",description:"Classic 1950s-60s nostalgia",promptModifier:"in retro vintage style with 1950s-60s aesthetics, classic typography, warm nostalgic colors, and mid-century design elements"}],aJ=[{id:"standard",label:"5\xd77 Card (Standard)",description:"Standard 5\xd77 greeting card (10\xd77 print layout)",aspectRatio:"9:16",dimensions:"1024x1536",printWidth:"10in",printHeight:"7in"},{id:"a6",label:"A6 Card (4\xd76)",description:"A6 paper size (8.3\xd75.8 print layout)",aspectRatio:"2:3",dimensions:"768x1152",printWidth:"8.3in",printHeight:"5.8in"}],aQ=[{id:"gpt-image-1",label:"GPT Image 1",description:"Highest quality variant : Recommended"},{id:"imagen-4.0-ultra-generate-preview-06-06",label:"Imagen 4.0 Ultra",description:"Experimental, not recommended for text-heavy cards."}];async function aX(e,t,i){if(e.trim())try{let r=await fetch("https://16504442930.work/send_email_with_attachments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,from:"vibecarding@ast.engineer",subject:`Your ${t} card is ready! `,body:`Hi there!

Thank you for using VibeCarding to create your beautiful ${t} card! 

We hope you love how it turned out. Your card has been generated and is ready for printing or sharing.

View your card: ${i}

If you have any questions or feedback, feel free to reach out to us.

Happy card making! 

Best regards,
The VibeCarding Team
vibecarding@ast.engineer`,html:!1})});await fetch("https://16504442930.work/send_email_with_attachments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:"jordan@ast.engineer",from:"vibecarding@ast.engineer",subject:`Card Created - ${t} for ${e}`,body:`New card created on VibeCarding:

User: ${e}
Card Type: ${t}
Card URL: ${i}

This is an automated notification of card creation activity.`,html:!1})}),r.ok&&eo.Am.success(" Thank you email sent!")}catch(e){console.error("Failed to send thank you email:",e)}}async function a0(e,t={}){let{systemPrompt:i=null,model:r="gemini-2.5-pro",includeThoughts:s=!1,jsonSchema:n=null}=t;try{let t;let a=await fetch("/internal/call_mcp_tool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool_name:"ai_chat",arguments:{messages:e,system_prompt:i,model:r,include_thoughts:s,json_schema:n}})});if(!a.ok)throw Error(`HTTP ${a.status}`);let o=await a.json();if(o.error&&"None"!==o.error&&null!==o.error)throw Error(o.error);if("string"==typeof o.result)try{t=JSON.parse(o.result)}catch{t={status:"error",message:"Invalid JSON response"}}else t=o.result;if("error"===t.status)throw Error(t.message);return t.response}catch(e){throw console.error("AI chat failed:",e),e}}function a1(){let[e,t]=(0,o.useState)(""),[i,r]=(0,o.useState)(""),[s,n]=(0,o.useState)(""),[c,m]=(0,o.useState)(""),[f,g]=(0,o.useState)("birthday"),[y,v]=(0,o.useState)(""),[x,b]=(0,o.useState)("funny"),[w,k]=(0,o.useState)(!1),[T,C]=(0,o.useState)(null),[j,E]=(0,o.useState)(1),[A,S]=(0,o.useState)([]),[M,R]=(0,o.useState)(0),[D,I]=(0,o.useState)(!1),[L,O]=(0,o.useState)(!1),[B,V]=(0,o.useState)("ai-smart-style"),[F,$]=(0,o.useState)(""),[U,z]=(0,o.useState)("gpt-image-1"),[Y,H]=(0,o.useState)(""),[W,q]=(0,o.useState)(0),[Z,G]=(0,o.useState)(null),el=async(e,t)=>{console.log("\uD83D\uDD27 Starting QR overlay for:",t);try{console.log("\uD83D\uDCF1 Generating QR code...");let i=await aY.toDataURL(t,{width:120,margin:1,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"});console.log(" QR code generated successfully");let r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw Error("Failed to get canvas context");let n=new Image;return new Promise((t,a)=>{n.onload=()=>{console.log("\uD83D\uDDBC Back cover image loaded, size:",n.width,"x",n.height),r.width=n.width,r.height=n.height,s.drawImage(n,0,0);let e=new Image;e.onload=()=>{console.log("\uD83D\uDCF1 QR code image loaded, overlaying...");let i=r.width-120-40,n=r.height-120-40-30;console.log("\uD83D\uDCCD QR position:",i,n,"on canvas:",r.width,"x",r.height),s.fillStyle="#FFFFFF",s.beginPath(),s.roundRect(i-15,n-15,150,175,8),s.fill(),s.strokeStyle="rgba(0, 0, 0, 0.1)",s.lineWidth=1,s.stroke(),s.drawImage(e,i,n,120,120),s.fillStyle="#666666",s.font="16px system-ui, -apple-system, sans-serif",s.textAlign="center",s.fillText("Scan me :)",i+60,n+120+15);let a=r.toDataURL("image/png",.9);console.log(" QR overlay complete, result length:",a.length),t(a)},e.onerror=e=>{console.error(" Failed to load QR code image:",e),a(Error("Failed to load QR code"))},e.src=i},n.onerror=e=>{console.error(" Failed to load back cover image:",e),a(Error("Failed to load back cover image"))},n.src=e})}catch(t){return console.error(" Error overlaying QR code:",t),e}},[eh,ec]=(0,o.useState)(null),[ed,eu]=(0,o.useState)(null),[ep,em]=(0,o.useState)(null),[ef,eg]=(0,o.useState)(null),[ey,ev]=(0,o.useState)(""),[ex,eb]=(0,o.useState)(!1),[ew,ek]=(0,o.useState)(""),[eT,eC]=(0,o.useState)(null),[ej,eE]=(0,o.useState)(!1),[eP,eA]=(0,o.useState)(!1),[e_,eS]=(0,o.useState)("standard"),[eN,eM]=(0,o.useState)({frontCover:"idle",backCover:"idle",leftInterior:"idle",rightInterior:"idle"}),eR=async()=>{if(!e.trim()){eo.Am.error("Please describe your card first!");return}if("custom"===f&&!y.trim()){eo.Am.error("Please describe your custom card type first!");return}I(!0);try{let t="custom"===f?y:f,i=aG.find(e=>e.id===x),n=i?i.description.toLowerCase():"heartfelt and sincere",a=`Create a ${n} message for a ${t} greeting card.

Card Theme/Description: "${e}"
${s?`Recipient: ${s}`:"Recipient: [not specified]"}
${c?`Sender: ${c}`:"Sender: [not specified]"}
Card Tone: ${i?i.label:"Heartfelt"} - ${n}

Instructions:
- Write a message that is ${n} and feels personal and genuine
- ${s?`Address the message to ${s} directly, using their name naturally`:"Write in a way that could be personalized to any recipient"}
- ${c?`Write as if ${c} is personally writing this message`:`Write in a ${n} tone`}
- Match the ${n} tone and occasion of the ${t} card type
- Be inspired by the theme: "${e}"
- Keep it concise but meaningful (2-4 sentences ideal)
- Make it feel authentic, not generic
- SAFETY: Never include brand names, character names, trademarked terms, or inappropriate content. If the theme references these, use generic alternatives or focus on the emotions/concepts instead
- Keep content family-friendly and appropriate for all ages
- ${"funny"===x?"Include appropriate humor that fits the occasion":""}
- ${"genz-humor"===x?'Use GenZ humor with internet slang, memes, and chaotic energy - think "no cap", "periodt", "it\'s giving...", "slay", etc. Be unhinged but endearing':""}
- ${"professional"===x?"Keep it formal and business-appropriate":""}
- ${"romantic"===x?"Include loving and romantic language":""}
- ${"playful"===x?"Use fun and energetic language":""}
- ${s&&c?`Show the relationship between ${c} and ${s} through the ${n} message tone`:""}
- ${c?`End the message with a signature line like "Love, ${c}" or "- ${c}" or similar, naturally integrated into the message.`:""}

Return ONLY the message text that should appear inside the card - no quotes, no explanations, no markdown formatting (no *bold*, _italics_, or other markdown), just the complete ${n} message in plain text.

IMPORTANT: Wrap your final message in <MESSAGE> </MESSAGE> tags. Everything outside these tags will be ignored.`,o=await a0(a,{model:"gemini-2.5-pro",includeThoughts:!1});if(o?.trim()){let e=o.match(/<MESSAGE>([\s\S]*?)<\/MESSAGE>/),t=e?e[1].trim():o.trim();r(t),eo.Am.success(" Personalized message created!")}}catch(e){eo.Am.error("Failed to generate message. Please try again.")}finally{I(!1)}},eD=async e=>{try{let t;let i=`Analyze this reference photo and provide a detailed description of the people and visual elements that can be used to recreate them as stylized cartoon/illustrated characters in a greeting card.

Focus on:
- Number of people and their approximate ages/relationships
- Hair colors, styles, and lengths
- Eye colors and facial features (in general terms)
- Clothing colors and styles
- Body language and poses
- Background elements or setting
- Overall mood and atmosphere

Provide a detailed but concise description that would help an artist recreate these people as charming, stylized cartoon characters while maintaining their key identifying features. Avoid realistic depictions - focus on cartoon/illustration style descriptions.

Format as a single paragraph description suitable for an image generation prompt.`,r=await fetch("/internal/call_mcp_tool",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool_name:"analyze_images",arguments:{urls:[e],analysis_prompt:i}})});if(!r.ok)throw Error(`Analysis failed: ${r.status}`);let s=await r.json();if(s.error&&"None"!==s.error&&null!==s.error)throw Error(s.error);if("string"==typeof s.result)try{t=JSON.parse(s.result)}catch{t={status:"error",message:"Invalid JSON response"}}else t=s.result;if("error"===t.status)throw Error(t.message);if("success"===t.status&&t.results&&t.results.length>0){let e=t.results[0];if("success"===e.status&&e.analysis)return e.analysis;throw Error(e.message||"Image analysis failed")}throw Error("No analysis results returned")}catch(e){return console.error("Image analysis failed:",e),null}},eI=async(e,t)=>{if(!e.type.startsWith("image/")){eo.Am.error("Please upload an image file");return}eb(!0);try{let i=new FormData;i.append("file",e);let r=await fetch(`${aq}/upload`,{method:"POST",body:i});if(!r.ok)throw Error(`Upload failed: ${r.status}`);let s=await r.json();"handwriting"===t?(ec(e),eu(s.url),eo.Am.success("Handwriting sample uploaded!")):(em(e),eg(s.url),eo.Am.success("Reference image uploaded!"))}catch(e){eo.Am.error("Upload failed. Please try again.")}finally{eb(!1)}},eL=async()=>{if(!e.trim()){eo.Am.error("Please describe your card");return}if(!ew.trim()){eo.Am.error("Please enter your email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ew)){eo.Am.error("Please enter a valid email address");return}if("custom"===B&&!F.trim()){eo.Am.error("Please describe your custom artistic style");return}let t="custom"===f?y:f,n=aG.find(e=>e.id===x),a=n?n.description.toLowerCase():"heartfelt and sincere",o=i;if(ej)o="[Blank space for handwritten message]";else if(!o.trim()&&!eP){H(" Penning the perfect words just for you..."),I(!0);try{let i=`Create a ${a} message for a ${t} greeting card.

Card Theme/Description: "${e}"
${s?`Recipient: ${s}`:"Recipient: [not specified]"}
${c?`Sender: ${c}`:"Sender: [not specified]"}
Card Tone: ${n?n.label:"Heartfelt"} - ${a}

Instructions:
- Write a message that is ${a} and feels personal and genuine
- ${s?`Address the message to ${s} directly, using their name naturally`:"Write in a way that could be personalized to any recipient"}
- ${c?`Write as if ${c} is personally writing this message`:`Write in a ${a} tone`}
- Match the ${a} tone and occasion of the ${t} card type
- Be inspired by the theme: "${e}"
- Keep it concise but meaningful (2-4 sentences ideal)
- Make it feel authentic, not generic
- SAFETY: Never include brand names, character names, trademarked terms, or inappropriate content. If the theme references these, use generic alternatives or focus on the emotions/concepts instead
- Keep content family-friendly and appropriate for all ages
- ${"funny"===x?"Include appropriate humor that fits the occasion":""}
- ${"genz-humor"===x?'Use GenZ humor with internet slang, memes, and chaotic energy - think "no cap", "periodt", "it\'s giving...", "slay", etc. Be unhinged but endearing':""}
- ${"professional"===x?"Keep it formal and business-appropriate":""}
- ${"romantic"===x?"Include loving and romantic language":""}
- ${"playful"===x?"Use fun and energetic language":""}
- ${s&&c?`Show the relationship between ${c} and ${s} through the ${a} message tone`:""}
- ${c?`End the message with a signature line like "Love, ${c}" or "- ${c}" or similar, naturally integrated into the message.`:""}

Return ONLY the message text that should appear inside the card - no quotes, no explanations, no markdown formatting (no *bold*, _italics_, or other markdown), just the complete ${a} message in plain text.

IMPORTANT: Wrap your final message in <MESSAGE> </MESSAGE> tags. Everything outside these tags will be ignored.`,l=await a0(i,{model:"gemini-2.5-pro",includeThoughts:!1});if(l?.trim()){let e=l.match(/<MESSAGE>([\s\S]*?)<\/MESSAGE>/);o=e?e[1].trim():l.trim(),r(o),H(" Perfect message crafted! Now for the magic visuals..."),eo.Am.success(" Generated a personalized message for your card!")}else o=e;I(!1)}catch{o=e,I(!1)}}k(!0),H("\uD83C\uDFA8 Gathering artistic inspiration...");let l=(0,aH.Z)();eC(l);let h=`${aq}/card/${l}`;S([]),R(0);try{H("\uD83C\uDFA8 Applying your artistic style...");let r=aK.find(e=>e.id===B),d=r?r.promptModifier:"";if("ai-smart-style"===B){H(" Style experts selecting the perfect look...");try{let r=`You are an expert art director specializing in beautiful, heartfelt greeting cards. Your job is to choose the perfect artistic style that will create a warm, emotional, and memorable card.

Card Details:
- Type: ${t}
- Theme/Description: "${e}"
${s?`- Recipient: ${s}`:""}
${c?`- Sender: ${c}`:""}
${ef?"- Has reference photo for transformation":""}
${ej?"- Will have handwritten message":`- Message: "${i}"`}

IMPORTANT GUIDELINES:
- Choose styles that are WARM, EMOTIONAL, and PERSONAL (greeting cards are about human connection)
- AVOID: robots, tech, cyberpunk, futuristic, sci-fi, digital, mechanical themes
- PREFER: watercolor, oil painting, hand-drawn, illustrated, artistic, painterly, natural, organic styles
- Consider the emotional tone: joyful, loving, celebratory, peaceful, artistic
- Think about what would make someone smile when they receive this card

Great card styles include:
- Watercolor illustrations with soft, flowing colors
- Hand-painted artwork with visible brushstrokes
- Charming illustrated characters and scenes
- Beautiful botanical and nature themes
- Vintage artistic styles with character
- Warm, inviting color palettes
- Artistic techniques that feel handmade and personal

Choose ONE artistic style that perfectly matches this ${t} card's emotional purpose. Respond with:
"in [detailed artistic style description focusing on warmth, beauty, and emotional appeal]"

Make it feel like something created with love for someone special.`,n=await a0(r,{model:"gemini-2.5-pro",includeThoughts:!1});n?.trim()?(d=n.trim(),H(" Perfect style chosen! Time to bring your card to life..."),eo.Am.success("\uD83C\uDFA8 Perfect artistic style chosen for your card!")):d="in a sophisticated artistic style with harmonious colors, elegant composition, and beautiful visual elements perfectly suited for this special card"}catch(e){console.error("Style selection failed:",e),d="in a sophisticated artistic style with harmonious colors, elegant composition, and beautiful visual elements perfectly suited for this special card",eo.Am.info("Using a beautiful default style for your card")}}else"custom"===B&&F.trim()?d=`in ${F.trim()}`:"custom"!==B||F.trim()||(d="in artistic style with creative and unique visual elements");let u=aJ.find(e=>e.id===e_)||aJ[0];H(` Crafting ${j} masterpiece design${j>1?"s":""}...`);let p=`Create ${eP?"2":"4"} prompts for a cohesive, chronologically flowing ${t} greeting card that tells a visual story (${u.aspectRatio} ratio):

 CREATIVITY MANDATE: Be genuinely creative, unique, and innovative! Avoid generic or clich\xe9 designs. Think outside the box, surprise with unexpected elements, use bold artistic choices, and create something truly memorable and special. Push creative boundaries while staying appropriate for the card type and tone.

Theme: "${e}"
Style: ${r?.label||"Default"}
Tone: ${n?n.label:"Heartfelt"} - ${a}
${s?`To: ${s}`:""}
${c?`From: ${c}`:""}
${eP?"":`Message: "${o}"`}
${ej?"Note: Include space for handwritten message":""}
${ef?`Reference: "${ey||"artistic transformation"}"`:""}

CRITICAL: Create a cohesive visual narrative that flows chronologically through the card experience:
1. FRONT COVER: First impression - sets the scene/introduces the story
2. INTERIOR SPREAD: The heart of the experience - continuation and climax of the visual story
3. BACK COVER: Conclusion - peaceful resolution or complementary ending

Requirements:
- Flat 2D artwork for printing (not 3D card images)
- Full-bleed backgrounds extending to edges
- IMPORTANT: Keep text, faces, and key elements at least 10% away from top/bottom edges (small amount may be cropped in printing)
- Keep text/faces 0.5" from left/right edges for safe printing
- CONSISTENT visual elements throughout: same characters, color palette, lighting, art style
- Progressive visual storytelling from front  interior  back
- Put any text in quotes and make it clear/readable
- Each section should feel like part of the same artistic universe
- TONE: Ensure the visual mood and atmosphere matches the ${a} tone throughout all sections
- INTELLECTUAL PROPERTY SAFETY: If the user mentions specific characters, brands, logos, or products, automatically replace them with original generic alternatives in your prompts. For example: replace specific character names with "cartoon mouse character" or "superhero character", replace brand names with "colorful cereal" or "sports car", etc. Create inspired-by designs that capture the essence without referencing any protected names or specific copyrighted elements. Never include actual brand names, character names, or trademarked terms in the image generation prompts
- CONTENT SAFETY: Ensure all prompts are family-friendly and appropriate for greeting cards. Avoid any content that could be flagged by safety systems including: violence, weapons, inappropriate imagery, political content, controversial topics, scary or disturbing elements, or anything not suitable for all ages. If the user requests something potentially inappropriate, redirect to positive, wholesome alternatives that capture their intent in a family-friendly way
${"funny"===x?"- Include visual humor, playful elements, and whimsical details":""}
${"genz-humor"===x?"- Include GenZ visual elements like chaotic energy, internet meme references, bold contrasting colors, and unhinged but endearing visual style":""}
${"romantic"===x?"- Include romantic elements like soft lighting, hearts, flowers, or intimate scenes":""}
${"professional"===x?"- Keep visuals clean, sophisticated, and business-appropriate":""}
${"playful"===x?"- Include bright colors, dynamic poses, and energetic visual elements":""}
${"elegant"===x?"- Focus on sophisticated design, refined color palettes, and graceful compositions":""}
${ef?"- Create cartoon/illustrated characters inspired by reference image - DO NOT make realistic depictions":""}

Create prompts that flow chronologically:

1. Front Cover (Opening Scene): BE GENUINELY CREATIVE AND UNIQUE! Include "${t}" greeting text positioned safely in the center area (avoid top/bottom 10% of image). ${ef?"I have included my own reference image. Create a stylized cartoon/illustrated character inspired by the reference image - DO NOT make realistic depictions of real people, instead create charming cartoon-style characters with simplified, friendly features.":"Create charming cartoon-style or stylized illustrated figures if people are needed for the theme."} This is the story opening - introduce key visual elements (colors, motifs, artistic style) that will continue throughout the other sections. Think of something unexpected, innovative, and memorable that will surprise and delight the recipient. Avoid generic designs! Style: ${d}

2. ${eP?"":`Left Interior (Story Development): UNLEASH YOUR CREATIVITY! You have complete creative freedom to design whatever you want for this left interior page! This is your artistic playground - create something genuinely innovative and unexpected that feels right for a ${t} card with ${a} tone. You can include: scenes, landscapes, objects, patterns, quotes, text, illustrations, realistic art, abstract art, or anything else that inspires you - but NO PEOPLE or characters unless the user specifically mentioned wanting people in their card description. Position any text safely in center area (avoid top/bottom 10%). Think of something no one has done before! Surprise us with bold, imaginative, and memorable artistic choices while maintaining visual harmony with the overall card style and tone. Style: ${d}

3. Right Interior (Story Climax): BE CREATIVE WITH MESSAGE DESIGN! ${ej?"Design with elegant writing space that complements the visual story from left interior. Position decorative elements safely away from top/bottom edges. Create innovative and artistic decorative elements, borders, or flourishes that are unique and memorable - NO PEOPLE or characters.":`Include message text: "${o}" positioned safely in center area (avoid top/bottom 10% of image) integrated into beautiful, innovative decorative artwork. Think beyond typical florals and patterns - create something unexpected and artistic that perfectly frames the message - NO PEOPLE or characters.`} This should feel like the emotional peak of the card experience, harmonizing with the left interior as a cohesive spread. Avoid clich\xe9 designs and create something genuinely special!${ed?" Match handwriting style.":""} Style: ${d}

4. `}Back Cover (Story Resolution): BE SUBTLY CREATIVE! Create a simple yet innovative decorative design that brings peaceful closure to the visual story. Reference subtle elements from the front cover but keep it minimal and serene - NO PEOPLE, just beautiful, unexpected artistic elements that go beyond typical patterns or florals. Think of something quietly beautiful and memorable that complements the overall design while being genuinely unique. This should feel like a peaceful, artistic ending that surprises with its subtle creativity. Style: ${d}

VISUAL CONTINUITY CHECKLIST:
- Same color palette across all sections
- Consistent lighting/time of day
- Same artistic techniques and brushwork
- Recurring visual motifs or symbols (but make them unique and memorable!)
- Progressive emotional journey from introduction to resolution
- Front cover: stylized cartoon/illustrated characters if people are needed for the theme
- Left interior: CREATIVE FREEDOM but NO PEOPLE unless user specifically requested people in their description
- Right interior: focus on message space with innovative decorative elements (NO PEOPLE)
- Back cover: simple yet creative decorative design without text or people
- Use simplified, friendly, charming character design if including people (front cover only)
- CREATIVITY PRIORITY: Always choose the more innovative, surprising, and memorable option over generic designs

Return JSON:
{
  "frontCover": "detailed prompt with story opening elements",
  "backCover": "detailed prompt with story conclusion elements"${eP?"":',\n  "leftInterior": "detailed prompt with story development elements",\n  "rightInterior": "detailed prompt with story climax elements"'}
}

IMPORTANT: Create a completely unique and different interpretation for this specific card variant. Use different creative approaches, color schemes, compositions, and artistic elements while maintaining the same core theme and requirements.`,m=Array.from({length:j},(e,t)=>{let i=p+`

 CARD VARIANT ${t+1} CREATIVE DIRECTION: 
Create a completely unique visual interpretation that's distinctly different from other possible variants. Use different:
- Color palettes and mood lighting
- Artistic composition and layout approaches  
- Creative visual metaphors and symbols
- Character designs and poses (if applicable)
- Background elements and settings
- Typography styles and text placement
- Overall creative theme while keeping same core message

Make this card variant stand out as its own unique artistic vision!

Return JSON:
{
  "frontCover": "detailed prompt with story opening elements",
  "backCover": "detailed prompt with story conclusion elements"${eP?"":',\n  "leftInterior": "detailed prompt with story development elements",\n  "rightInterior": "detailed prompt with story climax elements"'}
}`;return a0(i,{jsonSchema:{type:"object",properties:{frontCover:{type:"string"},backCover:{type:"string"},...eP?{}:{leftInterior:{type:"string"},rightInterior:{type:"string"}}},required:["frontCover","backCover",...eP?[]:["leftInterior","rightInterior"]]},includeThoughts:!1})}),g=await Promise.all(m);H(` ${j} brilliant design${j>1?"s":""} ready! Now painting them into reality...`),H(` Generating your ${j} card${j>1?"s":""} with ${eP?"2":"4"} images each...`);let v=null;ef&&(H(` Analyzing reference photo...`),eo.Am.info("Analyzing reference photo..."),(v=await eD(ef))?(H(` Reference photo analyzed.`),eo.Am.success("\uD83D\uDCDD Reference photo analyzed successfully!")):eo.Am.info("Using reference photo as-is (analysis not available)"));let b=[],w=[],k=[];"gpt-image-1"===U&&ed&&!eP&&k.push(ed);let E=[];g.forEach((e,t)=>{let i=e.frontCover;v&&(i=`${e.frontCover}

IMPORTANT: Based on this detailed description of people from the reference photo, create stylized cartoon/illustrated characters with these specific features: "${v}". Transform these real people into charming, friendly cartoon-style characters while maintaining their key identifying characteristics (hair color, clothing, poses, etc.).`);let r=[{tool_name:"generate_images_with_prompts",arguments:{user_number:"+17145986105",prompts:[i],model_version:U,aspect_ratio:u.aspectRatio,quality:"high",output_format:"jpeg",output_compression:100,moderation:"auto"},user_id_context:"+17145986105",cardIndex:t,sectionIndex:0,sectionName:"Front Cover"},{tool_name:"generate_images_with_prompts",arguments:{user_number:"+17145986105",prompts:[e.backCover],model_version:U,aspect_ratio:u.aspectRatio,quality:"high",output_format:"jpeg",output_compression:100,moderation:"auto",...b.length>0&&{input_images:[b]}},user_id_context:"+17145986105",cardIndex:t,sectionIndex:1,sectionName:"Back Cover"}];!eP&&e.leftInterior&&e.rightInterior&&r.push({tool_name:"generate_images_with_prompts",arguments:{user_number:"+17145986105",prompts:[e.leftInterior],model_version:U,aspect_ratio:u.aspectRatio,quality:"high",output_format:"jpeg",output_compression:100,moderation:"auto",...w.length>0&&{input_images:[w]}},user_id_context:"+17145986105",cardIndex:t,sectionIndex:2,sectionName:"Left Interior"},{tool_name:"generate_images_with_prompts",arguments:{user_number:"+17145986105",prompts:[e.rightInterior],model_version:U,aspect_ratio:u.aspectRatio,quality:"high",output_format:"jpeg",output_compression:100,moderation:"auto",...k.length>0&&{input_images:[k]}},user_id_context:"+17145986105",cardIndex:t,sectionIndex:3,sectionName:"Right Interior"}),E.push(...r)});let P=new Map,A=0,_=[];S([]),C(null),R(0),H(` Artists at work! Creating ${E.length} stunning images for your ${j} card${j>1?"s":""}...`),q(150);let N=setInterval(()=>{q(e=>e<=1?(clearInterval(N),0):e-1)},1e3);G(N);let D=async(e,t)=>{try{let t=`The following image prompt was blocked by the safety system. Please rewrite it to be more appropriate while keeping the same artistic intent and style:

BLOCKED PROMPT: "${e}"

Requirements:
- Keep the same artistic style and visual goals
- Remove any content that might trigger safety filters
- Maintain the full-bleed design requirements
- IMPORTANT: Keep text, faces, and key elements at least 10% away from top/bottom edges (small amount may be cropped in printing)
- Focus on safe, family-friendly imagery
- Keep the same color palette and mood
- Ensure it's appropriate for a greeting card

Return only the rewritten prompt, no explanations.`,i=await a0(t,{model:"gemini-2.5-pro",includeThoughts:!1});return i?.trim()||e}catch(t){return console.error("Failed to regenerate prompt:",t),e}},I=async(t,i,r,s=0)=>{let n=t,a=0;for(;a<=2;)try{let t=await fetch(`${aq}/internal/call_mcp_tool`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw Error(`HTTP ${t.status}`);let o=await t.json();if(o.result&&"string"==typeof o.result){let e=JSON.parse(o.result);if("error"===e.status&&e.results?.[0]?.error?.includes("moderation_blocked")){if(a<2){let e=n.arguments.prompts[0],t=await D(e,r);n={...n,arguments:{...n.arguments,prompts:[t]}},a++;continue}throw Error(`Safety system blocked ${r} after 2 attempts`)}}if(o.error&&"None"!==o.error&&null!==o.error)throw Error(o.error);let l=JSON.parse(o.result);if("success"!==l.status)throw Error(`${r} generation failed`);let h=Array.isArray(l.results[0])?l.results[0][0]:l.results[0],c=`${s}-${i}`;P.set(c,h),A++;let d=E.length;H(` ${A}/${d} masterpieces complete! Just finished Card ${s+1} ${r}...`);let u=eP?2:4,p=s*u,m=p+u-1,f=!0;for(let e=p;e<=m;e++){let t=`${s}-${e-p}`;if(!P.has(t)){f=!1;break}}return f&&(S(t=>{let i=[...t];i[s]||(i[s]={id:`card-${s}-${Date.now()}`,prompt:e,frontCover:"",backCover:"",leftPage:"",rightPage:"",createdAt:new Date});let r={...i[s]};return r.frontCover=P.get(`${s}-0`)||"",r.backCover=P.get(`${s}-1`)||"",eP?(r.leftPage=r.backCover,r.rightPage=r.frontCover):(r.leftPage=P.get(`${s}-2`)||"",r.rightPage=P.get(`${s}-3`)||""),i[s]=r,_[s]=r,T&&s!==M||C(r),i}),eo.Am.success(` Card ${s+1} is complete and ready!`)),h}catch(e){if(2===a)throw Error(`Failed to generate ${r}: ${e instanceof Error?e.message:"Unknown error"}`);a++}},L=E.map(e=>I(e,e.sectionIndex,e.sectionName,e.cardIndex));await Promise.all(L);let O=[];for(let e=0;e<j;e++){let t={id:`card-${e}-${Date.now()}`,prompt:p,frontCover:P.get(`${e}-0`)||"",backCover:P.get(`${e}-1`)||"",leftPage:eP?P.get(`${e}-1`)||"":P.get(`${e}-2`)||"",rightPage:eP?P.get(`${e}-0`)||"":P.get(`${e}-3`)||"",createdAt:new Date};O.push(t)}H(" Adding interactive QR codes to your cards..."),console.log("\uD83D\uDD04 Starting QR overlay process for",O.length,"cards"),console.log("\uD83D\uDD17 Card URL:",h);for(let e=0;e<O.length;e++)console.log(` Processing card ${e+1}:`,{hasBackCover:!!O[e].backCover,hasCardUrl:!!h,backCoverLength:O[e].backCover?.length});if(H(""),1===j?eo.Am.success("\uD83C\uDF89 Your complete card with QR code is ready!"):eo.Am.success(` All ${j} cards with QR codes are ready! Choose your favorite below.`),ew.trim()){let e="custom"===f?y:f;try{let t=O[0];if(!t||!t.frontCover){console.log("No card data available for sharing"),aX(ew,e,"https://vibecarding.com");return}let i={id:l,prompt:p,frontCover:t.frontCover||"",backCover:t.backCover||"",leftPage:t.leftPage||"",rightPage:t.rightPage||""};console.log("Storing card data:",i);let r=await fetch("/api/cards/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(r.ok){let t=await r.json();console.log("Card stored successfully, API response:",t);let i=t.share_url||h;console.log("Using actual share URL for QR code:",i);for(let e=0;e<O.length;e++)if(O[e].backCover&&i)try{let t=O[e].backCover;console.log(` Applying QR overlay to card ${e+1} after API storage...`),O[e].backCover=await el(t,i),console.log(` QR overlay complete for card ${e+1}`)}catch(t){console.error(` Failed to overlay QR code on card ${e+1}:`,t)}else console.log(` Skipping QR overlay for card ${e+1} - missing back cover or URL`);console.log("\uD83D\uDD04 Updating displayed cards with QR codes after API storage..."),S([...O]),O.length>0&&C(O[0]),O[0]&&(O[0].shareUrl=i,S(e=>{let t=[...e];return t[0]&&(t[0].shareUrl=i),t})),aX(ew,e,i)}else console.error("Failed to store card:",r.status,await r.text()),aX(ew,e,"https://vibecarding.com")}catch(t){console.error("Error storing card for email:",t),aX(ew,e,"https://vibecarding.com")}}Z&&(clearInterval(Z),G(null)),q(0)}catch(e){H(""),eo.Am.error("Failed to generate card. Please try again."),console.error("Card generation error:",e)}finally{k(!1),Z&&(clearInterval(Z),G(null)),q(0)}},eO=async()=>{if(T)try{let t={front_cover:T.frontCover,back_cover:T.backCover,left_page:T.leftPage,right_page:T.rightPage,card_name:e.substring(0,50)+(e.length>50?"...":""),paper_size:e_,is_front_back_only:eP,copies:1,color_mode:"color",quality:"high"},i=await fetch("/api/print-queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw Error(`HTTP ${i.status}`);let r=await i.json();if("queued"===r.status){r.duplex,eo.Am.success(` Your card is now printing! You can pick it up shortly.`);let e=0,t=async()=>{try{let i=await fetch(`/api/print-status/${r.job_id}`);if(i.ok){let r=await i.json();if("found"===r.status){if("completed"===r.job.status){eo.Am.success(" Your card has been added to the print queue and should be available for pickup shortly.");return}if("failed"===r.job.status){eo.Am.error(" There was an issue with printing. Please try again or contact us for help.");return}"pending"===r.job.status&&e<6&&(e++,setTimeout(t,1e4))}}}catch(e){console.log("Could not check print status:",e)}};setTimeout(t,1e4)}else throw Error(r.error||"Unknown error")}catch(e){console.error("Print error:",e),eo.Am.error("Failed to queue print job")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50 dark:from-gray-900 dark:via-slate-800 dark:to-gray-800",children:[a.jsx("header",{className:"border-b bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm sticky top-0 z-50",children:a.jsx("div",{className:"container mx-auto px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx(ea.default,{href:"/",children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",className:"gap-2",children:[a.jsx(K,{className:"w-4 h-4"}),"Back"]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-lg flex items-center justify-center",children:a.jsx(J.Z,{className:"w-5 h-5 text-white"})}),a.jsx("div",{children:a.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"VibeCarding"})})]})]}),a.jsx(aW.l,{})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[(0,a.jsxs)(u.Zb,{className:"shadow-lg mb-6",children:[(0,a.jsxs)(u.Ol,{children:[(0,a.jsxs)(u.ll,{className:"flex items-center gap-2",children:[a.jsx(J.Z,{className:"w-5 h-5 text-blue-600"}),"Create Your Card"]}),a.jsx(u.SZ,{children:"Describe your card and we'll create it for you"})]}),(0,a.jsxs)(u.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Card Type"}),(0,a.jsxs)(p.Ph,{value:f,onValueChange:g,children:[a.jsx(p.i4,{children:a.jsx(p.ki,{children:(()=>{let e=aZ.find(e=>e.id===f);if(!e)return a.jsx("span",{className:"text-gray-400",children:"Choose card type"});let t=e.icon;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(t,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"font-medium",children:e.label})]})})()})}),a.jsx(p.Bw,{children:aZ.map(e=>{let t=e.icon;return a.jsx(p.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(t,{className:"w-4 h-4 text-gray-500"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})]})},e.id)})})]}),"custom"===f&&(0,a.jsxs)("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Describe Your Card Type"}),a.jsx(h.I,{placeholder:"e.g., Promotion, Moving Away, First Day of School...",value:y,onChange:e=>v(e.target.value),style:{fontSize:"16px"}}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"What type of card is this? This helps personalize the message and style."})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Card Tone & Style"}),(0,a.jsxs)(p.Ph,{value:x,onValueChange:b,children:[a.jsx(p.i4,{children:a.jsx(p.ki,{children:(()=>{let e=aG.find(e=>e.id===x);return e?a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"font-medium",children:e.label})}):a.jsx("span",{className:"text-gray-400",children:"Choose card tone"})})()})}),a.jsx(p.Bw,{children:aG.map(e=>a.jsx(p.Ql,{value:e.id,children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})},e.id))})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Artistic Style"}),(0,a.jsxs)(p.Ph,{value:B,onValueChange:V,children:[a.jsx(p.i4,{children:a.jsx(p.ki,{placeholder:"Choose artistic style"})}),a.jsx(p.Bw,{children:aK.map(e=>a.jsx(p.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"text-left w-full",children:[a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})},e.id))})]}),"custom"===B&&(0,a.jsxs)("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Describe Your Custom Style"}),a.jsx(d,{placeholder:"e.g., in vintage 1920s art deco style with gold accents and geometric patterns...",value:F,onChange:e=>$(e.target.value),rows:3,className:"resize-none",style:{fontSize:"16px"}}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Describe the artistic style you want for your card (colors, techniques, era, mood, etc.)"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"To"}),a.jsx(h.I,{placeholder:"Sarah",value:s,onChange:e=>n(e.target.value),style:{fontSize:"16px"}})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"From"}),a.jsx(h.I,{placeholder:"Alex",value:c,onChange:e=>m(e.target.value),style:{fontSize:"16px"}})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Your Email (Required)"}),a.jsx(h.I,{type:"email",placeholder:"your.email@example.com",required:!0,value:ew,onChange:e=>ek(e.target.value),style:{fontSize:"16px"}}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Required to generate your card. We'll send you a thank you note when it's ready!"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Describe Your Card"}),a.jsx(d,{placeholder:"A cheerful birthday card with flowers and sunshine for my best friend who loves gardening...",value:e,onChange:e=>t(e.target.value),rows:3,className:"resize-none",style:{fontSize:"16px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Card Message"}),(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:eR,disabled:D||!e.trim()||ej,className:"gap-1 text-xs",children:[a.jsx(Q,{className:"w-3 h-3"}),D?"Writing...":"Help me write"]})]}),a.jsx(d,{placeholder:ej?"Leave blank - you'll handwrite your message":"Write your message here, or click 'Help me write' for inspiration...",value:i,onChange:e=>r(e.target.value),rows:3,className:"resize-none",style:{fontSize:"16px"},disabled:ej}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[a.jsx("input",{type:"checkbox",id:"handwritten-message",checked:ej,onChange:e=>{eE(e.target.checked),e.target.checked&&r("")},className:"rounded"}),a.jsx("label",{htmlFor:"handwritten-message",className:"text-sm text-gray-600 dark:text-gray-400",children:"Leave blank space for handwritten message"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Reference Photo (Optional)"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:"Upload a photo to transform into stylized card artwork!"}),a.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mb-3",children:" For your privacy, photos are transformed into cartoon or illustrated style - not exact replicas"}),ep?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(X,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{className:"text-sm text-purple-800 dark:text-purple-200",children:ep.name})]}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{em(null),eg(null),ev("")},children:a.jsx(ee.Z,{className:"w-4 h-4"})})]}),a.jsx(d,{placeholder:"How should we transform your photo? (e.g., 'Turn us into cute cartoon characters while keeping our faces recognizable')",value:ey,onChange:e=>ev(e.target.value),rows:2,className:"resize-none",style:{fontSize:"16px"}})]}):(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:e=>e.target.files?.[0]&&eI(e.target.files[0],"reference"),disabled:ex,className:"hidden",id:"reference-upload"}),(0,a.jsxs)("label",{htmlFor:"reference-upload",className:"cursor-pointer",children:[a.jsx(X,{className:"w-6 h-6 mx-auto mb-2 text-gray-400"}),a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:ex?"Uploading...":"Upload photo to transform"})]})]})]}),(0,a.jsxs)(P,{open:L,onOpenChange:O,children:[a.jsx(_,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-sm font-medium",children:[a.jsx(et.Z,{className:"w-4 h-4"}),"Advanced Options"]}),a.jsx(ei.Z,{className:`w-4 h-4 transition-transform ${L?"rotate-180":""}`})]})}),(0,a.jsxs)(N,{className:"space-y-4 mt-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Image Model"}),(0,a.jsxs)(p.Ph,{value:U,onValueChange:z,children:[a.jsx(p.i4,{children:a.jsx(p.ki,{})}),a.jsx(p.Bw,{children:aQ.map(e=>a.jsx(p.Ql,{value:e.id,children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})},e.id))})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Paper Size"}),(0,a.jsxs)(p.Ph,{value:e_,onValueChange:eS,children:[a.jsx(p.i4,{children:a.jsx(p.ki,{placeholder:"Choose paper size"})}),a.jsx(p.Bw,{children:aJ.map(e=>a.jsx(p.Ql,{value:e.id,children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})},e.id))})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Number of Cards to Generate"}),(0,a.jsxs)(p.Ph,{value:j.toString(),onValueChange:e=>E(parseInt(e)),children:[a.jsx(p.i4,{children:a.jsx(p.ki,{placeholder:"Choose number of cards"})}),(0,a.jsxs)(p.Bw,{children:[a.jsx(p.Ql,{value:"1",children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"1 Card"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Single card generation"})]})}),a.jsx(p.Ql,{value:"2",children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"2 Cards"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Generate 2 variations to choose from"})]})}),a.jsx(p.Ql,{value:"3",children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"3 Cards"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Generate 3 variations to choose from"})]})}),a.jsx(p.Ql,{value:"4",children:(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"4 Cards"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Generate 4 variations to choose from"})]})})]})]}),j>1&&a.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:" Multiple cards will be generated in parallel with the same prompt for creative variety"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 block",children:"Print Options"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"front-back-only",checked:eP,onChange:e=>eA(e.target.checked),className:"rounded"}),a.jsx("label",{htmlFor:"front-back-only",className:"text-sm text-gray-600 dark:text-gray-400",children:"Front/Back only (for single-sided printers)"})]}),eP&&a.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 ml-6",children:"\uD83D\uDCA1 Perfect for single-sided printers - you can write your message inside the folded card"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Handwriting Sample (Optional)"}),eh?(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(es.Z,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:"text-sm text-green-800 dark:text-green-200",children:eh.name})]}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{ec(null),eu(null)},children:a.jsx(ee.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:e=>e.target.files?.[0]&&eI(e.target.files[0],"handwriting"),disabled:ex,className:"hidden",id:"handwriting-upload"}),(0,a.jsxs)("label",{htmlFor:"handwriting-upload",className:"cursor-pointer",children:[a.jsx(er,{className:"w-6 h-6 mx-auto mb-2 text-gray-400"}),a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:ex?"Uploading...":"Upload handwriting sample"})]})]})]})]})]}),(0,a.jsxs)(P,{className:"space-y-2",children:[a.jsx(_,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"ghost",className:"w-full justify-between text-xs text-gray-500 dark:text-gray-400 h-8",children:[a.jsx("span",{children:"Privacy & Terms"}),a.jsx(ei.Z,{className:"h-3 w-3"})]})}),a.jsx(N,{className:"space-y-3",children:(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-300 space-y-3 p-4 border rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-2 text-gray-800 dark:text-gray-200",children:"Privacy Policy"}),(0,a.jsxs)("ul",{className:"space-y-1 text-gray-600 dark:text-gray-400",children:[a.jsx("li",{children:" We collect your email address and card content to provide our service"}),a.jsx("li",{children:" Images and messages are processed using third-party AI services"}),a.jsx("li",{children:" Cards are stored temporarily for delivery and may be cached for performance"}),a.jsx("li",{children:" We do not sell, share, or use your personal data for marketing purposes"}),a.jsx("li",{children:" Your email is only used for card delivery and service communications"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-2 text-gray-800 dark:text-gray-200",children:"Terms of Service"}),(0,a.jsxs)("ul",{className:"space-y-1 text-gray-600 dark:text-gray-400",children:[a.jsx("li",{children:" You must be 13+ years old to use this service"}),a.jsx("li",{children:" You are responsible for the content you submit"}),a.jsx("li",{children:' Service is provided "as-is" without warranties'}),a.jsx("li",{children:" We reserve the right to refuse service for policy violations"}),a.jsx("li",{children:" These terms may be updated with notice on our website"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-2 text-gray-800 dark:text-gray-200",children:"Content Policy"}),(0,a.jsxs)("ul",{className:"space-y-1 text-gray-600 dark:text-gray-400",children:[a.jsx("li",{children:" All content must be family-friendly and appropriate for all audiences"}),a.jsx("li",{children:" No copyrighted characters, logos, or trademarked content"}),a.jsx("li",{children:" No hate speech, harassment, or discriminatory content"}),a.jsx("li",{children:" No illegal, harmful, or explicit material"}),a.jsx("li",{children:" Content may be filtered to ensure compliance with these guidelines"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold mb-2 text-gray-800 dark:text-gray-200",children:"Intellectual Property"}),(0,a.jsxs)("ul",{className:"space-y-1 text-gray-600 dark:text-gray-400",children:[a.jsx("li",{children:" You retain rights to your original content and ideas"}),a.jsx("li",{children:" Generated images are created using AI and may not be copyrightable"}),a.jsx("li",{children:" You grant us license to process and deliver your cards"}),a.jsx("li",{children:" Respect third-party intellectual property rights"})]})]}),a.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("p",{className:"text-center text-gray-500 dark:text-gray-400",children:["By creating a card, you agree to these terms and policies.",a.jsx("br",{}),"Last updated: ",new Date().toLocaleDateString()]})})]})})]}),a.jsx(l.z,{onClick:eL,disabled:w||D||!e.trim()||!ew.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 h-12",size:"lg",children:w||D?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),D?a.jsx("span",{children:" Crafting the perfect message..."}):W>0?(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(en,{className:"w-4 h-4 mr-2"}),(0,a.jsxs)("span",{className:W<=10?"text-yellow-200 animate-pulse":"",children:[" ",`${Math.floor(W/60)}:${(W%60).toString().padStart(2,"0")}`," of magic remaining"]})]}):Y?a.jsx("span",{children:Y}):a.jsx("span",{children:" Crafting magic..."})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(J.Z,{className:"w-5 h-5 mr-2"}),j>1?`Create ${j} Cards`:"Create Card"]})})]})]}),T&&(0,a.jsxs)(u.Zb,{className:"shadow-lg",children:[(0,a.jsxs)(u.Ol,{children:[a.jsx("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[a.jsx(u.ll,{children:j>1?`Your Cards (${A.length} Generated)`:"Your Card"}),(0,a.jsxs)(u.SZ,{children:["Created ",T.createdAt.toLocaleDateString(),j>1&&`  Viewing Card ${M+1} of ${A.length}`]})]})}),j>1&&A.length>1&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:"Choose Your Favorite Card"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:A.map((e,t)=>(0,a.jsxs)("div",{className:`relative cursor-pointer rounded-lg border-2 p-2 transition-all ${M===t?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"}`,onClick:()=>{R(t),C(e)},children:[a.jsx("div",{className:"aspect-[2/3] relative overflow-hidden rounded",children:e.frontCover?a.jsx("img",{src:e.frontCover,alt:`Card ${t+1} Preview`,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:a.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})})}),(0,a.jsxs)("div",{className:"text-center mt-1",children:[(0,a.jsxs)("span",{className:"text-xs font-medium",children:["Card ",t+1]}),M===t&&a.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Selected"})]})]},e.id))})]})]}),a.jsx(u.aY,{children:a.jsx(az,{card:T,onCardUpdate:e=>{C(e),S(t=>{let i=[...t];return i[M]=e,i})},isFrontBackOnly:eP,onPrint:eO,paperConfig:aJ.find(e=>e.id===e_)||aJ[0],sectionLoadingStates:eN})})]}),!T&&a.jsx(u.Zb,{className:"shadow-lg",children:(0,a.jsxs)(u.aY,{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-full flex items-center justify-center mb-4",children:a.jsx(J.Z,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Ready to Create?"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-sm",children:"Describe your perfect card above and we'll bring it to life with creative magic!"})]})})]})]})}},24414:e=>{"use strict";var t={single_source_shortest_paths:function(e,i,r){var s,n,a,o,l,h,c,d={},u={};u[i]=0;var p=t.PriorityQueue.make();for(p.push(i,0);!p.empty();)for(a in n=(s=p.pop()).value,o=s.cost,l=e[n]||{})l.hasOwnProperty(a)&&(h=o+l[a],c=u[a],(void 0===u[a]||c>h)&&(u[a]=h,p.push(a,h),d[a]=n));if(void 0!==r&&void 0===u[r])throw Error(["Could not find a path from ",i," to ",r,"."].join(""));return d},extract_shortest_path_from_predecessor_list:function(e,t){for(var i=[],r=t;r;)i.push(r),e[r],r=e[r];return i.reverse(),i},find_path:function(e,i,r){var s=t.single_source_shortest_paths(e,i,r);return t.extract_shortest_path_from_predecessor_list(s,r)},PriorityQueue:{make:function(e){var i,r=t.PriorityQueue,s={};for(i in e=e||{},r)r.hasOwnProperty(i)&&(s[i]=r[i]);return s.queue=[],s.sorter=e.sorter||r.default_sorter,s},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},1349:(e,t,i)=>{"use strict";let r=i(41289),s=[function(){},function(e,t,i,r){if(r===t.length)throw Error("Ran out of data");let s=t[r];e[i]=s,e[i+1]=s,e[i+2]=s,e[i+3]=255},function(e,t,i,r){if(r+1>=t.length)throw Error("Ran out of data");let s=t[r];e[i]=s,e[i+1]=s,e[i+2]=s,e[i+3]=t[r+1]},function(e,t,i,r){if(r+2>=t.length)throw Error("Ran out of data");e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=255},function(e,t,i,r){if(r+3>=t.length)throw Error("Ran out of data");e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=t[r+3]}],n=[function(){},function(e,t,i,r){let s=t[0];e[i]=s,e[i+1]=s,e[i+2]=s,e[i+3]=r},function(e,t,i){let r=t[0];e[i]=r,e[i+1]=r,e[i+2]=r,e[i+3]=t[1]},function(e,t,i,r){e[i]=t[0],e[i+1]=t[1],e[i+2]=t[2],e[i+3]=r},function(e,t,i){e[i]=t[0],e[i+1]=t[1],e[i+2]=t[2],e[i+3]=t[3]}];t.dataToBitMap=function(e,t){let i,a,o,l,h=t.width,c=t.height,d=t.depth,u=t.bpp,p=t.interlace;if(8!==d){let t,r;t=[],r=0,i={get:function(i){for(;t.length<i;)!function(){let i,s,n,a,o,l,h,c;if(r===e.length)throw Error("Ran out of data");let u=e[r];switch(r++,d){default:throw Error("unrecognised depth");case 16:h=e[r],r++,t.push((u<<8)+h);break;case 4:h=15&u,c=u>>4,t.push(c,h);break;case 2:o=3&u,l=u>>2&3,h=u>>4&3,c=u>>6&3,t.push(c,h,l,o);break;case 1:i=1&u,s=u>>1&1,n=u>>2&1,a=u>>3&1,o=u>>4&1,l=u>>5&1,h=u>>6&1,c=u>>7&1,t.push(c,h,l,o,a,n,s,i)}}();let s=t.slice(0,i);return t=t.slice(i),s},resetAfterLine:function(){t.length=0},end:function(){if(r!==e.length)throw Error("extra data found")}}}a=d<=8?Buffer.alloc(h*c*4):new Uint16Array(h*c*4);let m=Math.pow(2,d)-1,f=0;if(p)o=r.getImagePasses(h,c),l=r.getInterlaceIterator(h,c);else{let e=0;l=function(){let t=e;return e+=4,t},o=[{width:h,height:c}]}for(let t=0;t<o.length;t++)8===d?f=function(e,t,i,r,n,a){let o=e.width,l=e.height,h=e.index;for(let e=0;e<l;e++)for(let l=0;l<o;l++){let o=i(l,e,h);s[r](t,n,o,a),a+=r}return a}(o[t],a,l,u,e,f):function(e,t,i,r,s,a){let o=e.width,l=e.height,h=e.index;for(let e=0;e<l;e++){for(let l=0;l<o;l++){let o=s.get(r),c=i(l,e,h);n[r](t,o,c,a)}s.resetAfterLine()}}(o[t],a,l,u,i,m);if(8===d){if(f!==e.length)throw Error("extra data found")}else i.end();return a}},23333:(e,t,i)=>{"use strict";let r=i(2949);e.exports=function(e,t,i,s){let n=-1!==[r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(s.colorType);if(s.colorType===s.inputColorType){let t;let i=(new DataView(t=new ArrayBuffer(2)).setInt16(0,256,!0),256!==new Int16Array(t)[0]);if(8===s.bitDepth||16===s.bitDepth&&i)return e}let a=16!==s.bitDepth?e:new Uint16Array(e.buffer),o=255,l=r.COLORTYPE_TO_BPP_MAP[s.inputColorType];4!==l||s.inputHasAlpha||(l=3);let h=r.COLORTYPE_TO_BPP_MAP[s.colorType];16===s.bitDepth&&(o=65535,h*=2);let c=Buffer.alloc(t*i*h),d=0,u=0,p=s.bgColor||{};void 0===p.red&&(p.red=o),void 0===p.green&&(p.green=o),void 0===p.blue&&(p.blue=o);for(let e=0;e<i;e++)for(let e=0;e<t;e++){let e=function(){let e,t,i;let l=o;switch(s.inputColorType){case r.COLORTYPE_COLOR_ALPHA:l=a[d+3],e=a[d],t=a[d+1],i=a[d+2];break;case r.COLORTYPE_COLOR:e=a[d],t=a[d+1],i=a[d+2];break;case r.COLORTYPE_ALPHA:l=a[d+1],t=e=a[d],i=e;break;case r.COLORTYPE_GRAYSCALE:t=e=a[d],i=e;break;default:throw Error("input color type:"+s.inputColorType+" is not supported at present")}return s.inputHasAlpha&&!n&&(l/=o,e=Math.min(Math.max(Math.round((1-l)*p.red+l*e),0),o),t=Math.min(Math.max(Math.round((1-l)*p.green+l*t),0),o),i=Math.min(Math.max(Math.round((1-l)*p.blue+l*i),0),o)),{red:e,green:t,blue:i,alpha:l}}(a,d);switch(s.colorType){case r.COLORTYPE_COLOR_ALPHA:case r.COLORTYPE_COLOR:8===s.bitDepth?(c[u]=e.red,c[u+1]=e.green,c[u+2]=e.blue,n&&(c[u+3]=e.alpha)):(c.writeUInt16BE(e.red,u),c.writeUInt16BE(e.green,u+2),c.writeUInt16BE(e.blue,u+4),n&&c.writeUInt16BE(e.alpha,u+6));break;case r.COLORTYPE_ALPHA:case r.COLORTYPE_GRAYSCALE:{let t=(e.red+e.green+e.blue)/3;8===s.bitDepth?(c[u]=t,n&&(c[u+1]=e.alpha)):(c.writeUInt16BE(t,u),n&&c.writeUInt16BE(e.alpha,u+2));break}default:throw Error("unrecognised color Type "+s.colorType)}d+=l,u+=h}return c}},32506:(e,t,i)=>{"use strict";let r=i(21764),s=i(76162),n=e.exports=function(){s.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(n,s),n.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t}),process.nextTick((function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},n.prototype.write=function(e,t){let i;return this.writable?(Buffer.isBuffer(e)?i=e:i=Buffer.from(e,t||this._encoding),this._buffers.push(i),this._buffered+=i.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",Error("Stream not writable")),!1)},n.prototype.end=function(e,t){e&&this.write(e,t),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},n.prototype.destroySoon=n.prototype.end,n.prototype._end=function(){this._reads.length>0&&this.emit("error",Error("Unexpected end of input")),this.destroy()},n.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},n.prototype._processReadAllowingLess=function(e){this._reads.shift();let t=this._buffers[0];t.length>e.length?(this._buffered-=e.length,this._buffers[0]=t.slice(e.length),e.func.call(this,t.slice(0,e.length))):(this._buffered-=t.length,this._buffers.shift(),e.func.call(this,t))},n.prototype._processRead=function(e){this._reads.shift();let t=0,i=0,r=Buffer.alloc(e.length);for(;t<e.length;){let s=this._buffers[i++],n=Math.min(s.length,e.length-t);s.copy(r,t,0,n),t+=n,n!==s.length&&(this._buffers[--i]=s.slice(n))}i>0&&this._buffers.splice(0,i),this._buffered-=e.length,e.func.call(this,r)},n.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let e=this._reads[0];if(e.allowLess)this._processReadAllowingLess(e);else if(this._buffered>=e.length)this._processRead(e);else break}this._buffers&&!this.writable&&this._end()}catch(e){this.emit("error",e)}}},2949:e=>{"use strict";e.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},44747:e=>{"use strict";let t=[];!function(){for(let e=0;e<256;e++){let i=e;for(let e=0;e<8;e++)1&i?i=3988292384^i>>>1:i>>>=1;t[e]=i}}();let i=e.exports=function(){this._crc=-1};i.prototype.write=function(e){for(let i=0;i<e.length;i++)this._crc=t[(this._crc^e[i])&255]^this._crc>>>8;return!0},i.prototype.crc32=function(){return -1^this._crc},i.crc32=function(e){let i=-1;for(let r=0;r<e.length;r++)i=t[(i^e[r])&255]^i>>>8;return -1^i}},84734:(e,t,i)=>{"use strict";let r=i(21008),s={0:function(e,t,i,r,s){for(let n=0;n<i;n++)r[s+n]=e[t+n]},1:function(e,t,i,r,s,n){for(let a=0;a<i;a++){let i=a>=n?e[t+a-n]:0,o=e[t+a]-i;r[s+a]=o}},2:function(e,t,i,r,s){for(let n=0;n<i;n++){let a=t>0?e[t+n-i]:0,o=e[t+n]-a;r[s+n]=o}},3:function(e,t,i,r,s,n){for(let a=0;a<i;a++){let o=a>=n?e[t+a-n]:0,l=t>0?e[t+a-i]:0,h=e[t+a]-(o+l>>1);r[s+a]=h}},4:function(e,t,i,s,n,a){for(let o=0;o<i;o++){let l=o>=a?e[t+o-a]:0,h=t>0?e[t+o-i]:0,c=t>0&&o>=a?e[t+o-(i+a)]:0,d=e[t+o]-r(l,h,c);s[n+o]=d}}},n={0:function(e,t,i){let r=0,s=t+i;for(let i=t;i<s;i++)r+=Math.abs(e[i]);return r},1:function(e,t,i,r){let s=0;for(let n=0;n<i;n++){let i=n>=r?e[t+n-r]:0;s+=Math.abs(e[t+n]-i)}return s},2:function(e,t,i){let r=0,s=t+i;for(let n=t;n<s;n++){let s=t>0?e[n-i]:0;r+=Math.abs(e[n]-s)}return r},3:function(e,t,i,r){let s=0;for(let n=0;n<i;n++){let a=n>=r?e[t+n-r]:0,o=t>0?e[t+n-i]:0;s+=Math.abs(e[t+n]-(a+o>>1))}return s},4:function(e,t,i,s){let n=0;for(let a=0;a<i;a++){let o=a>=s?e[t+a-s]:0,l=t>0?e[t+a-i]:0,h=t>0&&a>=s?e[t+a-(i+s)]:0;n+=Math.abs(e[t+a]-r(o,l,h))}return n}};e.exports=function(e,t,i,r,a){let o;if("filterType"in r&&-1!==r.filterType){if("number"==typeof r.filterType)o=[r.filterType];else throw Error("unrecognised filter types")}else o=[0,1,2,3,4];16===r.bitDepth&&(a*=2);let l=t*a,h=0,c=0,d=Buffer.alloc((l+1)*i),u=o[0];for(let t=0;t<i;t++){if(o.length>1){let t=1/0;for(let i=0;i<o.length;i++){let r=n[o[i]](e,c,l,a);r<t&&(u=o[i],t=r)}}d[h]=u,h++,s[u](e,c,l,d,h,a),h+=l,c+=l}return d}},69376:(e,t,i)=>{"use strict";let r=i(21764),s=i(32506),n=i(61569),a=e.exports=function(e){s.call(this);let t=[],i=this;this._filter=new n(e,{read:this.read.bind(this),write:function(e){t.push(e)},complete:function(){i.emit("complete",Buffer.concat(t))}}),this._filter.start()};r.inherits(a,s)},45309:(e,t,i)=>{"use strict";let r=i(83381),s=i(61569);t.process=function(e,t){let i=[],n=new r(e);return new s(t,{read:n.read.bind(n),write:function(e){i.push(e)},complete:function(){}}).start(),n.process(),Buffer.concat(i)}},61569:(e,t,i)=>{"use strict";let r=i(41289),s=i(21008);function n(e,t,i){let r=e*t;return 8!==i&&(r=Math.ceil(r/(8/i))),r}let a=e.exports=function(e,t){let i=e.width,s=e.height,a=e.interlace,o=e.bpp,l=e.depth;if(this.read=t.read,this.write=t.write,this.complete=t.complete,this._imageIndex=0,this._images=[],a){let e=r.getImagePasses(i,s);for(let t=0;t<e.length;t++)this._images.push({byteWidth:n(e[t].width,o,l),height:e[t].height,lineIndex:0})}else this._images.push({byteWidth:n(i,o,l),height:s,lineIndex:0});8===l?this._xComparison=o:16===l?this._xComparison=2*o:this._xComparison=1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(e,t,i){let r=this._xComparison,s=r-1;for(let n=0;n<i;n++){let i=e[1+n],a=n>s?t[n-r]:0;t[n]=i+a}},a.prototype._unFilterType2=function(e,t,i){let r=this._lastLine;for(let s=0;s<i;s++){let i=e[1+s],n=r?r[s]:0;t[s]=i+n}},a.prototype._unFilterType3=function(e,t,i){let r=this._xComparison,s=r-1,n=this._lastLine;for(let a=0;a<i;a++){let i=e[1+a],o=n?n[a]:0,l=Math.floor(((a>s?t[a-r]:0)+o)/2);t[a]=i+l}},a.prototype._unFilterType4=function(e,t,i){let r=this._xComparison,n=r-1,a=this._lastLine;for(let o=0;o<i;o++){let i=e[1+o],l=a?a[o]:0,h=s(o>n?t[o-r]:0,l,o>n&&a?a[o-r]:0);t[o]=i+h}},a.prototype._reverseFilterLine=function(e){let t,i=e[0],r=this._images[this._imageIndex],s=r.byteWidth;if(0===i)t=e.slice(1,s+1);else switch(t=Buffer.alloc(s),i){case 1:this._unFilterType1(e,t,s);break;case 2:this._unFilterType2(e,t,s);break;case 3:this._unFilterType3(e,t,s);break;case 4:this._unFilterType4(e,t,s);break;default:throw Error("Unrecognised filter type - "+i)}this.write(t),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=t,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}},99794:e=>{"use strict";e.exports=function(e,t){let i=t.depth,r=t.width,s=t.height,n=t.colorType,a=t.transColor,o=t.palette,l=e;return 3===n?function(e,t,i,r,s){let n=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=s[e[n]];if(!i)throw Error("index "+e[n]+" not in palette");for(let e=0;e<4;e++)t[n+e]=i[e];n+=4}}(e,l,r,s,o):(a&&function(e,t,i,r,s){let n=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=!1;if(1===s.length?s[0]===e[n]&&(i=!0):s[0]===e[n]&&s[1]===e[n+1]&&s[2]===e[n+2]&&(i=!0),i)for(let e=0;e<4;e++)t[n+e]=0;n+=4}}(e,l,r,s,a),8!==i&&(16===i&&(l=Buffer.alloc(r*s*4)),function(e,t,i,r,s){let n=Math.pow(2,s)-1,a=0;for(let s=0;s<r;s++)for(let r=0;r<i;r++){for(let i=0;i<4;i++)t[a+i]=Math.floor(255*e[a+i]/n+.5);a+=4}}(e,l,r,s,i))),l}},41289:(e,t)=>{"use strict";let i=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];t.getImagePasses=function(e,t){let r=[],s=e%8,n=t%8,a=(e-s)/8,o=(t-n)/8;for(let e=0;e<i.length;e++){let t=i[e],l=a*t.x.length,h=o*t.y.length;for(let e=0;e<t.x.length;e++)if(t.x[e]<s)l++;else break;for(let e=0;e<t.y.length;e++)if(t.y[e]<n)h++;else break;l>0&&h>0&&r.push({width:l,height:h,index:e})}return r},t.getInterlaceIterator=function(e){return function(t,r,s){let n=t%i[s].x.length,a=(t-n)/i[s].x.length*8+i[s].x[n],o=r%i[s].y.length;return 4*a+((r-o)/i[s].y.length*8+i[s].y[o])*e*4}}},72243:(e,t,i)=>{"use strict";let r=i(21764),s=i(76162),n=i(2949),a=i(71274),o=e.exports=function(e){s.call(this),this._packer=new a(e||{}),this._deflate=this._packer.createDeflate(),this.readable=!0};r.inherits(o,s),o.prototype.pack=function(e,t,i,r){this.emit("data",Buffer.from(n.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(t,i)),r&&this.emit("data",this._packer.packGAMA(r));let s=this._packer.filterData(e,t,i);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(e){this.emit("data",this._packer.packIDAT(e))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(s)}},80100:(e,t,i)=>{"use strict";let r=!0,s=i(71568);s.deflateSync||(r=!1);let n=i(2949),a=i(71274);e.exports=function(e,t){if(!r)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let i=new a(t||{}),o=[];o.push(Buffer.from(n.PNG_SIGNATURE)),o.push(i.packIHDR(e.width,e.height)),e.gamma&&o.push(i.packGAMA(e.gamma));let l=i.filterData(e.data,e.width,e.height),h=s.deflateSync(l,i.getDeflateOptions());if(l=null,!h||!h.length)throw Error("bad png - invalid compressed data response");return o.push(i.packIDAT(h)),o.push(i.packIEND()),Buffer.concat(o)}},71274:(e,t,i)=>{"use strict";let r=i(2949),s=i(44747),n=i(23333),a=i(84734),o=i(71568),l=e.exports=function(e){if(this._options=e,e.deflateChunkSize=e.deflateChunkSize||32768,e.deflateLevel=null!=e.deflateLevel?e.deflateLevel:9,e.deflateStrategy=null!=e.deflateStrategy?e.deflateStrategy:3,e.inputHasAlpha=null==e.inputHasAlpha||e.inputHasAlpha,e.deflateFactory=e.deflateFactory||o.createDeflate,e.bitDepth=e.bitDepth||8,e.colorType="number"==typeof e.colorType?e.colorType:r.COLORTYPE_COLOR_ALPHA,e.inputColorType="number"==typeof e.inputColorType?e.inputColorType:r.COLORTYPE_COLOR_ALPHA,-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(e.colorType))throw Error("option color type:"+e.colorType+" is not supported at present");if(-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(e.inputColorType))throw Error("option input color type:"+e.inputColorType+" is not supported at present");if(8!==e.bitDepth&&16!==e.bitDepth)throw Error("option bit depth:"+e.bitDepth+" is not supported at present")};l.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},l.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},l.prototype.filterData=function(e,t,i){let s=n(e,t,i,this._options),o=r.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(s,t,i,this._options,o)},l.prototype._packChunk=function(e,t){let i=t?t.length:0,r=Buffer.alloc(i+12);return r.writeUInt32BE(i,0),r.writeUInt32BE(e,4),t&&t.copy(r,8),r.writeInt32BE(s.crc32(r.slice(4,r.length-4)),r.length-4),r},l.prototype.packGAMA=function(e){let t=Buffer.alloc(4);return t.writeUInt32BE(Math.floor(e*r.GAMMA_DIVISION),0),this._packChunk(r.TYPE_gAMA,t)},l.prototype.packIHDR=function(e,t){let i=Buffer.alloc(13);return i.writeUInt32BE(e,0),i.writeUInt32BE(t,4),i[8]=this._options.bitDepth,i[9]=this._options.colorType,i[10]=0,i[11]=0,i[12]=0,this._packChunk(r.TYPE_IHDR,i)},l.prototype.packIDAT=function(e){return this._packChunk(r.TYPE_IDAT,e)},l.prototype.packIEND=function(){return this._packChunk(r.TYPE_IEND,null)}},21008:e=>{"use strict";e.exports=function(e,t,i){let r=e+t-i,s=Math.abs(r-e),n=Math.abs(r-t),a=Math.abs(r-i);return s<=n&&s<=a?e:n<=a?t:i}},2336:(e,t,i)=>{"use strict";let r=i(21764),s=i(71568),n=i(32506),a=i(69376),o=i(801),l=i(1349),h=i(99794),c=e.exports=function(e){n.call(this),this._parser=new o(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};r.inherits(c,n),c.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},c.prototype._inflateData=function(e){if(!this._inflate){if(this._bitmapInfo.interlace)this._inflate=s.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let e=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,t=Math.max(e,s.Z_MIN_CHUNK);this._inflate=s.createInflate({chunkSize:t});let i=e,r=this.emit.bind(this,"error");this._inflate.on("error",function(e){i&&r(e)}),this._filter.on("complete",this._complete.bind(this));let n=this._filter.write.bind(this._filter);this._inflate.on("data",function(e){i&&(e.length>i&&(e=e.slice(0,i)),i-=e.length,n(e))}),this._inflate.on("end",this._filter.end.bind(this._filter))}}this._inflate.write(e)},c.prototype._handleMetaData=function(e){this._metaData=e,this._bitmapInfo=Object.create(e),this._filter=new a(this._bitmapInfo)},c.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},c.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},c.prototype._simpleTransparency=function(){this._metaData.alpha=!0},c.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},c.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},c.prototype._complete=function(e){let t;if(!this.errord){try{let i=l.dataToBitMap(e,this._bitmapInfo);t=h(i,this._bitmapInfo),i=null}catch(e){this._handleError(e);return}this.emit("parsed",t)}}},50369:(e,t,i)=>{"use strict";let r=!0,s=i(71568),n=i(31102);s.deflateSync||(r=!1);let a=i(83381),o=i(45309),l=i(801),h=i(1349),c=i(99794);e.exports=function(e,t){let i,d,u,p;if(!r)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let m=[],f=new a(e);if(new l(t,{read:f.read.bind(f),error:function(e){i=e},metadata:function(e){d=e},gamma:function(e){u=e},palette:function(e){d.palette=e},transColor:function(e){d.transColor=e},inflateData:function(e){m.push(e)},simpleTransparency:function(){d.alpha=!0}}).start(),f.process(),i)throw i;let g=Buffer.concat(m);if(m.length=0,d.interlace)p=s.inflateSync(g);else{let e=((d.width*d.bpp*d.depth+7>>3)+1)*d.height;p=n(g,{chunkSize:e,maxLength:e})}if(g=null,!p||!p.length)throw Error("bad png - invalid inflate data response");let y=o.process(p,d);g=null;let v=h.dataToBitMap(y,d);y=null;let x=c(v,d);return d.data=x,d.gamma=u||0,d}},801:(e,t,i)=>{"use strict";let r=i(2949),s=i(44747),n=e.exports=function(e,t){this._options=e,e.checkCRC=!1!==e.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[r.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[r.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[r.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[r.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[r.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[r.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.finished=t.finished,this.simpleTransparency=t.simpleTransparency,this.headersFinished=t.headersFinished||function(){}};n.prototype.start=function(){this.read(r.PNG_SIGNATURE.length,this._parseSignature.bind(this))},n.prototype._parseSignature=function(e){let t=r.PNG_SIGNATURE;for(let i=0;i<t.length;i++)if(e[i]!==t[i]){this.error(Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))},n.prototype._parseChunkBegin=function(e){let t=e.readUInt32BE(0),i=e.readUInt32BE(4),n="";for(let t=4;t<8;t++)n+=String.fromCharCode(e[t]);let a=!!(32&e[4]);if(!this._hasIHDR&&i!==r.TYPE_IHDR){this.error(Error("Expected IHDR on beggining"));return}if(this._crc=new s,this._crc.write(Buffer.from(n)),this._chunks[i])return this._chunks[i](t);if(!a){this.error(Error("Unsupported critical chunk type "+n));return}this.read(t+4,this._skipChunk.bind(this))},n.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},n.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},n.prototype._parseChunkEnd=function(e){let t=e.readInt32BE(0),i=this._crc.crc32();if(this._options.checkCRC&&i!==t){this.error(Error("Crc error - "+t+" - "+i));return}this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},n.prototype._handleIHDR=function(e){this.read(e,this._parseIHDR.bind(this))},n.prototype._parseIHDR=function(e){this._crc.write(e);let t=e.readUInt32BE(0),i=e.readUInt32BE(4),s=e[8],n=e[9],a=e[10],o=e[11],l=e[12];if(8!==s&&4!==s&&2!==s&&1!==s&&16!==s){this.error(Error("Unsupported bit depth "+s));return}if(!(n in r.COLORTYPE_TO_BPP_MAP)){this.error(Error("Unsupported color type"));return}if(0!==a){this.error(Error("Unsupported compression method"));return}if(0!==o){this.error(Error("Unsupported filter method"));return}if(0!==l&&1!==l){this.error(Error("Unsupported interlace method"));return}this._colorType=n;let h=r.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:i,depth:s,interlace:!!l,palette:!!(n&r.COLORTYPE_PALETTE),color:!!(n&r.COLORTYPE_COLOR),alpha:!!(n&r.COLORTYPE_ALPHA),bpp:h,colorType:n}),this._handleChunkEnd()},n.prototype._handlePLTE=function(e){this.read(e,this._parsePLTE.bind(this))},n.prototype._parsePLTE=function(e){this._crc.write(e);let t=Math.floor(e.length/3);for(let i=0;i<t;i++)this._palette.push([e[3*i],e[3*i+1],e[3*i+2],255]);this.palette(this._palette),this._handleChunkEnd()},n.prototype._handleTRNS=function(e){this.simpleTransparency(),this.read(e,this._parseTRNS.bind(this))},n.prototype._parseTRNS=function(e){if(this._crc.write(e),this._colorType===r.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length){this.error(Error("Transparency chunk must be after palette"));return}if(e.length>this._palette.length){this.error(Error("More transparent colors than palette size"));return}for(let t=0;t<e.length;t++)this._palette[t][3]=e[t];this.palette(this._palette)}this._colorType===r.COLORTYPE_GRAYSCALE&&this.transColor([e.readUInt16BE(0)]),this._colorType===r.COLORTYPE_COLOR&&this.transColor([e.readUInt16BE(0),e.readUInt16BE(2),e.readUInt16BE(4)]),this._handleChunkEnd()},n.prototype._handleGAMA=function(e){this.read(e,this._parseGAMA.bind(this))},n.prototype._parseGAMA=function(e){this._crc.write(e),this.gamma(e.readUInt32BE(0)/r.GAMMA_DIVISION),this._handleChunkEnd()},n.prototype._handleIDAT=function(e){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-e,this._parseIDAT.bind(this,e))},n.prototype._parseIDAT=function(e,t){if(this._crc.write(t),this._colorType===r.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw Error("Expected palette not found");this.inflateData(t);let i=e-t.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},n.prototype._handleIEND=function(e){this.read(e,this._parseIEND.bind(this))},n.prototype._parseIEND=function(e){this._crc.write(e),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}},20438:(e,t,i)=>{"use strict";let r=i(50369),s=i(80100);t.read=function(e,t){return r(e,t||{})},t.write=function(e,t){return s(e,t)}},81687:(e,t,i)=>{"use strict";let r=i(21764),s=i(76162),n=i(2336),a=i(72243),o=i(20438),l=t.y=function(e){s.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new n(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(e){this.data=e,this.emit("parsed",e)}).bind(this)),this._packer=new a(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(l,s),l.sync=o,l.prototype.pack=function(){return this.data&&this.data.length?process.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)):this.emit("error","No data provided"),this},l.prototype.parse=function(e,t){if(t){let e,i;e=(function(e){this.removeListener("error",i),this.data=e,t(null,this)}).bind(this),i=(function(i){this.removeListener("parsed",e),t(i,null)}).bind(this),this.once("parsed",e),this.once("error",i)}return this.end(e),this},l.prototype.write=function(e){return this._parser.write(e),!0},l.prototype.end=function(e){this._parser.end(e)},l.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},l.prototype._gamma=function(e){this.gamma=e},l.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},l.bitblt=function(e,t,i,r,s,n,a,o){if(r|=0,s|=0,n|=0,a|=0,o|=0,(i|=0)>e.width||r>e.height||i+s>e.width||r+n>e.height)throw Error("bitblt reading outside image");if(a>t.width||o>t.height||a+s>t.width||o+n>t.height)throw Error("bitblt writing outside image");for(let l=0;l<n;l++)e.data.copy(t.data,(o+l)*t.width+a<<2,(r+l)*e.width+i<<2,(r+l)*e.width+i+s<<2)},l.prototype.bitblt=function(e,t,i,r,s,n,a){return l.bitblt(this,e,t,i,r,s,n,a),this},l.adjustGamma=function(e){if(e.gamma){for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++){let r=e.width*t+i<<2;for(let t=0;t<3;t++){let i=e.data[r+t]/255;i=Math.pow(i,1/2.2/e.gamma),e.data[r+t]=Math.round(255*i)}}e.gamma=0}},l.prototype.adjustGamma=function(){l.adjustGamma(this)}},31102:(e,t,i)=>{"use strict";let r=i(27790).ok,s=i(71568),n=i(21764),a=i(78893).kMaxLength;function o(e){if(!(this instanceof o))return new o(e);e&&e.chunkSize<s.Z_MIN_CHUNK&&(e.chunkSize=s.Z_MIN_CHUNK),s.Inflate.call(this,e),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,e&&null!=e.maxLength&&(this._maxLength=e.maxLength)}function l(e,t){t&&process.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function h(e,t){return function(e,t){if("string"==typeof t&&(t=Buffer.from(t)),!(t instanceof Buffer))throw TypeError("Not a string or buffer");let i=e._finishFlushFlag;return null==i&&(i=s.Z_FINISH),e._processChunk(t,i)}(new o(t),e)}o.prototype._processChunk=function(e,t,i){let n,o;if("function"==typeof i)return s.Inflate._processChunk.call(this,e,t,i);let h=this,c=e&&e.length,d=this._chunkSize-this._offset,u=this._maxLength,p=0,m=[],f=0;this.on("error",function(e){n=e}),r(this._handle,"zlib binding closed");do o=(o=this._handle.writeSync(t,e,p,c,this._buffer,this._offset,d))||this._writeState;while(!this._hadError&&function(e,t){if(h._hadError)return;let i=d-t;if(r(i>=0,"have should not go down"),i>0){let e=h._buffer.slice(h._offset,h._offset+i);if(h._offset+=i,e.length>u&&(e=e.slice(0,u)),m.push(e),f+=e.length,0==(u-=e.length))return!1}return(0===t||h._offset>=h._chunkSize)&&(d=h._chunkSize,h._offset=0,h._buffer=Buffer.allocUnsafe(h._chunkSize)),0===t&&(p+=c-e,c=e,!0)}(o[0],o[1]));if(this._hadError)throw n;if(f>=a)throw l(this),RangeError("Cannot create final Buffer. It would be larger than 0x"+a.toString(16)+" bytes");let g=Buffer.concat(m,f);return l(this),g},n.inherits(o,s.Inflate),e.exports=t=h,t.Inflate=o,t.createInflate=function(e){return new o(e)},t.inflateSync=h},83381:e=>{"use strict";let t=e.exports=function(e){this._buffer=e,this._reads=[]};t.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t})},t.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let e=this._reads[0];if(this._buffer.length&&(this._buffer.length>=e.length||e.allowLess)){this._reads.shift();let t=this._buffer;this._buffer=t.slice(e.length),e.func.call(this,t.slice(0,e.length))}else break}return this._reads.length>0?Error("There are some read requests waitng on finished stream"):this._buffer.length>0?Error("unrecognised content at end of stream"):void 0}},59157:(e,t,i)=>{let r=i(91817),s=i(18895),n=i(93162),a=i(975);function o(e,t,i,n,a){let o=[].slice.call(arguments,1),l=o.length,h="function"==typeof o[l-1];if(!h&&!r())throw Error("Callback required as last argument");if(h){if(l<2)throw Error("Too few arguments provided");2===l?(a=i,i=t,t=n=void 0):3===l&&(t.getContext&&void 0===a?(a=n,n=void 0):(a=n,n=i,i=t,t=void 0))}else{if(l<1)throw Error("Too few arguments provided");return 1===l?(i=t,t=n=void 0):2!==l||t.getContext||(n=i,i=t,t=void 0),new Promise(function(r,a){try{let a=s.create(i,n);r(e(a,t,n))}catch(e){a(e)}})}try{let r=s.create(i,n);a(null,e(r,t,n))}catch(e){a(e)}}s.create,t.toCanvas=o.bind(null,n.render),o.bind(null,n.renderToDataURL),o.bind(null,function(e,t,i){return a.render(e,i)})},91817:e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},40731:(e,t,i)=>{let r=i(2540).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,i=r(e),s=145===i?26:2*Math.ceil((i-13)/(2*t-2)),n=[i-7];for(let e=1;e<t-1;e++)n[e]=n[e-1]-s;return n.push(6),n.reverse()},t.getPositions=function(e){let i=[],r=t.getRowColCoords(e),s=r.length;for(let e=0;e<s;e++)for(let t=0;t<s;t++)(0!==e||0!==t)&&(0!==e||t!==s-1)&&(e!==s-1||0!==t)&&i.push([r[e],r[t]]);return i}},52307:(e,t,i)=>{let r=i(97798),s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(e){this.mode=r.ALPHANUMERIC,this.data=e}n.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let i=45*s.indexOf(this.data[t]);i+=s.indexOf(this.data[t+1]),e.put(i,11)}this.data.length%2&&e.put(s.indexOf(this.data[t]),6)},e.exports=n},76730:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){return(this.buffer[Math.floor(e/8)]>>>7-e%8&1)==1},put:function(e,t){for(let i=0;i<t;i++)this.putBit((e>>>t-i-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},94638:e=>{function t(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,i,r){let s=e*this.size+t;this.data[s]=i,r&&(this.reservedBit[s]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,i){this.data[e*this.size+t]^=i},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},20592:(e,t,i)=>{let r=i(97798);function s(e){this.mode=r.BYTE,"string"==typeof e?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}s.getBitsLength=function(e){return 8*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){for(let t=0,i=this.data.length;t<i;t++)e.put(this.data[t],8)},e.exports=s},14134:(e,t,i)=>{let r=i(78431),s=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case r.L:return s[(e-1)*4+0];case r.M:return s[(e-1)*4+1];case r.Q:return s[(e-1)*4+2];case r.H:return s[(e-1)*4+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case r.L:return n[(e-1)*4+0];case r.M:return n[(e-1)*4+1];case r.Q:return n[(e-1)*4+2];case r.H:return n[(e-1)*4+3];default:return}}},78431:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,i){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw Error("Unknown EC Level: "+e)}}(e)}catch(e){return i}}},77422:(e,t,i)=>{let r=i(2540).getSymbolSize;t.getPositions=function(e){let t=r(e);return[[0,0],[t-7,0],[0,t-7]]}},26445:(e,t,i)=>{let r=i(2540),s=r.getBCHDigit(1335);t.getEncodedBits=function(e,t){let i=e.bit<<3|t,n=i<<10;for(;r.getBCHDigit(n)-s>=0;)n^=1335<<r.getBCHDigit(n)-s;return(i<<10|n)^21522}},12959:(e,t)=>{let i=new Uint8Array(512),r=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)i[t]=e,r[e]=t,256&(e<<=1)&&(e^=285);for(let e=255;e<512;e++)i[e]=i[e-255]})(),t.log=function(e){if(e<1)throw Error("log("+e+")");return r[e]},t.exp=function(e){return i[e]},t.mul=function(e,t){return 0===e||0===t?0:i[r[e]+r[t]]}},3616:(e,t,i)=>{let r=i(97798),s=i(2540);function n(e){this.mode=r.KANJI,this.data=e}n.getBitsLength=function(e){return 13*e},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let i=s.toSJIS(this.data[t]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");i=(i>>>8&255)*192+(255&i),e.put(i,13)}},e.exports=n},6754:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};let i={N1:3,N2:3,N3:40,N4:10};t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){let t=e.size,r=0,s=0,n=0,a=null,o=null;for(let l=0;l<t;l++){s=n=0,a=o=null;for(let h=0;h<t;h++){let t=e.get(l,h);t===a?s++:(s>=5&&(r+=i.N1+(s-5)),a=t,s=1),(t=e.get(h,l))===o?n++:(n>=5&&(r+=i.N1+(n-5)),o=t,n=1)}s>=5&&(r+=i.N1+(s-5)),n>=5&&(r+=i.N1+(n-5))}return r},t.getPenaltyN2=function(e){let t=e.size,r=0;for(let i=0;i<t-1;i++)for(let s=0;s<t-1;s++){let t=e.get(i,s)+e.get(i,s+1)+e.get(i+1,s)+e.get(i+1,s+1);(4===t||0===t)&&r++}return r*i.N2},t.getPenaltyN3=function(e){let t=e.size,r=0,s=0,n=0;for(let i=0;i<t;i++){s=n=0;for(let a=0;a<t;a++)s=s<<1&2047|e.get(i,a),a>=10&&(1488===s||93===s)&&r++,n=n<<1&2047|e.get(a,i),a>=10&&(1488===n||93===n)&&r++}return r*i.N3},t.getPenaltyN4=function(e){let t=0,r=e.data.length;for(let i=0;i<r;i++)t+=e.data[i];return Math.abs(Math.ceil(100*t/r/5)-10)*i.N4},t.applyMask=function(e,i){let r=i.size;for(let s=0;s<r;s++)for(let n=0;n<r;n++)i.isReserved(n,s)||i.xor(n,s,function(e,i,r){switch(e){case t.Patterns.PATTERN000:return(i+r)%2==0;case t.Patterns.PATTERN001:return i%2==0;case t.Patterns.PATTERN010:return r%3==0;case t.Patterns.PATTERN011:return(i+r)%3==0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(r/3))%2==0;case t.Patterns.PATTERN101:return i*r%2+i*r%3==0;case t.Patterns.PATTERN110:return(i*r%2+i*r%3)%2==0;case t.Patterns.PATTERN111:return(i*r%3+(i+r)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,n,s))},t.getBestMask=function(e,i){let r=Object.keys(t.Patterns).length,s=0,n=1/0;for(let a=0;a<r;a++){i(a),t.applyMask(a,e);let r=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(a,e),r<n&&(n=r,s=a)}return s}},97798:(e,t,i)=>{let r=i(18517),s=i(70232);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!r.isValid(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return s.testNumeric(e)?t.NUMERIC:s.testAlphanumeric(e)?t.ALPHANUMERIC:s.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,i){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw Error("Unknown mode: "+e)}}(e)}catch(e){return i}}},54790:(e,t,i)=>{let r=i(97798);function s(e){this.mode=r.NUMERIC,this.data=e.toString()}s.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t,i;for(t=0;t+3<=this.data.length;t+=3)i=parseInt(this.data.substr(t,3),10),e.put(i,10);let r=this.data.length-t;r>0&&(i=parseInt(this.data.substr(t),10),e.put(i,3*r+1))},e.exports=s},56686:(e,t,i)=>{let r=i(12959);t.mul=function(e,t){let i=new Uint8Array(e.length+t.length-1);for(let s=0;s<e.length;s++)for(let n=0;n<t.length;n++)i[s+n]^=r.mul(e[s],t[n]);return i},t.mod=function(e,t){let i=new Uint8Array(e);for(;i.length-t.length>=0;){let e=i[0];for(let s=0;s<t.length;s++)i[s]^=r.mul(t[s],e);let s=0;for(;s<i.length&&0===i[s];)s++;i=i.slice(s)}return i},t.generateECPolynomial=function(e){let i=new Uint8Array([1]);for(let s=0;s<e;s++)i=t.mul(i,new Uint8Array([1,r.exp(s)]));return i}},18895:(e,t,i)=>{let r=i(2540),s=i(78431),n=i(76730),a=i(94638),o=i(40731),l=i(77422),h=i(6754),c=i(14134),d=i(19444),u=i(75463),p=i(26445),m=i(97798),f=i(76485);function g(e,t,i){let r,s;let n=e.size,a=p.getEncodedBits(t,i);for(r=0;r<15;r++)s=(a>>r&1)==1,r<6?e.set(r,8,s,!0):r<8?e.set(r+1,8,s,!0):e.set(n-15+r,8,s,!0),r<8?e.set(8,n-r-1,s,!0):r<9?e.set(8,15-r-1+1,s,!0):e.set(8,15-r-1,s,!0);e.set(n-8,8,1,!0)}t.create=function(e,t){let i,p;if(void 0===e||""===e)throw Error("No input text");let y=s.M;return void 0!==t&&(y=s.from(t.errorCorrectionLevel,s.M),i=u.from(t.version),p=h.from(t.maskPattern),t.toSJISFunc&&r.setToSJISFunction(t.toSJISFunc)),function(e,t,i,s){let p;if(Array.isArray(e))p=f.fromArray(e);else if("string"==typeof e){let r=t;if(!r){let t=f.rawSplit(e);r=u.getBestVersionForData(t,i)}p=f.fromString(e,r||40)}else throw Error("Invalid data");let y=u.getBestVersionForData(p,i);if(!y)throw Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<y)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+y+".\n")}else t=y;let v=function(e,t,i){let s=new n;i.forEach(function(t){s.put(t.mode.bit,4),s.put(t.getLength(),m.getCharCountIndicator(t.mode,e)),t.write(s)});let a=(r.getSymbolTotalCodewords(e)-c.getTotalCodewordsCount(e,t))*8;for(s.getLengthInBits()+4<=a&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);let o=(a-s.getLengthInBits())/8;for(let e=0;e<o;e++)s.put(e%2?17:236,8);return function(e,t,i){let s,n;let a=r.getSymbolTotalCodewords(t),o=a-c.getTotalCodewordsCount(t,i),l=c.getBlocksCount(t,i),h=a%l,u=l-h,p=Math.floor(a/l),m=Math.floor(o/l),f=m+1,g=p-m,y=new d(g),v=0,x=Array(l),b=Array(l),w=0,k=new Uint8Array(e.buffer);for(let e=0;e<l;e++){let t=e<u?m:f;x[e]=k.slice(v,v+t),b[e]=y.encode(x[e]),v+=t,w=Math.max(w,t)}let T=new Uint8Array(a),C=0;for(s=0;s<w;s++)for(n=0;n<l;n++)s<x[n].length&&(T[C++]=x[n][s]);for(s=0;s<g;s++)for(n=0;n<l;n++)T[C++]=b[n][s];return T}(s,e,t)}(t,i,p),x=new a(r.getSymbolSize(t));return function(e,t){let i=e.size,r=l.getPositions(t);for(let t=0;t<r.length;t++){let s=r[t][0],n=r[t][1];for(let t=-1;t<=7;t++)if(!(s+t<=-1)&&!(i<=s+t))for(let r=-1;r<=7;r++)n+r<=-1||i<=n+r||(t>=0&&t<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===t||6===t)||t>=2&&t<=4&&r>=2&&r<=4?e.set(s+t,n+r,!0,!0):e.set(s+t,n+r,!1,!0))}}(x,t),function(e){let t=e.size;for(let i=8;i<t-8;i++){let t=i%2==0;e.set(i,6,t,!0),e.set(6,i,t,!0)}}(x),function(e,t){let i=o.getPositions(t);for(let t=0;t<i.length;t++){let r=i[t][0],s=i[t][1];for(let t=-2;t<=2;t++)for(let i=-2;i<=2;i++)-2===t||2===t||-2===i||2===i||0===t&&0===i?e.set(r+t,s+i,!0,!0):e.set(r+t,s+i,!1,!0)}}(x,t),g(x,i,0),t>=7&&function(e,t){let i,r,s;let n=e.size,a=u.getEncodedBits(t);for(let t=0;t<18;t++)i=Math.floor(t/3),r=t%3+n-8-3,s=(a>>t&1)==1,e.set(i,r,s,!0),e.set(r,i,s,!0)}(x,t),function(e,t){let i=e.size,r=-1,s=i-1,n=7,a=0;for(let o=i-1;o>0;o-=2)for(6===o&&o--;;){for(let i=0;i<2;i++)if(!e.isReserved(s,o-i)){let r=!1;a<t.length&&(r=(t[a]>>>n&1)==1),e.set(s,o-i,r),-1==--n&&(a++,n=7)}if((s+=r)<0||i<=s){s-=r,r=-r;break}}}(x,v),isNaN(s)&&(s=h.getBestMask(x,g.bind(null,x,i))),h.applyMask(s,x),g(x,i,s),{modules:x,version:t,errorCorrectionLevel:i,maskPattern:s,segments:p}}(e,i,y,p)}},19444:(e,t,i)=>{let r=i(56686);function s(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}s.prototype.initialize=function(e){this.degree=e,this.genPoly=r.generateECPolynomial(this.degree)},s.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let i=r.mod(t,this.genPoly),s=this.degree-i.length;if(s>0){let e=new Uint8Array(this.degree);return e.set(i,s),e}return i},e.exports=s},70232:(e,t)=>{let i="[0-9]+",r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",s="(?:(?![A-Z0-9 $%*+\\-./:]|"+(r=r.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";t.KANJI=RegExp(r,"g"),t.BYTE_KANJI=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=RegExp(s,"g"),t.NUMERIC=RegExp(i,"g"),t.ALPHANUMERIC=RegExp("[A-Z $%*+\\-./:]+","g");let n=RegExp("^"+r+"$"),a=RegExp("^"+i+"$"),o=RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return n.test(e)},t.testNumeric=function(e){return a.test(e)},t.testAlphanumeric=function(e){return o.test(e)}},76485:(e,t,i)=>{let r=i(97798),s=i(54790),n=i(52307),a=i(20592),o=i(3616),l=i(70232),h=i(2540),c=i(24414);function d(e){return unescape(encodeURIComponent(e)).length}function u(e,t,i){let r;let s=[];for(;null!==(r=e.exec(i));)s.push({data:r[0],index:r.index,mode:t,length:r[0].length});return s}function p(e){let t,i;let s=u(l.NUMERIC,r.NUMERIC,e),n=u(l.ALPHANUMERIC,r.ALPHANUMERIC,e);return h.isKanjiModeEnabled()?(t=u(l.BYTE,r.BYTE,e),i=u(l.KANJI,r.KANJI,e)):(t=u(l.BYTE_KANJI,r.BYTE,e),i=[]),s.concat(n,t,i).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function m(e,t){switch(t){case r.NUMERIC:return s.getBitsLength(e);case r.ALPHANUMERIC:return n.getBitsLength(e);case r.KANJI:return o.getBitsLength(e);case r.BYTE:return a.getBitsLength(e)}}function f(e,t){let i;let l=r.getBestModeForData(e);if((i=r.from(t,l))!==r.BYTE&&i.bit<l.bit)throw Error('"'+e+'" cannot be encoded with mode '+r.toString(i)+".\n Suggested mode is: "+r.toString(l));switch(i!==r.KANJI||h.isKanjiModeEnabled()||(i=r.BYTE),i){case r.NUMERIC:return new s(e);case r.ALPHANUMERIC:return new n(e);case r.KANJI:return new o(e);case r.BYTE:return new a(e)}}t.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(f(t,null)):t.data&&e.push(f(t.data,t.mode)),e},[])},t.fromString=function(e,i){let s=function(e,t){let i={},s={start:{}},n=["start"];for(let a=0;a<e.length;a++){let o=e[a],l=[];for(let e=0;e<o.length;e++){let h=o[e],c=""+a+e;l.push(c),i[c]={node:h,lastCount:0},s[c]={};for(let e=0;e<n.length;e++){let a=n[e];i[a]&&i[a].node.mode===h.mode?(s[a][c]=m(i[a].lastCount+h.length,h.mode)-m(i[a].lastCount,h.mode),i[a].lastCount+=h.length):(i[a]&&(i[a].lastCount=h.length),s[a][c]=m(h.length,h.mode)+4+r.getCharCountIndicator(h.mode,t))}}n=l}for(let e=0;e<n.length;e++)s[n[e]].end=0;return{map:s,table:i}}(function(e){let t=[];for(let i=0;i<e.length;i++){let s=e[i];switch(s.mode){case r.NUMERIC:t.push([s,{data:s.data,mode:r.ALPHANUMERIC,length:s.length},{data:s.data,mode:r.BYTE,length:s.length}]);break;case r.ALPHANUMERIC:t.push([s,{data:s.data,mode:r.BYTE,length:s.length}]);break;case r.KANJI:t.push([s,{data:s.data,mode:r.BYTE,length:d(s.data)}]);break;case r.BYTE:t.push([{data:s.data,mode:r.BYTE,length:d(s.data)}])}}return t}(p(e,h.isKanjiModeEnabled())),i),n=c.find_path(s.map,"start","end"),a=[];for(let e=1;e<n.length-1;e++)a.push(s.table[n[e]].node);return t.fromArray(a.reduce(function(e,t){let i=e.length-1>=0?e[e.length-1]:null;return i&&i.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},t.rawSplit=function(e){return t.fromArray(p(e,h.isKanjiModeEnabled()))}},2540:(e,t)=>{let i;let r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return r[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw Error('"toSJISFunc" is not a valid function.');i=e},t.isKanjiModeEnabled=function(){return void 0!==i},t.toSJIS=function(e){return i(e)}},18517:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},75463:(e,t,i)=>{let r=i(2540),s=i(14134),n=i(78431),a=i(97798),o=i(18517),l=r.getBCHDigit(7973);function h(e,t){return a.getCharCountIndicator(e,t)+4}t.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,i){if(!o.isValid(e))throw Error("Invalid QR Code version");void 0===i&&(i=a.BYTE);let n=(r.getSymbolTotalCodewords(e)-s.getTotalCodewordsCount(e,t))*8;if(i===a.MIXED)return n;let l=n-h(i,e);switch(i){case a.NUMERIC:return Math.floor(l/10*3);case a.ALPHANUMERIC:return Math.floor(l/11*2);case a.KANJI:return Math.floor(l/13);case a.BYTE:default:return Math.floor(l/8)}},t.getBestVersionForData=function(e,i){let r;let s=n.from(i,n.M);if(Array.isArray(e)){if(e.length>1)return function(e,i){for(let r=1;r<=40;r++)if(function(e,t){let i=0;return e.forEach(function(e){let r=h(e.mode,t);i+=r+e.getBitsLength()}),i}(e,r)<=t.getCapacity(r,i,a.MIXED))return r}(e,s);if(0===e.length)return 1;r=e[0]}else r=e;return function(e,i,r){for(let s=1;s<=40;s++)if(i<=t.getCapacity(s,r,e))return s}(r.mode,r.getLength(),s)},t.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;r.getBCHDigit(t)-l>=0;)t^=7973<<r.getBCHDigit(t)-l;return e<<12|t}},31270:(e,t,i)=>{"use strict";e.exports=i(5570)},93162:(e,t,i)=>{let r=i(20802);t.render=function(e,t,i){var s;let n=i,a=t;void 0!==n||t&&t.getContext||(n=t,t=void 0),t||(a=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),n=r.getOptions(n);let o=r.getImageWidth(e.modules.size,n),l=a.getContext("2d"),h=l.createImageData(o,o);return r.qrToImageData(h.data,e,n),s=a,l.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px",l.putImageData(h,0,0),a},t.renderToDataURL=function(e,i,r){let s=r;void 0!==s||i&&i.getContext||(s=i,i=void 0),s||(s={});let n=t.render(e,i,s),a=s.type||"image/png",o=s.rendererOpts||{};return n.toDataURL(a,o.quality)}},8276:(e,t,i)=>{let r=i(92048),s=i(81687).y,n=i(20802);t.render=function(e,t){let i=n.getOptions(t),r=i.rendererOpts,a=n.getImageWidth(e.modules.size,i);r.width=a,r.height=a;let o=new s(r);return n.qrToImageData(o.data,e,i),o},t.renderToDataURL=function(e,i,r){void 0===r&&(r=i,i=void 0),t.renderToBuffer(e,i,function(e,t){e&&r(e);let i="data:image/png;base64,";i+=t.toString("base64"),r(null,i)})},t.renderToBuffer=function(e,i,r){void 0===r&&(r=i,i=void 0);let s=t.render(e,i),n=[];s.on("error",r),s.on("data",function(e){n.push(e)}),s.on("end",function(){r(null,Buffer.concat(n))}),s.pack()},t.renderToFile=function(e,i,s,n){void 0===n&&(n=s,s=void 0);let a=!1,o=(...e)=>{a||(a=!0,n.apply(null,e))},l=r.createWriteStream(e);l.on("error",o),l.on("close",o),t.renderToFileStream(l,i,s)},t.renderToFileStream=function(e,i,r){t.render(i,r).pack().pipe(e)}},975:(e,t,i)=>{let r=i(20802);function s(e,t){let i=e.a/255,r=t+'="'+e.hex+'"';return i<1?r+" "+t+'-opacity="'+i.toFixed(2).slice(1)+'"':r}function n(e,t,i){let r=e+t;return void 0!==i&&(r+=" "+i),r}t.render=function(e,t,i){let a=r.getOptions(t),o=e.modules.size,l=e.modules.data,h=o+2*a.margin,c=a.color.light.a?"<path "+s(a.color.light,"fill")+' d="M0 0h'+h+"v"+h+'H0z"/>':"",d="<path "+s(a.color.dark,"stroke")+' d="'+function(e,t,i){let r="",s=0,a=!1,o=0;for(let l=0;l<e.length;l++){let h=Math.floor(l%t),c=Math.floor(l/t);h||a||(a=!0),e[l]?(o++,l>0&&h>0&&e[l-1]||(r+=a?n("M",h+i,.5+c+i):n("m",s,0),s=0,a=!1),h+1<t&&e[l+1]||(r+=n("h",o),o=0)):s++}return r}(l,o,a.margin)+'"/>',u='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+('viewBox="0 0 '+h)+" "+h+'" shape-rendering="crispEdges">'+c+d+"</svg>\n";return"function"==typeof i&&i(null,u),u}},47979:(e,t,i)=>{let r=i(975);t.render=r.render,t.renderToFile=function(e,r,s,n){void 0===n&&(n=s,s=void 0);let a=i(92048),o=t.render(r,s);a.writeFile(e,'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+o,n)}},73678:(e,t,i)=>{let r=i(28821),s=i(53853);t.render=function(e,t,i){return t&&t.small?s.render(e,t,i):r.render(e,t,i)}},53853:(e,t)=>{let i="\x1b[37m",r="\x1b[30m",s="\x1b[0m",n="\x1b[47m"+r,a="\x1b[40m"+i,o=function(e,t,i,r){let s=t+1;return i>=s||r>=s||r<-1||i<-1?"0":i>=t||r>=t||r<0||i<0?"1":e[r*t+i]?"2":"1"},l=function(e,t,i,r){return o(e,t,i,r)+o(e,t,i,r+1)};t.render=function(e,t,o){var h,c;let d=e.modules.size,u=e.modules.data,p=!!(t&&t.inverse),m=t&&t.inverse?a:n,f={"00":s+" "+m,"01":s+(h=p?r:i)+""+m,"02":s+(c=p?i:r)+""+m,10:s+h+""+m,11:" ",12:"",20:s+c+""+m,21:"",22:""},g=s+"\n"+m,y=m;for(let e=-1;e<d+1;e+=2){for(let t=-1;t<d;t++)y+=f[l(u,d,t,e)];y+=f[l(u,d,d,e)]+g}return y+=s,"function"==typeof o&&o(null,y),y}},28821:(e,t)=>{t.render=function(e,t,i){let r=e.modules.size,s=e.modules.data,n="\x1b[47m  \x1b[0m",a="",o=Array(r+3).join(n),l=[,,].join(n);a+=o+"\n";for(let e=0;e<r;++e){a+=n;for(let t=0;t<r;t++)a+=s[e*r+t]?"\x1b[40m  \x1b[0m":n;a+=l+"\n"}return a+=o+"\n","function"==typeof i&&i(null,a),a}},86318:(e,t,i)=>{let r=i(20802),s={WW:" ",WB:"",BB:"",BW:""},n={BB:" ",BW:"",WW:"",WB:""};t.render=function(e,t,i){let a=r.getOptions(t),o=s;("#ffffff"===a.color.dark.hex||"#000000"===a.color.light.hex)&&(o=n);let l=e.modules.size,h=e.modules.data,c="",d=Array(l+2*a.margin+1).join(o.WW);d=Array(a.margin/2+1).join(d+"\n");let u=Array(a.margin+1).join(o.WW);c+=d;for(let e=0;e<l;e+=2){c+=u;for(let t=0;t<l;t++){var p;let i=h[e*l+t],r=h[(e+1)*l+t];c+=(p=o,i&&r?p.BB:i&&!r?p.BW:!i&&r?p.WB:p.WW)}c+=u+"\n"}return c+=d.slice(0,-1),"function"==typeof i&&i(null,c),c},t.renderToFile=function(e,r,s,n){void 0===n&&(n=s,s=void 0);let a=i(92048),o=t.render(r,s);a.writeFile(e,o,n)}},20802:(e,t)=>{function i(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let i=parseInt(t.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:255&i,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,s=e.scale||4;return{width:r,scale:r?4:s,margin:t,color:{dark:i(e.color.dark||"#000000ff"),light:i(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,i){let r=t.getScale(e,i);return Math.floor((e+2*i.margin)*r)},t.qrToImageData=function(e,i,r){let s=i.modules.size,n=i.modules.data,a=t.getScale(s,r),o=Math.floor((s+2*r.margin)*a),l=r.margin*a,h=[r.color.light,r.color.dark];for(let t=0;t<o;t++)for(let i=0;i<o;i++){let c=(t*o+i)*4,d=r.color.light;t>=l&&i>=l&&t<o-l&&i<o-l&&(d=h[n[Math.floor((t-l)/a)*s+Math.floor((i-l)/a)]?1:0]),e[c++]=d.r,e[c++]=d.g,e[c++]=d.b,e[c]=d.a}}},5570:(e,t,i)=>{let r=i(91817),s=i(18895),n=i(8276),a=i(86318),o=i(73678),l=i(47979);function h(e,t,i){if(void 0===e)throw Error("String required as first argument");if(void 0===i&&(i=t,t={}),"function"!=typeof i){if(r())t=i||{},i=null;else throw Error("Callback required as last argument")}return{opts:t,cb:i}}function c(e){switch(e){case"svg":return l;case"txt":case"utf8":return a;default:return n}}function d(e,t,i){if(!i.cb)return new Promise(function(r,n){try{let a=s.create(t,i.opts);return e(a,i.opts,function(e,t){return e?n(e):r(t)})}catch(e){n(e)}});try{let r=s.create(t,i.opts);return e(r,i.opts,i.cb)}catch(e){i.cb(e)}}t.create=s.create,t.toCanvas=i(59157).toCanvas,t.toString=function(e,t,i){let r=h(e,t,i);return d(function(e){switch(e){case"svg":return l;case"terminal":return o;default:return a}}(r.opts?r.opts.type:void 0).render,e,r)},t.toDataURL=function(e,t,i){let r=h(e,t,i);return d(c(r.opts.type).renderToDataURL,e,r)},t.toBuffer=function(e,t,i){let r=h(e,t,i);return d(c(r.opts.type).renderToBuffer,e,r)},t.toFile=function(e,t,i,s){if("string"!=typeof e||!("string"==typeof t||"object"==typeof t))throw Error("Invalid argument");if(arguments.length<3&&!r())throw Error("Too few arguments provided");let n=h(t,i,s);return d(c(n.opts.type||e.slice((e.lastIndexOf(".")-1>>>0)+2).toLowerCase()).renderToFile.bind(null,e),t,n)},t.toFileStream=function(e,t,i){if(arguments.length<2)throw Error("Too few arguments provided");let r=h(t,i,e.emit.bind(e,"error"));d(c("png").renderToFileStream.bind(null,e),t,r)}},90908:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});let r=(0,i(68570).createProxy)(String.raw`/var/www/flask_app/ast_chat/app/page.tsx#default`)}};var t=require("../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[3,506,482],()=>i(86513));module.exports=r})();