"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./hooks/useCardStudioRefactored.ts":
/*!******************************************!*\
  !*** ./hooks/useCardStudioRefactored.ts ***!
  \******************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useCardStudio: function() { return /* binding */ useCardStudio; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sonner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sonner */ \"(app-pages-browser)/./node_modules/sonner/dist/index.mjs\");\n/* harmony import */ var _cardStudio_useWebSocket__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cardStudio/useWebSocket */ \"(app-pages-browser)/./hooks/cardStudio/useWebSocket.ts\");\n/* harmony import */ var _cardStudio_useJobManagementSimplified__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cardStudio/useJobManagementSimplified */ \"(app-pages-browser)/./hooks/cardStudio/useJobManagementSimplified.ts\");\n/* harmony import */ var _cardStudio_useMessageGeneration__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cardStudio/useMessageGeneration */ \"(app-pages-browser)/./hooks/cardStudio/useMessageGeneration.ts\");\n/* harmony import */ var _cardStudio_useFileHandling__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./cardStudio/useFileHandling */ \"(app-pages-browser)/./hooks/cardStudio/useFileHandling.ts\");\n/* harmony import */ var _cardStudio_useDraftGeneration__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./cardStudio/useDraftGeneration */ \"(app-pages-browser)/./hooks/cardStudio/useDraftGeneration.ts\");\n/* harmony import */ var _cardStudio_useCardGeneration__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cardStudio/useCardGeneration */ \"(app-pages-browser)/./hooks/cardStudio/useCardGeneration.ts\");\n/* harmony import */ var _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./cardStudio/constants */ \"(app-pages-browser)/./hooks/cardStudio/constants.ts\");\n/* harmony import */ var _cardStudio_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./cardStudio/utils */ \"(app-pages-browser)/./hooks/cardStudio/utils.ts\");\n/* harmony import */ var _lib_storageManager__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/lib/storageManager */ \"(app-pages-browser)/./lib/storageManager.ts\");\n/* __next_internal_client_entry_do_not_use__ useCardStudio auto */ \n\n// Import modular hooks\n\n\n\n\n\n\n// Import constants and utils\n\n\n\nfunction useCardStudio() {\n    // Core form state\n    const [prompt, setPrompt] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [toField, setToField] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [fromField, setFromField] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [relationshipField, setRelationshipField] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [selectedType, setSelectedType] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"birthday\");\n    const [customCardType, setCustomCardType] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [selectedTone, setSelectedTone] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"funny\");\n    // Advanced options state\n    const [showAdvanced, setShowAdvanced] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [selectedArtisticStyle, setSelectedArtisticStyle] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"watercolor\");\n    const [customStyleDescription, setCustomStyleDescription] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [selectedImageModel, setSelectedImageModel] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"gpt-image-1\");\n    const [selectedDraftModel, setSelectedDraftModel] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"gpt-image-1\");\n    const [fastPreviewMode, setFastPreviewMode] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    // Email state\n    const [userEmail, setUserEmail] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    // Card options\n    const [numberOfCards, setNumberOfCards] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(1);\n    const [isHandwrittenMessage, setIsHandwrittenMessage] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [isFrontBackOnly, setIsFrontBackOnly] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [selectedPaperSize, setSelectedPaperSize] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"standard\");\n    // UI state\n    const [isTextareaExpanded, setIsTextareaExpanded] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [isMessageExpanded, setIsMessageExpanded] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [showSettings, setShowSettings] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [showTemplateGallery, setShowTemplateGallery] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [showPrintConfirmation, setShowPrintConfirmation] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [showTemplateCustomization, setShowTemplateCustomization] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    // Restoration state\n    const [isRestoringJobs, setIsRestoringJobs] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const [selectedTemplate, setSelectedTemplate] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [isInitialLoadComplete, setIsInitialLoadComplete] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    // Template state\n    const [templateSearchQuery, setTemplateSearchQuery] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"\");\n    const [isSearchingTemplates, setIsSearchingTemplates] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [aiFilteredCards, setAiFilteredCards] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [searchMode, setSearchMode] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"text\");\n    const [textFilteredCards, setTextFilteredCards] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [showPrompts, setShowPrompts] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [printOption, setPrintOption] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"physical\");\n    // Template customization state\n    const [templateCustomizations, setTemplateCustomizations] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({\n        promptChanges: \"\",\n        messageChanges: \"\",\n        useReferenceImage: false,\n        referenceImageFile: null,\n        referenceImageUrls: [],\n        referenceImageTransformation: \"\"\n    });\n    // Section loading states\n    const [sectionLoadingStates, setSectionLoadingStates] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({\n        frontCover: \"idle\",\n        backCover: \"idle\",\n        leftInterior: \"idle\",\n        rightInterior: \"idle\"\n    });\n    // Countdown state\n    const [countdown, setCountdown] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0);\n    const [countdownInterval, setCountdownInterval] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    // Use modular hooks\n    const webSocket = (0,_cardStudio_useWebSocket__WEBPACK_IMPORTED_MODULE_2__.useWebSocket)();\n    const jobManagement = (0,_cardStudio_useJobManagementSimplified__WEBPACK_IMPORTED_MODULE_3__.useJobManagement)();\n    const fileHandling = (0,_cardStudio_useFileHandling__WEBPACK_IMPORTED_MODULE_5__.useFileHandling)();\n    const messageGeneration = (0,_cardStudio_useMessageGeneration__WEBPACK_IMPORTED_MODULE_4__.useMessageGeneration)(selectedType, customCardType, selectedTone, prompt, toField, fromField, relationshipField, fileHandling.photoReferences);\n    // Draft generation props\n    const draftGenerationProps = {\n        selectedType,\n        customCardType,\n        selectedTone,\n        selectedArtisticStyle,\n        customStyleDescription,\n        selectedDraftModel,\n        selectedImageModel,\n        selectedPaperSize,\n        prompt,\n        toField,\n        fromField,\n        userEmail,\n        finalCardMessage: messageGeneration.finalCardMessage,\n        isHandwrittenMessage,\n        isFrontBackOnly,\n        referenceImageUrls: fileHandling.referenceImageUrls,\n        photoReferences: fileHandling.photoReferences,\n        relationshipField,\n        saveJobToStorage: jobManagement.saveJobToStorage,\n        subscribeToJob: webSocket.subscribeToJob,\n        unsubscribeFromAllJobs: webSocket.unsubscribeFromAllJobs,\n        startElapsedTimeTracking: jobManagement.startElapsedTimeTracking,\n        stopElapsedTimeTracking: jobManagement.stopElapsedTimeTracking\n    };\n    const draftGeneration = (0,_cardStudio_useDraftGeneration__WEBPACK_IMPORTED_MODULE_6__.useDraftGeneration)(draftGenerationProps);\n    // Card generation props\n    const cardGenerationProps = {\n        selectedType,\n        customCardType,\n        selectedTone,\n        selectedArtisticStyle,\n        customStyleDescription,\n        selectedImageModel,\n        selectedPaperSize,\n        prompt,\n        toField,\n        fromField,\n        userEmail,\n        finalCardMessage: messageGeneration.finalCardMessage,\n        isHandwrittenMessage,\n        isFrontBackOnly,\n        referenceImageUrls: fileHandling.referenceImageUrls,\n        photoReferences: fileHandling.photoReferences,\n        relationshipField,\n        numberOfCards,\n        saveJobToStorage: jobManagement.saveJobToStorage,\n        removeJobFromStorage: jobManagement.removeJobFromStorage,\n        subscribeToJob: webSocket.subscribeToJob,\n        startElapsedTimeTracking: jobManagement.startElapsedTimeTracking,\n        stopElapsedTimeTracking: jobManagement.stopElapsedTimeTracking,\n        setCurrentJobId: jobManagement.setCurrentJobId,\n        setIsDraftMode: draftGeneration.setIsDraftMode,\n        setDraftCards: draftGeneration.setDraftCards,\n        setSelectedDraftIndex: draftGeneration.setSelectedDraftIndex,\n        setIsGeneratingFinalCard: draftGeneration.setIsGeneratingFinalCard,\n        setPreviewingDraftIndex: draftGeneration.setPreviewingDraftIndex,\n        setDraftCompletionShown: draftGeneration.setDraftCompletionShown,\n        setDraftCompletionCount: draftGeneration.setDraftCompletionCount\n    };\n    const cardGeneration = (0,_cardStudio_useCardGeneration__WEBPACK_IMPORTED_MODULE_7__.useCardGeneration)(cardGenerationProps);\n    // Handle job updates from WebSocket\n    const handleJobUpdate = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((data)=>{\n        const { job_id, status, progress, cardData, error, completedAt } = data;\n        if (!job_id) return;\n        // Skip updates if we're still restoring jobs from localStorage\n        if (isRestoringJobs) {\n            console.log(\"⏳ Skipping job update during restoration:\", job_id);\n            return;\n        }\n        // Check if this is a draft job\n        const isDraftJob1 = job_id.startsWith(\"draft-\");\n        const draftIndex = isDraftJob1 ? parseInt(job_id.split(\"-\")[1]) : -1;\n        // Filter out updates from wrong job type\n        // If we're in draft mode, only process draft jobs\n        // If we're in final mode, only process non-draft jobs\n        const isInDraftMode = draftGeneration.isDraftMode;\n        if (isInDraftMode && !isDraftJob1) {\n            console.log(\"\\uD83D\\uDEAB Ignoring non-draft job update in draft mode:\", job_id);\n            return;\n        }\n        if (!isInDraftMode && isDraftJob1) {\n            console.log(\"\\uD83D\\uDEAB Ignoring draft job update in final mode:\", job_id);\n            return;\n        }\n        console.log(\"\\uD83D\\uDD04 Processing job update:\", {\n            job_id,\n            status,\n            isDraftJob: isDraftJob1,\n            draftIndex,\n            progress\n        });\n        // Update progress if provided\n        if (progress) {\n            // IMPORTANT: Don't show \"Generation complete!\" until we've actually processed the card\n            // This prevents the UI from showing completion before the card is ready\n            if (progress.includes(\"Generation complete!\") && status === \"completed\" && !isDraftJob1) {\n                console.log('⏸️ Holding \"Generation complete!\" message until card is processed');\n            // Don't update the progress message yet - it will be set in handleFinalCardCompletion\n            } else {\n                cardGeneration.setGenerationProgress(progress);\n                draftGeneration.setGenerationProgress(progress);\n                console.log(\"\\uD83D\\uDCCA Progress message: \".concat(progress));\n            }\n        }\n        if (status === \"completed\" && cardData) {\n            console.log(\"\\uD83C\\uDF89 Job completed! Card data:\", cardData, \"isDraftJob:\", isDraftJob1);\n            if (isDraftJob1 && draftIndex >= 0) {\n                var _cardData_generatedPrompts;\n                // Handle draft card completion\n                console.log(\"\\uD83C\\uDFA8 Draft variation \".concat(draftIndex + 1, \" completed!\"));\n                // Get style info for smart style mode\n                let styleInfo = undefined;\n                if (selectedArtisticStyle === \"ai-smart-style\") {\n                    const predefinedStyles = [\n                        \"watercolor\",\n                        \"botanical\",\n                        \"comic-book\",\n                        \"dreamy-fantasy\",\n                        \"minimalist\"\n                    ];\n                    const styleLabels = [\n                        \"\\uD83C\\uDFA8 Watercolor\",\n                        \"\\uD83C\\uDF3F Botanical\",\n                        \"\\uD83D\\uDCA5 Comic Book\",\n                        \"\\uD83C\\uDF38 Dreamy Fantasy\",\n                        \"✨ Minimalist\"\n                    ];\n                    if (draftIndex >= 0 && draftIndex < predefinedStyles.length) {\n                        styleInfo = {\n                            styleName: predefinedStyles[draftIndex],\n                            styleLabel: styleLabels[draftIndex]\n                        };\n                    }\n                }\n                const draftCard = {\n                    id: \"draft-\".concat(draftIndex + 1, \"-\").concat(Date.now()),\n                    prompt: cardData.prompt || \"Draft Variation \".concat(draftIndex + 1),\n                    frontCover: cardData.frontCover || \"\",\n                    backCover: \"\",\n                    leftPage: \"\",\n                    rightPage: \"\",\n                    createdAt: new Date(),\n                    generatedPrompts: {\n                        frontCover: ((_cardData_generatedPrompts = cardData.generatedPrompts) === null || _cardData_generatedPrompts === void 0 ? void 0 : _cardData_generatedPrompts.frontCover) || \"\"\n                    },\n                    styleInfo: styleInfo\n                };\n                // Simplified draft tracking - use fixed array positions\n                draftGeneration.setDraftCards((prev)=>{\n                    const updated = [\n                        ...prev\n                    ];\n                    // Ensure array has 5 slots\n                    while(updated.length < 5){\n                        updated.push(null);\n                    }\n                    // Place draft at its correct index\n                    updated[draftIndex] = draftCard;\n                    console.log(\"✅ Draft \".concat(draftIndex + 1, \" completed and stored at index \").concat(draftIndex));\n                    // No longer save individual drafts to localStorage\n                    return updated;\n                });\n                // Simplified completion tracking - count the updated array including the new draft\n                const updatedDrafts = [\n                    ...draftGeneration.draftCards\n                ];\n                updatedDrafts[draftIndex] = draftCard;\n                const completedCount = updatedDrafts.filter(Boolean).length;\n                console.log(\"\\uD83D\\uDCCA Draft progress: \".concat(completedCount, \"/5 variations complete\"));\n                // Update progress\n                const progressMsg = completedCount === 5 ? \"All 5 variations ready! Choose your favorite below.\" : \"\".concat(completedCount, \"/5 variations complete...\").concat(completedCount >= 2 ? \" You can select one now!\" : \"\");\n                draftGeneration.setGenerationProgress(progressMsg);\n                // Override time-based progress with real progress when drafts complete\n                // Don't override time-based progress\n                console.log(\"\\uD83C\\uDFA8 Draft \".concat(completedCount, \"/5 completed\"));\n                // Handle milestones\n                if (completedCount === 1) {\n                    (0,_cardStudio_utils__WEBPACK_IMPORTED_MODULE_9__.scrollToCardPreview)();\n                }\n                if (completedCount === 5 && !draftGeneration.isGeneratingFinalCard) {\n                    draftGeneration.setIsGenerating(false);\n                    jobManagement.stopElapsedTimeTracking();\n                    sonner__WEBPACK_IMPORTED_MODULE_1__.toast.success(\"\\uD83C\\uDFA8 All 5 front cover variations ready! Choose your favorite below.\");\n                }\n                // Keep draft jobs in storage for later retrieval\n                // Only unsubscribe from WebSocket\n                webSocket.unsubscribeFromJob(job_id);\n                console.log(\"✅ Keeping draft job \".concat(job_id, \" in storage for future access\"));\n            } else {\n                // Handle final card completion\n                console.log(\"\\uD83D\\uDD0D Final card completion detected. Card data structure:\", {\n                    hasCardData: !!cardData,\n                    cardDataKeys: Object.keys(cardData || {}),\n                    frontCover: (cardData === null || cardData === void 0 ? void 0 : cardData.frontCover) ? \"Present\" : \"Missing\",\n                    backCover: (cardData === null || cardData === void 0 ? void 0 : cardData.backCover) ? \"Present\" : \"Missing\",\n                    leftInterior: (cardData === null || cardData === void 0 ? void 0 : cardData.leftInterior) ? \"Present\" : \"Missing\",\n                    rightInterior: (cardData === null || cardData === void 0 ? void 0 : cardData.rightInterior) ? \"Present\" : \"Missing\",\n                    leftPage: (cardData === null || cardData === void 0 ? void 0 : cardData.leftPage) ? \"Present\" : \"Missing\",\n                    rightPage: (cardData === null || cardData === void 0 ? void 0 : cardData.rightPage) ? \"Present\" : \"Missing\"\n                });\n                console.log(\"\\uD83D\\uDCDD Full card data:\", JSON.stringify(cardData, null, 2));\n                // Map backend field names to frontend field names\n                const mappedCardData = {\n                    ...cardData,\n                    leftInterior: cardData.leftInterior || cardData.leftPage,\n                    rightInterior: cardData.rightInterior || cardData.rightPage,\n                    // Keep original fields for backward compatibility\n                    leftPage: cardData.leftPage || cardData.leftInterior,\n                    rightPage: cardData.rightPage || cardData.rightInterior\n                };\n                console.log(\"\\uD83D\\uDD04 Mapped card data for frontend compatibility:\", {\n                    frontCover: mappedCardData.frontCover ? \"Present\" : \"Missing\",\n                    backCover: mappedCardData.backCover ? \"Present\" : \"Missing\",\n                    leftInterior: mappedCardData.leftInterior ? \"Present\" : \"Missing\",\n                    rightInterior: mappedCardData.rightInterior ? \"Present\" : \"Missing\"\n                });\n                // Call the completion handler\n                console.log(\"\\uD83D\\uDE80 Calling handleFinalCardCompletion...\");\n                cardGeneration.handleFinalCardCompletion(mappedCardData);\n                // Card is automatically added to recent cards by markJobComplete\n                jobManagement.removeJobFromStorage(job_id);\n                jobManagement.setCurrentJobId(null);\n                webSocket.unsubscribeFromJob(job_id);\n            }\n        } else if (status === \"failed\") {\n            console.error(\"❌ Job failed:\", error);\n            if (isDraftJob1 && draftIndex >= 0) {\n                sonner__WEBPACK_IMPORTED_MODULE_1__.toast.error(\"Draft variation \".concat(draftIndex + 1, \" failed. Continuing with others...\"));\n            } else {\n                sonner__WEBPACK_IMPORTED_MODULE_1__.toast.error(\"❌ Card generation failed. Please try again.\");\n                cardGeneration.setIsGenerating(false);\n                draftGeneration.setIsGeneratingFinalCard(false);\n                jobManagement.stopElapsedTimeTracking();\n                cardGeneration.setGenerationProgress(\"\");\n                // Don't reset progress - let time-based progress continue\n                // jobManagement.setProgressPercentage(0);\n                jobManagement.setCurrentJobId(null);\n                webSocket.unsubscribeFromJob(job_id);\n            }\n            jobManagement.removeJobFromStorage(job_id);\n        } else if (status === \"not_found\") {\n            console.warn(\"⚠️ Job not found on server, cleaning up stale reference:\", job_id);\n            // Clean up stale job reference\n            if (webSocket.currentJobRef.current === job_id) {\n                webSocket.currentJobRef.current = null;\n            }\n            // Reset UI state if this was the current job\n            if (jobManagement.currentJobId === job_id) {\n                jobManagement.setCurrentJobId(null);\n                cardGeneration.setIsGenerating(false);\n                draftGeneration.setIsGeneratingFinalCard(false);\n                cardGeneration.setGenerationProgress(\"\");\n                // Don't reset progress - let time-based progress continue\n                // jobManagement.setProgressPercentage(0);\n                jobManagement.stopElapsedTimeTracking();\n            }\n            // Clean up storage\n            jobManagement.removeJobFromStorage(job_id);\n            webSocket.unsubscribeFromJob(job_id);\n        }\n    }, [\n        selectedArtisticStyle,\n        draftGeneration,\n        cardGeneration,\n        jobManagement,\n        webSocket,\n        isRestoringJobs\n    ]);\n    // Set up WebSocket job update handler\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        webSocket.setJobUpdateHandler(handleJobUpdate);\n    }, [\n        webSocket,\n        handleJobUpdate\n    ]);\n    // Track if we've already logged the stale job message\n    const staleJobLoggedRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    // Auto-reconnect WebSocket if disconnected during active generation\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (!webSocket.isSocketConnected && (cardGeneration.isGenerating || draftGeneration.isGeneratingFinalCard) && webSocket.currentJobRef.current) {\n            // Check if the generation has been running for more than 5 minutes\n            if (jobManagement.generationStartTime) {\n                const jobAge = Date.now() - jobManagement.generationStartTime;\n                if (jobAge > 5 * 60 * 1000) {\n                    if (!staleJobLoggedRef.current) {\n                        console.log(\"⏰ Job is older than 5 minutes, stopping reconnection attempts\");\n                        staleJobLoggedRef.current = true;\n                        // Clean up stale job\n                        const jobId = webSocket.currentJobRef.current;\n                        if (jobId) {\n                            console.log(\"\\uD83E\\uDDF9 Cleaning up stale job:\", jobId);\n                            // Remove from localStorage (only if not a draft job)\n                            if (!jobId.startsWith(\"draft-\")) {\n                                jobManagement.removeJobFromStorage(jobId);\n                            }\n                            // Reset generation states\n                            cardGeneration.setIsGenerating(false);\n                            draftGeneration.setIsGeneratingFinalCard(false);\n                            draftGeneration.setIsDraftMode(false);\n                            draftGeneration.setDraftCards([]);\n                            draftGeneration.setDraftCompletionCount(0);\n                            draftGeneration.setDraftCompletionShown(false);\n                            jobManagement.setCurrentJobId(null);\n                            jobManagement.setGenerationProgress(\"\");\n                            // Don't reset progress - let time-based progress continue\n                            // jobManagement.setProgressPercentage(0);\n                            jobManagement.stopElapsedTimeTracking();\n                            // Unsubscribe from job\n                            webSocket.unsubscribeFromJob(jobId);\n                            // Show error toast\n                            sonner__WEBPACK_IMPORTED_MODULE_1__.toast.error(\"Card generation timed out. Please try again.\");\n                        }\n                    }\n                    return;\n                }\n            }\n            console.log(\"\\uD83D\\uDD04 WebSocket disconnected during generation, attempting reconnect...\");\n            const reconnectTimer = setTimeout(()=>{\n                webSocket.connectWebSocket();\n                // Re-subscribe to current job after reconnection\n                const jobId = webSocket.currentJobRef.current;\n                if (jobId) {\n                    setTimeout(()=>{\n                        console.log(\"\\uD83D\\uDCE1 Re-subscribing to job after reconnect:\", jobId);\n                        webSocket.subscribeToJob(jobId);\n                    }, 1000);\n                }\n            }, 2000);\n            return ()=>clearTimeout(reconnectTimer);\n        }\n    }, [\n        webSocket,\n        cardGeneration.isGenerating,\n        draftGeneration.isGeneratingFinalCard,\n        jobManagement.generationStartTime\n    ]);\n    // Reset stale job flag when generation starts\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if (cardGeneration.isGenerating || draftGeneration.isGeneratingFinalCard) {\n            staleJobLoggedRef.current = false;\n        }\n    }, [\n        cardGeneration.isGenerating,\n        draftGeneration.isGeneratingFinalCard\n    ]);\n    // Monitor for stale job updates\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        if ((cardGeneration.isGenerating || draftGeneration.isGeneratingFinalCard) && webSocket.currentJobRef.current) {\n            const checkInterval = setInterval(async ()=>{\n                const timeSinceLastUpdate = Date.now() - webSocket.lastJobUpdateRef.current;\n                const jobId = webSocket.currentJobRef.current;\n                // Very aggressive checking when at 95%+ progress\n                if (jobManagement.progressPercentage >= 95 && timeSinceLastUpdate > 5000) {\n                    console.warn(\"⚠️ No updates for \".concat(Math.round(timeSinceLastUpdate / 1000), \"s at \").concat(jobManagement.progressPercentage, \"% progress - checking job status...\"));\n                    if (jobId) {\n                        try {\n                            const response = await fetch(\"/api/job-status/\".concat(jobId));\n                            if (response.ok) {\n                                const jobStatus = await response.json();\n                                console.log(\"\\uD83D\\uDCCA Direct job status check:\", jobStatus);\n                                if (jobStatus.status === \"completed\" && jobStatus.cardData) {\n                                    console.log(\"✅ Job is actually completed! Processing result...\");\n                                    handleJobUpdate({\n                                        job_id: jobId,\n                                        status: \"completed\",\n                                        progress: \"Card generation complete!\",\n                                        cardData: jobStatus.cardData\n                                    });\n                                    return; // Exit early on completion\n                                }\n                            }\n                        } catch (error) {\n                            console.error(\"Failed to check job status:\", error);\n                        }\n                    }\n                } else if (jobManagement.progressPercentage >= 90 && timeSinceLastUpdate > 10000) {\n                    console.warn(\"⚠️ No updates for \".concat(Math.round(timeSinceLastUpdate / 1000), \"s at \").concat(jobManagement.progressPercentage, \"% progress\"));\n                    if (jobId) {\n                        try {\n                            const response = await fetch(\"/api/job-status/\".concat(jobId));\n                            if (response.ok) {\n                                const jobStatus = await response.json();\n                                console.log(\"\\uD83D\\uDCCA Direct job status check:\", jobStatus);\n                                if (jobStatus.status === \"completed\" && jobStatus.cardData) {\n                                    console.log(\"✅ Job is actually completed! Processing result...\");\n                                    handleJobUpdate({\n                                        job_id: jobId,\n                                        status: \"completed\",\n                                        progress: \"Card generation complete!\",\n                                        cardData: jobStatus.cardData\n                                    });\n                                    return; // Exit early on completion\n                                }\n                            }\n                        } catch (error) {\n                            console.error(\"Failed to check job status:\", error);\n                        }\n                    }\n                }\n                // Standard stale update check\n                if (timeSinceLastUpdate > 30000) {\n                    console.warn(\"⚠️ No job updates for 30 seconds, checking connection...\");\n                    if (!webSocket.isSocketConnected) {\n                        console.log(\"\\uD83D\\uDD04 WebSocket disconnected, reconnecting...\");\n                        webSocket.connectWebSocket();\n                    } else if (jobId) {\n                        console.log(\"\\uD83D\\uDCE1 Re-subscribing to job due to stale updates:\", jobId);\n                        webSocket.subscribeToJob(jobId);\n                    }\n                    // Reset the timer\n                    webSocket.lastJobUpdateRef.current = Date.now();\n                }\n            }, 3000); // Check every 3 seconds for faster detection at high progress\n            return ()=>clearInterval(checkInterval);\n        }\n    }, [\n        cardGeneration.isGenerating,\n        draftGeneration.isGeneratingFinalCard,\n        webSocket,\n        jobManagement.progressPercentage,\n        handleJobUpdate\n    ]);\n    // Simplified job restoration using new storage manager\n    const checkPendingJobs = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(async ()=>{\n        var _recovery_jobId;\n        console.log(\"\\uD83D\\uDD04 Checking for recovery data...\");\n        setIsRestoringJobs(true);\n        // Check for active recovery job\n        const recovery = _lib_storageManager__WEBPACK_IMPORTED_MODULE_10__.storage.getRecovery();\n        if (!recovery) {\n            console.log(\"✅ No active job to recover\");\n            setIsRestoringJobs(false);\n            return;\n        }\n        console.log(\"\\uD83D\\uDD04 Found recovery data:\", recovery);\n        // In our simplified system, we only track one active job at a time\n        // Recovery is meant for browser crashes during generation\n        const isRecoveryDraft = (_recovery_jobId = recovery.jobId) === null || _recovery_jobId === void 0 ? void 0 : _recovery_jobId.startsWith(\"draft-\");\n        if (isRecoveryDraft) {\n            console.log(\"\\uD83C\\uDFA8 Recovering from draft generation\");\n            // For draft recovery, we can't restore the exact state\n            // User will need to restart the draft generation\n            setIsRestoringJobs(false);\n            return;\n        }\n        // Process draft jobs first to restore draft state\n        if (draftJobs.length > 0) {\n            console.log(\"\\uD83C\\uDFA8 Found \".concat(draftJobs.length, \" draft jobs to restore\"));\n            // Collect all draft cards from all draft jobs\n            const draftsByIndex = new Array(5).fill(null);\n            for (const { job } of draftJobs){\n                if (job.draftCards && Array.isArray(job.draftCards) && job.draftCards.length > 0) {\n                    const draftCard = job.draftCards[0]; // Each job stores one draft\n                    const draftIndex = job.draftIndex;\n                    if (draftIndex >= 0 && draftIndex < 5) {\n                        draftsByIndex[draftIndex] = draftCard;\n                    }\n                }\n            }\n            // Get non-null drafts for counting\n            const allDraftCards = draftsByIndex.filter(Boolean);\n            // Restore all draft cards at once\n            if (allDraftCards.length > 0) {\n                console.log(\"\\uD83D\\uDD04 Restoring \".concat(allDraftCards.length, \" draft cards from \").concat(draftJobs.length, \" jobs\"));\n                // Only set draft mode when we have actual cards\n                console.log(\"\\uD83C\\uDFAF Setting isDraftMode to true - draft cards found\");\n                draftGeneration.setIsDraftMode(true);\n                // Use the draftsByIndex which already has drafts at correct positions\n                draftGeneration.setDraftCards(draftsByIndex);\n                draftGeneration.setDraftCompletionCount(allDraftCards.length);\n                // Set appropriate progress state\n                if (allDraftCards.length === 5) {\n                    draftGeneration.setDraftCompletionShown(true);\n                    draftGeneration.setIsGenerating(false);\n                    cardGeneration.setIsGenerating(false);\n                    draftGeneration.setGenerationProgress(\"\");\n                    cardGeneration.setGenerationProgress(\"\");\n                // Time-based progress will be cleared above\n                } else {\n                    draftGeneration.setIsGenerating(true);\n                    cardGeneration.setIsGenerating(true);\n                    const progressMsg = \"✨ \".concat(allDraftCards.length, \"/5 front cover variations complete... \").concat(allDraftCards.length >= 2 ? \"You can select one now to proceed!\" : \"\");\n                    draftGeneration.setGenerationProgress(progressMsg);\n                    cardGeneration.setGenerationProgress(progressMsg);\n                // Don't override time-based progress\n                }\n            }\n            // If no draft cards were found but we have draft jobs, set appropriate state\n            if (allDraftCards.length === 0 && draftJobs.length > 0) {\n                console.log(\"\\uD83D\\uDD04 Draft jobs found but no cards yet - setting generation state\");\n                // Set draft mode and initialize empty array for draft jobs in progress\n                draftGeneration.setIsDraftMode(true);\n                draftGeneration.setDraftCards([\n                    null,\n                    null,\n                    null,\n                    null,\n                    null\n                ]);\n                draftGeneration.setIsGenerating(true);\n                cardGeneration.setIsGenerating(true);\n                draftGeneration.setGenerationProgress(\"\\uD83C\\uDFA8 Creating 5 front cover variations for you to choose from...\");\n                cardGeneration.setGenerationProgress(\"\\uD83C\\uDFA8 Creating 5 front cover variations for you to choose from...\");\n            // Don't reset progress - let time-based progress continue\n            // jobManagement.setProgressPercentage(0);\n            }\n            // Subscribe to all non-stale draft jobs\n            for (const { jobId, job } of draftJobs){\n                const jobAge = Date.now() - (job.createdAt || Date.now());\n                const isStale = jobAge > 5 * 60 * 1000;\n                if (!isStale) {\n                    var _job_draftCards;\n                    console.log(\"\\uD83D\\uDCE1 Subscribing to draft job: \".concat(jobId, \" (has \").concat(((_job_draftCards = job.draftCards) === null || _job_draftCards === void 0 ? void 0 : _job_draftCards.length) || 0, \" cards)\"));\n                    webSocket.subscribeToJob(jobId);\n                }\n            }\n        }\n        // Process remaining jobs (final card generation)\n        for (const { jobId, job } of finalJobs){\n            console.log(\"\\uD83D\\uDCCB Processing job \".concat(jobId, \":\"), {\n                isDraft: jobId.startsWith(\"draft-\"),\n                status: job.status,\n                hasProgress: !!job.lastProgress,\n                createdAt: job.createdAt\n            });\n            // Check if job is stale (older than 5 minutes without completion)\n            const jobAge = Date.now() - (job.createdAt || Date.now());\n            const isStale = jobAge > 5 * 60 * 1000 && job.status !== \"completed\";\n            if (isStale) {\n                console.log(\"\\uD83E\\uDDF9 Cleaning up stale job: \".concat(jobId, \" (age: \").concat(Math.round(jobAge / 1000), \"s)\"));\n                jobManagement.removeJobFromStorage(jobId);\n                continue;\n            }\n            // Restore progress and state\n            // Don't restore progress - let time-based progress handle it\n            // if (job.lastProgress !== undefined) {\n            //   jobManagement.setProgressPercentage(job.lastProgress);\n            //   cardGeneration.setProgressPercentage(job.lastProgress);\n            //   draftGeneration.setProgressPercentage(job.lastProgress);\n            // }\n            // Only restore progress text if the job is not completed\n            // This prevents showing \"Generation complete! (100%)\" from old completed jobs\n            if (job.lastProgressText && job.status !== \"completed\") {\n                jobManagement.setGenerationProgress(job.lastProgressText);\n                cardGeneration.setGenerationProgress(job.lastProgressText);\n                draftGeneration.setGenerationProgress(job.lastProgressText);\n            }\n            // Restore final card generation state\n            cardGeneration.setIsGenerating(true);\n            draftGeneration.setIsGeneratingFinalCard(true);\n            // If we have a selected draft, restore it\n            if (job.selectedDraftIndex !== undefined) {\n                draftGeneration.setSelectedDraftIndex(job.selectedDraftIndex);\n            }\n            jobManagement.setCurrentJobId(jobId);\n            // Calculate elapsed time since job started\n            const jobStartTime = job.createdAt || Date.now();\n            const elapsedSinceStart = (Date.now() - jobStartTime) / 1000;\n            // Start elapsed time tracking\n            jobManagement.startElapsedTimeTracking();\n            // Subscribe to the job updates\n            webSocket.subscribeToJob(jobId);\n            // Verify job exists on backend\n            try {\n                const response = await fetch(\"\".concat(BACKEND_API_BASE_URL, \"/api/job-status/\").concat(jobId));\n                const result = await response.json();\n                console.log(\"\\uD83D\\uDCE1 Job status check for \".concat(jobId, \":\"), {\n                    ok: response.ok,\n                    status: response.status,\n                    resultStatus: result.status,\n                    url: \"\".concat(BACKEND_API_BASE_URL, \"/api/job-status/\").concat(jobId)\n                });\n                if (result.status === \"not_found\") {\n                    // Job doesn't exist on backend, clean up and notify user\n                    console.log(\"⚠️ Job \".concat(jobId, \" not found on backend, cleaning up...\"));\n                    jobManagement.removeJobFromStorage(jobId);\n                    // Reset generation state\n                    if (isDraftJob) {\n                        draftGeneration.setIsGenerating(false);\n                    } else {\n                        cardGeneration.setIsGenerating(false);\n                        draftGeneration.setIsGeneratingFinalCard(false);\n                    }\n                    // Show helpful message to user\n                    sonner__WEBPACK_IMPORTED_MODULE_1__.toast.error(\"Previous \".concat(isDraftJob ? \"draft\" : \"card\", \" generation expired. Please start a new one.\"), {\n                        duration: 5000\n                    });\n                    continue;\n                } else {\n                    // Job exists, show resuming message\n                    sonner__WEBPACK_IMPORTED_MODULE_1__.toast.info(\"Resuming \".concat(isDraftJob ? \"draft\" : \"card\", \" generation...\"));\n                }\n            } catch (error) {\n                console.error(\"Failed to verify job status:\", error);\n                // Continue anyway, WebSocket will handle it\n                sonner__WEBPACK_IMPORTED_MODULE_1__.toast.info(\"Attempting to resume \".concat(isDraftJob ? \"draft\" : \"card\", \" generation...\"));\n            }\n        }\n        // Restoration complete - allow WebSocket updates to be processed\n        // Add a small delay to ensure state updates have propagated\n        setTimeout(()=>{\n            console.log(\"✅ Job restoration complete, allowing WebSocket updates\");\n            setIsRestoringJobs(false);\n        }, 100);\n    }, [\n        jobManagement,\n        cardGeneration,\n        draftGeneration,\n        webSocket\n    ]);\n    // Load recovery data on component mount\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        console.log(\"\\uD83D\\uDE80 useCardStudio mounted, checking for recovery...\");\n        // Check for active recovery job\n        const recovery = _lib_storageManager__WEBPACK_IMPORTED_MODULE_10__.storage.getRecovery();\n        if (recovery) {\n            console.log(\"\\uD83D\\uDD04 Found active job to recover:\", recovery.jobId);\n            // Restore job state and subscribe to updates\n            jobManagement.setCurrentJobId(recovery.jobId);\n            webSocket.subscribeToJob(recovery.jobId);\n            // Set generation state\n            const isDraft = recovery.jobId.startsWith(\"draft-\");\n            if (isDraft) {\n                draftGeneration.setIsDraftMode(true);\n                draftGeneration.setIsGenerating(true);\n                cardGeneration.setIsGenerating(true);\n                draftGeneration.setGenerationProgress(\"\\uD83C\\uDFA8 Resuming draft generation...\");\n                cardGeneration.setGenerationProgress(\"\\uD83C\\uDFA8 Resuming draft generation...\");\n            } else {\n                cardGeneration.setIsGenerating(true);\n                cardGeneration.setGenerationProgress(\"\\uD83C\\uDFA8 Resuming card generation...\");\n            }\n            // Start elapsed time tracking\n            jobManagement.startElapsedTimeTracking(isDraft ? \"draft\" : \"final\");\n        }\n        // Always mark restoration as complete\n        setIsRestoringJobs(false);\n        // Mark restoration as complete after a small delay\n        setTimeout(()=>{\n            setIsRestoringJobs(false);\n        }, 100);\n    }, []);\n    // Return all the state and functions that the UI needs\n    return {\n        // Core state\n        prompt,\n        setPrompt,\n        finalCardMessage: messageGeneration.finalCardMessage,\n        setFinalCardMessage: messageGeneration.setFinalCardMessage,\n        toField,\n        setToField,\n        fromField,\n        setFromField,\n        relationshipField,\n        setRelationshipField,\n        selectedType,\n        setSelectedType,\n        customCardType,\n        setCustomCardType,\n        selectedTone,\n        setSelectedTone,\n        isGenerating: cardGeneration.isGenerating || draftGeneration.isGenerating,\n        setIsGenerating: cardGeneration.setIsGenerating,\n        isGeneratingMessage: messageGeneration.isGeneratingMessage,\n        setIsGeneratingMessage: messageGeneration.setIsGeneratingMessage,\n        generatedCard: cardGeneration.generatedCard,\n        setGeneratedCard: cardGeneration.setGeneratedCard,\n        numberOfCards,\n        setNumberOfCards,\n        generatedCards: cardGeneration.generatedCards,\n        setGeneratedCards: cardGeneration.setGeneratedCards,\n        selectedCardIndex: cardGeneration.selectedCardIndex,\n        setSelectedCardIndex: cardGeneration.setSelectedCardIndex,\n        // Advanced options\n        showAdvanced,\n        setShowAdvanced,\n        selectedArtisticStyle,\n        setSelectedArtisticStyle,\n        customStyleDescription,\n        setCustomStyleDescription,\n        selectedImageModel,\n        setSelectedImageModel,\n        selectedDraftModel,\n        setSelectedDraftModel,\n        // Draft mode\n        isDraftMode: draftGeneration.isDraftMode,\n        setIsDraftMode: draftGeneration.setIsDraftMode,\n        draftCards: draftGeneration.draftCards,\n        setDraftCards: draftGeneration.setDraftCards,\n        selectedDraftIndex: draftGeneration.selectedDraftIndex,\n        setSelectedDraftIndex: draftGeneration.setSelectedDraftIndex,\n        isGeneratingFinalCard: draftGeneration.isGeneratingFinalCard,\n        setIsGeneratingFinalCard: draftGeneration.setIsGeneratingFinalCard,\n        previewingDraftIndex: draftGeneration.previewingDraftIndex,\n        setPreviewingDraftIndex: draftGeneration.setPreviewingDraftIndex,\n        draftCompletionShown: draftGeneration.draftCompletionShown,\n        setDraftCompletionShown: draftGeneration.setDraftCompletionShown,\n        draftCompletionCount: draftGeneration.draftCompletionCount,\n        setDraftCompletionCount: draftGeneration.setDraftCompletionCount,\n        // Progress tracking\n        generationProgress: draftGeneration.isGenerating ? draftGeneration.generationProgress : cardGeneration.generationProgress,\n        setGenerationProgress: cardGeneration.setGenerationProgress,\n        progressPercentage: jobManagement.progressPercentage,\n        isCardCompleted: cardGeneration.isCardCompleted,\n        setIsCardCompleted: cardGeneration.setIsCardCompleted,\n        // Upload and personalization\n        referenceImages: fileHandling.referenceImages,\n        setReferenceImages: fileHandling.setReferenceImages,\n        referenceImageUrls: fileHandling.referenceImageUrls,\n        setReferenceImageUrls: fileHandling.setReferenceImageUrls,\n        imageTransformation: fileHandling.imageTransformation,\n        setImageTransformation: fileHandling.setImageTransformation,\n        isUploading: fileHandling.isUploading,\n        setIsUploading: fileHandling.setIsUploading,\n        // Email and settings\n        userEmail,\n        setUserEmail,\n        isHandwrittenMessage,\n        setIsHandwrittenMessage,\n        isFrontBackOnly,\n        setIsFrontBackOnly,\n        selectedPaperSize,\n        setSelectedPaperSize,\n        // UI state\n        isTextareaExpanded,\n        setIsTextareaExpanded,\n        isMessageExpanded,\n        setIsMessageExpanded,\n        showSettings,\n        setShowSettings,\n        showTemplateGallery,\n        setShowTemplateGallery,\n        showPrintConfirmation,\n        setShowPrintConfirmation,\n        // Generation time\n        generationDuration: cardGeneration.generationDuration,\n        setGenerationDuration: cardGeneration.setGenerationDuration,\n        currentElapsedTime: jobManagement.currentElapsedTime,\n        setCurrentElapsedTime: jobManagement.setCurrentElapsedTime,\n        // Helper functions\n        formatGenerationTime: _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__.formatGenerationTime,\n        formatCountdown: _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__.formatCountdown,\n        sendThankYouEmail: _cardStudio_utils__WEBPACK_IMPORTED_MODULE_9__.sendThankYouEmail,\n        chatWithAI: _cardStudio_utils__WEBPACK_IMPORTED_MODULE_9__.chatWithAI,\n        scrollToCardPreview: _cardStudio_utils__WEBPACK_IMPORTED_MODULE_9__.scrollToCardPreview,\n        // Time tracking functions\n        startElapsedTimeTracking: jobManagement.startElapsedTimeTracking,\n        stopElapsedTimeTracking: jobManagement.stopElapsedTimeTracking,\n        // File handling functions\n        handleFileUpload: fileHandling.handleFileUpload,\n        handleRemoveReferenceImage: fileHandling.handleRemoveReferenceImage,\n        // Simplified photo references\n        photoReferences: fileHandling.photoReferences,\n        setPhotoReferences: fileHandling.setPhotoReferences,\n        updatePhotoDescription: fileHandling.updatePhotoDescription,\n        // Message functions\n        handleGetMessageHelp: messageGeneration.handleGetMessageHelp,\n        addMessageToHistory: messageGeneration.addMessageToHistory,\n        undoMessage: messageGeneration.undoMessage,\n        redoMessage: messageGeneration.redoMessage,\n        // Job management\n        saveJobToStorage: jobManagement.saveJobToStorage,\n        removeJobFromStorage: jobManagement.removeJobFromStorage,\n        checkPendingJobs,\n        isRestoringJobs,\n        // Main generation functions\n        handleGenerateCardAsync: cardGeneration.handleGenerateCardAsync,\n        handleGenerateDraftCards: draftGeneration.handleGenerateDraftCards,\n        handleGenerateFinalFromDraft: draftGeneration.handleGenerateFinalFromDraft,\n        // Additional state for message refinement\n        messageHistory: messageGeneration.messageHistory,\n        setMessageHistory: messageGeneration.setMessageHistory,\n        currentMessageIndex: messageGeneration.currentMessageIndex,\n        setCurrentMessageIndex: messageGeneration.setCurrentMessageIndex,\n        refinementPrompt: messageGeneration.refinementPrompt,\n        setRefinementPrompt: messageGeneration.setRefinementPrompt,\n        isRefiningMessage: messageGeneration.isRefiningMessage,\n        setIsRefiningMessage: messageGeneration.setIsRefiningMessage,\n        showRefinementBox: messageGeneration.showRefinementBox,\n        setShowRefinementBox: messageGeneration.setShowRefinementBox,\n        // Template state\n        showTemplateCustomization,\n        setShowTemplateCustomization,\n        selectedTemplate,\n        setSelectedTemplate,\n        templateCustomizations,\n        setTemplateCustomizations,\n        templateSearchQuery,\n        setTemplateSearchQuery,\n        isSearchingTemplates,\n        setIsSearchingTemplates,\n        aiFilteredCards,\n        setAiFilteredCards,\n        searchMode,\n        setSearchMode,\n        textFilteredCards,\n        setTextFilteredCards,\n        showPrompts,\n        setShowPrompts,\n        // Print state\n        printOption,\n        setPrintOption,\n        // Additional draft mode state\n        handwritingSample: fileHandling.handwritingSample,\n        setHandwritingSample: fileHandling.setHandwritingSample,\n        handwritingSampleUrl: fileHandling.handwritingSampleUrl,\n        setHandwritingSampleUrl: fileHandling.setHandwritingSampleUrl,\n        // Job tracking\n        currentJobId: jobManagement.currentJobId,\n        setCurrentJobId: jobManagement.setCurrentJobId,\n        countdown,\n        setCountdown,\n        countdownInterval,\n        setCountdownInterval,\n        // Section loading states\n        sectionLoadingStates,\n        setSectionLoadingStates,\n        // Fast preview mode\n        fastPreviewMode,\n        setFastPreviewMode,\n        // Additional tracking\n        currentCardId: cardGeneration.currentCardId,\n        setCurrentCardId: cardGeneration.setCurrentCardId,\n        isInitialLoadComplete,\n        setIsInitialLoadComplete,\n        // Elapsed time tracking\n        generationStartTime: jobManagement.generationStartTime,\n        setGenerationStartTime: jobManagement.setGenerationStartTime,\n        elapsedTimeInterval: jobManagement.elapsedTimeInterval,\n        setElapsedTimeInterval: jobManagement.setElapsedTimeInterval,\n        // Constants for UI\n        cardTones: _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__.cardTones,\n        artisticStyles: _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__.artisticStyles,\n        paperSizes: _cardStudio_constants__WEBPACK_IMPORTED_MODULE_8__.paperSizes,\n        // WebSocket functions and state\n        isSocketConnected: webSocket.isSocketConnected,\n        connectWebSocket: webSocket.connectWebSocket,\n        disconnectWebSocket: webSocket.disconnectWebSocket,\n        subscribeToJob: webSocket.subscribeToJob,\n        unsubscribeFromJob: webSocket.unsubscribeFromJob,\n        handleJobUpdate,\n        handleFinalCardCompletion: cardGeneration.handleFinalCardCompletion\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2hvb2tzL3VzZUNhcmRTdHVkaW9SZWZhY3RvcmVkLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7bUVBRWlFO0FBQ2xDO0FBRy9CLHVCQUF1QjtBQUNrQztBQUNrQjtBQUNGO0FBQ1Y7QUFDTTtBQUNGO0FBRW5FLDZCQUE2QjtBQVFHO0FBQ3dEO0FBQ3pDO0FBRXhDLFNBQVNvQjtJQUNkLGtCQUFrQjtJQUNsQixNQUFNLENBQUNDLFFBQVFDLFVBQVUsR0FBR3RCLCtDQUFRQSxDQUFDO0lBQ3JDLE1BQU0sQ0FBQ3VCLFNBQVNDLFdBQVcsR0FBR3hCLCtDQUFRQSxDQUFDO0lBQ3ZDLE1BQU0sQ0FBQ3lCLFdBQVdDLGFBQWEsR0FBRzFCLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQzJCLG1CQUFtQkMscUJBQXFCLEdBQUc1QiwrQ0FBUUEsQ0FBQztJQUMzRCxNQUFNLENBQUM2QixjQUFjQyxnQkFBZ0IsR0FBRzlCLCtDQUFRQSxDQUFTO0lBQ3pELE1BQU0sQ0FBQytCLGdCQUFnQkMsa0JBQWtCLEdBQUdoQywrQ0FBUUEsQ0FBUztJQUM3RCxNQUFNLENBQUNpQyxjQUFjQyxnQkFBZ0IsR0FBR2xDLCtDQUFRQSxDQUFTO0lBRXpELHlCQUF5QjtJQUN6QixNQUFNLENBQUNtQyxjQUFjQyxnQkFBZ0IsR0FBR3BDLCtDQUFRQSxDQUFDO0lBQ2pELE1BQU0sQ0FBQ3FDLHVCQUF1QkMseUJBQXlCLEdBQUd0QywrQ0FBUUEsQ0FBUztJQUMzRSxNQUFNLENBQUN1Qyx3QkFBd0JDLDBCQUEwQixHQUFHeEMsK0NBQVFBLENBQVM7SUFDN0UsTUFBTSxDQUFDeUMsb0JBQW9CQyxzQkFBc0IsR0FBRzFDLCtDQUFRQSxDQUFTO0lBQ3JFLE1BQU0sQ0FBQzJDLG9CQUFvQkMsc0JBQXNCLEdBQUc1QywrQ0FBUUEsQ0FBUztJQUNyRSxNQUFNLENBQUM2QyxpQkFBaUJDLG1CQUFtQixHQUFHOUMsK0NBQVFBLENBQVU7SUFFaEUsY0FBYztJQUNkLE1BQU0sQ0FBQytDLFdBQVdDLGFBQWEsR0FBR2hELCtDQUFRQSxDQUFTO0lBRW5ELGVBQWU7SUFDZixNQUFNLENBQUNpRCxlQUFlQyxpQkFBaUIsR0FBR2xELCtDQUFRQSxDQUFTO0lBQzNELE1BQU0sQ0FBQ21ELHNCQUFzQkMsd0JBQXdCLEdBQUdwRCwrQ0FBUUEsQ0FBQztJQUNqRSxNQUFNLENBQUNxRCxpQkFBaUJDLG1CQUFtQixHQUFHdEQsK0NBQVFBLENBQUM7SUFDdkQsTUFBTSxDQUFDdUQsbUJBQW1CQyxxQkFBcUIsR0FBR3hELCtDQUFRQSxDQUFTO0lBRW5FLFdBQVc7SUFDWCxNQUFNLENBQUN5RCxvQkFBb0JDLHNCQUFzQixHQUFHMUQsK0NBQVFBLENBQUM7SUFDN0QsTUFBTSxDQUFDMkQsbUJBQW1CQyxxQkFBcUIsR0FBRzVELCtDQUFRQSxDQUFDO0lBQzNELE1BQU0sQ0FBQzZELGNBQWNDLGdCQUFnQixHQUFHOUQsK0NBQVFBLENBQUM7SUFDakQsTUFBTSxDQUFDK0QscUJBQXFCQyx1QkFBdUIsR0FBR2hFLCtDQUFRQSxDQUFDO0lBQy9ELE1BQU0sQ0FBQ2lFLHVCQUF1QkMseUJBQXlCLEdBQUdsRSwrQ0FBUUEsQ0FBQztJQUNuRSxNQUFNLENBQUNtRSwyQkFBMkJDLDZCQUE2QixHQUFHcEUsK0NBQVFBLENBQUM7SUFFM0Usb0JBQW9CO0lBQ3BCLE1BQU0sQ0FBQ3FFLGlCQUFpQkMsbUJBQW1CLEdBQUd0RSwrQ0FBUUEsQ0FBQztJQUN2RCxNQUFNLENBQUN1RSxrQkFBa0JDLG9CQUFvQixHQUFHeEUsK0NBQVFBLENBQXVCO0lBQy9FLE1BQU0sQ0FBQ3lFLHVCQUF1QkMseUJBQXlCLEdBQUcxRSwrQ0FBUUEsQ0FBQztJQUVuRSxpQkFBaUI7SUFDakIsTUFBTSxDQUFDMkUscUJBQXFCQyx1QkFBdUIsR0FBRzVFLCtDQUFRQSxDQUFDO0lBQy9ELE1BQU0sQ0FBQzZFLHNCQUFzQkMsd0JBQXdCLEdBQUc5RSwrQ0FBUUEsQ0FBQztJQUNqRSxNQUFNLENBQUMrRSxpQkFBaUJDLG1CQUFtQixHQUFHaEYsK0NBQVFBLENBQVEsRUFBRTtJQUNoRSxNQUFNLENBQUNpRixZQUFZQyxjQUFjLEdBQUdsRiwrQ0FBUUEsQ0FBMkI7SUFDdkUsTUFBTSxDQUFDbUYsbUJBQW1CQyxxQkFBcUIsR0FBR3BGLCtDQUFRQSxDQUFRLEVBQUU7SUFDcEUsTUFBTSxDQUFDcUYsYUFBYUMsZUFBZSxHQUFHdEYsK0NBQVFBLENBQUM7SUFDL0MsTUFBTSxDQUFDdUYsYUFBYUMsZUFBZSxHQUFHeEYsK0NBQVFBLENBQXVCO0lBRXJFLCtCQUErQjtJQUMvQixNQUFNLENBQUN5Rix3QkFBd0JDLDBCQUEwQixHQUFHMUYsK0NBQVFBLENBQUM7UUFDbkUyRixlQUFlO1FBQ2ZDLGdCQUFnQjtRQUNoQkMsbUJBQW1CO1FBQ25CQyxvQkFBb0I7UUFDcEJDLG9CQUFvQixFQUFFO1FBQ3RCQyw4QkFBOEI7SUFDaEM7SUFFQSx5QkFBeUI7SUFDekIsTUFBTSxDQUFDQyxzQkFBc0JDLHdCQUF3QixHQUFHbEcsK0NBQVFBLENBSzdEO1FBQ0RtRyxZQUFZO1FBQ1pDLFdBQVc7UUFDWEMsY0FBYztRQUNkQyxlQUFlO0lBQ2pCO0lBRUEsa0JBQWtCO0lBQ2xCLE1BQU0sQ0FBQ0MsV0FBV0MsYUFBYSxHQUFHeEcsK0NBQVFBLENBQVM7SUFDbkQsTUFBTSxDQUFDeUcsbUJBQW1CQyxxQkFBcUIsR0FBRzFHLCtDQUFRQSxDQUF3QjtJQUVsRixvQkFBb0I7SUFDcEIsTUFBTTJHLFlBQVl0RyxzRUFBWUE7SUFDOUIsTUFBTXVHLGdCQUFnQnRHLHdGQUFnQkE7SUFDdEMsTUFBTXVHLGVBQWVyRyw0RUFBZUE7SUFDcEMsTUFBTXNHLG9CQUFvQnZHLHNGQUFvQkEsQ0FDNUNzQixjQUNBRSxnQkFDQUUsY0FDQVosUUFDQUUsU0FDQUUsV0FDQUUsbUJBQ0FrRixhQUFhRSxlQUFlO0lBRzlCLHlCQUF5QjtJQUN6QixNQUFNQyx1QkFBdUI7UUFDM0JuRjtRQUNBRTtRQUNBRTtRQUNBSTtRQUNBRTtRQUNBSTtRQUNBRjtRQUNBYztRQUNBbEM7UUFDQUU7UUFDQUU7UUFDQXNCO1FBQ0FrRSxrQkFBa0JILGtCQUFrQkcsZ0JBQWdCO1FBQ3BEOUQ7UUFDQUU7UUFDQTBDLG9CQUFvQmMsYUFBYWQsa0JBQWtCO1FBQ25EZ0IsaUJBQWlCRixhQUFhRSxlQUFlO1FBQzdDcEY7UUFDQXVGLGtCQUFrQk4sY0FBY00sZ0JBQWdCO1FBQ2hEQyxnQkFBZ0JSLFVBQVVRLGNBQWM7UUFDeENDLHdCQUF3QlQsVUFBVVMsc0JBQXNCO1FBQ3hEQywwQkFBMEJULGNBQWNTLHdCQUF3QjtRQUNoRUMseUJBQXlCVixjQUFjVSx1QkFBdUI7SUFDaEU7SUFFQSxNQUFNQyxrQkFBa0I5RyxrRkFBa0JBLENBQUN1RztJQUUzQyx3QkFBd0I7SUFDeEIsTUFBTVEsc0JBQXNCO1FBQzFCM0Y7UUFDQUU7UUFDQUU7UUFDQUk7UUFDQUU7UUFDQUU7UUFDQWM7UUFDQWxDO1FBQ0FFO1FBQ0FFO1FBQ0FzQjtRQUNBa0Usa0JBQWtCSCxrQkFBa0JHLGdCQUFnQjtRQUNwRDlEO1FBQ0FFO1FBQ0EwQyxvQkFBb0JjLGFBQWFkLGtCQUFrQjtRQUNuRGdCLGlCQUFpQkYsYUFBYUUsZUFBZTtRQUM3Q3BGO1FBQ0FzQjtRQUNBaUUsa0JBQWtCTixjQUFjTSxnQkFBZ0I7UUFDaERPLHNCQUFzQmIsY0FBY2Esb0JBQW9CO1FBQ3hETixnQkFBZ0JSLFVBQVVRLGNBQWM7UUFDeENFLDBCQUEwQlQsY0FBY1Msd0JBQXdCO1FBQ2hFQyx5QkFBeUJWLGNBQWNVLHVCQUF1QjtRQUM5REksaUJBQWlCZCxjQUFjYyxlQUFlO1FBQzlDQyxnQkFBZ0JKLGdCQUFnQkksY0FBYztRQUM5Q0MsZUFBZUwsZ0JBQWdCSyxhQUFhO1FBQzVDQyx1QkFBdUJOLGdCQUFnQk0scUJBQXFCO1FBQzVEQywwQkFBMEJQLGdCQUFnQk8sd0JBQXdCO1FBQ2xFQyx5QkFBeUJSLGdCQUFnQlEsdUJBQXVCO1FBQ2hFQyx5QkFBeUJULGdCQUFnQlMsdUJBQXVCO1FBQ2hFQyx5QkFBeUJWLGdCQUFnQlUsdUJBQXVCO0lBQ2xFO0lBRUEsTUFBTUMsaUJBQWlCeEgsZ0ZBQWlCQSxDQUFDOEc7SUFFekMsb0NBQW9DO0lBQ3BDLE1BQU1XLGtCQUFrQmpJLGtEQUFXQSxDQUFDLENBQUNrSTtRQUNuQyxNQUFNLEVBQUVDLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLFFBQVEsRUFBRUMsS0FBSyxFQUFFQyxXQUFXLEVBQUUsR0FBR047UUFFbkUsSUFBSSxDQUFDQyxRQUFRO1FBRWIsK0RBQStEO1FBQy9ELElBQUloRSxpQkFBaUI7WUFDbkJzRSxRQUFRQyxHQUFHLENBQUMsNkNBQTZDUDtZQUN6RDtRQUNGO1FBRUEsK0JBQStCO1FBQy9CLE1BQU1RLGNBQWFSLE9BQU9TLFVBQVUsQ0FBQztRQUNyQyxNQUFNQyxhQUFhRixjQUFhRyxTQUFTWCxPQUFPWSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxDQUFDO1FBRWxFLHlDQUF5QztRQUN6QyxrREFBa0Q7UUFDbEQsc0RBQXNEO1FBQ3RELE1BQU1DLGdCQUFnQjNCLGdCQUFnQjRCLFdBQVc7UUFDakQsSUFBSUQsaUJBQWlCLENBQUNMLGFBQVk7WUFDaENGLFFBQVFDLEdBQUcsQ0FBQyw2REFBbURQO1lBQy9EO1FBQ0Y7UUFDQSxJQUFJLENBQUNhLGlCQUFpQkwsYUFBWTtZQUNoQ0YsUUFBUUMsR0FBRyxDQUFDLHlEQUErQ1A7WUFDM0Q7UUFDRjtRQUVBTSxRQUFRQyxHQUFHLENBQUMsdUNBQTZCO1lBQUVQO1lBQVFDO1lBQVFPLFlBQUFBO1lBQVlFO1lBQVlSO1FBQVM7UUFFNUYsOEJBQThCO1FBQzlCLElBQUlBLFVBQVU7WUFDWix1RkFBdUY7WUFDdkYsd0VBQXdFO1lBQ3hFLElBQUlBLFNBQVNhLFFBQVEsQ0FBQywyQkFBMkJkLFdBQVcsZUFBZSxDQUFDTyxhQUFZO2dCQUN0RkYsUUFBUUMsR0FBRyxDQUFDO1lBQ1osc0ZBQXNGO1lBQ3hGLE9BQU87Z0JBQ0xWLGVBQWVtQixxQkFBcUIsQ0FBQ2Q7Z0JBQ3JDaEIsZ0JBQWdCOEIscUJBQXFCLENBQUNkO2dCQUN0Q0ksUUFBUUMsR0FBRyxDQUFDLGtDQUFpQyxPQUFUTDtZQUN0QztRQUNGO1FBRUEsSUFBSUQsV0FBVyxlQUFlRSxVQUFVO1lBQ3RDRyxRQUFRQyxHQUFHLENBQUMsMENBQWdDSixVQUFVLGVBQWVLO1lBRXJFLElBQUlBLGVBQWNFLGNBQWMsR0FBRztvQkE4QmpCUDtnQkE3QmhCLCtCQUErQjtnQkFDL0JHLFFBQVFDLEdBQUcsQ0FBQyxnQ0FBcUMsT0FBZkcsYUFBYSxHQUFFO2dCQUVqRCxzQ0FBc0M7Z0JBQ3RDLElBQUlPLFlBQW1FQztnQkFDdkUsSUFBSWxILDBCQUEwQixrQkFBa0I7b0JBQzlDLE1BQU1tSCxtQkFBbUI7d0JBQ3ZCO3dCQUFjO3dCQUFhO3dCQUFjO3dCQUFrQjtxQkFDNUQ7b0JBQ0QsTUFBTUMsY0FBYzt3QkFDbEI7d0JBQWlCO3dCQUFnQjt3QkFBaUI7d0JBQXFCO3FCQUN4RTtvQkFDRCxJQUFJVixjQUFjLEtBQUtBLGFBQWFTLGlCQUFpQkUsTUFBTSxFQUFFO3dCQUMzREosWUFBWTs0QkFDVkssV0FBV0gsZ0JBQWdCLENBQUNULFdBQVc7NEJBQ3ZDYSxZQUFZSCxXQUFXLENBQUNWLFdBQVc7d0JBQ3JDO29CQUNGO2dCQUNGO2dCQUVBLE1BQU1jLFlBQTJCO29CQUMvQkMsSUFBSSxTQUEyQkMsT0FBbEJoQixhQUFhLEdBQUUsS0FBYyxPQUFYZ0IsS0FBS0MsR0FBRztvQkFDdkMzSSxRQUFRbUgsU0FBU25ILE1BQU0sSUFBSSxtQkFBa0MsT0FBZjBILGFBQWE7b0JBQzNENUMsWUFBWXFDLFNBQVNyQyxVQUFVLElBQUk7b0JBQ25DQyxXQUFXO29CQUNYNkQsVUFBVTtvQkFDVkMsV0FBVztvQkFDWEMsV0FBVyxJQUFJSjtvQkFDZkssa0JBQWtCO3dCQUNoQmpFLFlBQVlxQyxFQUFBQSw2QkFBQUEsU0FBUzRCLGdCQUFnQixjQUF6QjVCLGlEQUFBQSwyQkFBMkJyQyxVQUFVLEtBQUk7b0JBQ3ZEO29CQUNBbUQsV0FBV0E7Z0JBQ2I7Z0JBRUEsd0RBQXdEO2dCQUN4RC9CLGdCQUFnQkssYUFBYSxDQUFDeUMsQ0FBQUE7b0JBQzVCLE1BQU1DLFVBQVU7MkJBQUlEO3FCQUFLO29CQUN6QiwyQkFBMkI7b0JBQzNCLE1BQU9DLFFBQVFaLE1BQU0sR0FBRyxFQUFHO3dCQUN6QlksUUFBUUMsSUFBSSxDQUFDO29CQUNmO29CQUNBLG1DQUFtQztvQkFDbkNELE9BQU8sQ0FBQ3ZCLFdBQVcsR0FBR2M7b0JBQ3RCbEIsUUFBUUMsR0FBRyxDQUFDLFdBQTJERyxPQUFoREEsYUFBYSxHQUFFLG1DQUE0QyxPQUFYQTtvQkFFdkUsbURBQW1EO29CQUVuRCxPQUFPdUI7Z0JBQ1Q7Z0JBRUEsbUZBQW1GO2dCQUNuRixNQUFNRSxnQkFBZ0I7dUJBQUlqRCxnQkFBZ0JrRCxVQUFVO2lCQUFDO2dCQUNyREQsYUFBYSxDQUFDekIsV0FBVyxHQUFHYztnQkFDNUIsTUFBTWEsaUJBQWlCRixjQUFjRyxNQUFNLENBQUNDLFNBQVNsQixNQUFNO2dCQUMzRGYsUUFBUUMsR0FBRyxDQUFDLGdDQUFxQyxPQUFmOEIsZ0JBQWU7Z0JBRWpELGtCQUFrQjtnQkFDbEIsTUFBTUcsY0FBY0gsbUJBQW1CLElBQ25DLHdEQUNBLEdBQTZDQSxPQUExQ0EsZ0JBQWUsNkJBQWlGLE9BQXREQSxrQkFBa0IsSUFBSSw2QkFBNkI7Z0JBRXBHbkQsZ0JBQWdCOEIscUJBQXFCLENBQUN3QjtnQkFFdEMsdUVBQXVFO2dCQUN2RSxxQ0FBcUM7Z0JBQ3JDbEMsUUFBUUMsR0FBRyxDQUFDLHNCQUEyQixPQUFmOEIsZ0JBQWU7Z0JBRXZDLG9CQUFvQjtnQkFDcEIsSUFBSUEsbUJBQW1CLEdBQUc7b0JBQ3hCeEosc0VBQW1CQTtnQkFDckI7Z0JBRUEsSUFBSXdKLG1CQUFtQixLQUFLLENBQUNuRCxnQkFBZ0J1RCxxQkFBcUIsRUFBRTtvQkFDbEV2RCxnQkFBZ0J3RCxlQUFlLENBQUM7b0JBQ2hDbkUsY0FBY1UsdUJBQXVCO29CQUNyQ2xILHlDQUFLQSxDQUFDNEssT0FBTyxDQUFDO2dCQUNoQjtnQkFFQSxpREFBaUQ7Z0JBQ2pELGtDQUFrQztnQkFDbENyRSxVQUFVc0Usa0JBQWtCLENBQUM1QztnQkFDN0JNLFFBQVFDLEdBQUcsQ0FBQyx1QkFBOEIsT0FBUFAsUUFBTztZQUM1QyxPQUFPO2dCQUNMLCtCQUErQjtnQkFDL0JNLFFBQVFDLEdBQUcsQ0FBQyxxRUFBMkQ7b0JBQ3JFc0MsYUFBYSxDQUFDLENBQUMxQztvQkFDZjJDLGNBQWNDLE9BQU9DLElBQUksQ0FBQzdDLFlBQVksQ0FBQztvQkFDdkNyQyxZQUFZcUMsQ0FBQUEscUJBQUFBLCtCQUFBQSxTQUFVckMsVUFBVSxJQUFHLFlBQVk7b0JBQy9DQyxXQUFXb0MsQ0FBQUEscUJBQUFBLCtCQUFBQSxTQUFVcEMsU0FBUyxJQUFHLFlBQVk7b0JBQzdDQyxjQUFjbUMsQ0FBQUEscUJBQUFBLCtCQUFBQSxTQUFVbkMsWUFBWSxJQUFHLFlBQVk7b0JBQ25EQyxlQUFla0MsQ0FBQUEscUJBQUFBLCtCQUFBQSxTQUFVbEMsYUFBYSxJQUFHLFlBQVk7b0JBQ3JEMkQsVUFBVXpCLENBQUFBLHFCQUFBQSwrQkFBQUEsU0FBVXlCLFFBQVEsSUFBRyxZQUFZO29CQUMzQ0MsV0FBVzFCLENBQUFBLHFCQUFBQSwrQkFBQUEsU0FBVTBCLFNBQVMsSUFBRyxZQUFZO2dCQUMvQztnQkFDQXZCLFFBQVFDLEdBQUcsQ0FBQyxnQ0FBc0IwQyxLQUFLQyxTQUFTLENBQUMvQyxVQUFVLE1BQU07Z0JBRWpFLGtEQUFrRDtnQkFDbEQsTUFBTWdELGlCQUFpQjtvQkFDckIsR0FBR2hELFFBQVE7b0JBQ1huQyxjQUFjbUMsU0FBU25DLFlBQVksSUFBSW1DLFNBQVN5QixRQUFRO29CQUN4RDNELGVBQWVrQyxTQUFTbEMsYUFBYSxJQUFJa0MsU0FBUzBCLFNBQVM7b0JBQzNELGtEQUFrRDtvQkFDbERELFVBQVV6QixTQUFTeUIsUUFBUSxJQUFJekIsU0FBU25DLFlBQVk7b0JBQ3BENkQsV0FBVzFCLFNBQVMwQixTQUFTLElBQUkxQixTQUFTbEMsYUFBYTtnQkFDekQ7Z0JBRUFxQyxRQUFRQyxHQUFHLENBQUMsNkRBQW1EO29CQUM3RHpDLFlBQVlxRixlQUFlckYsVUFBVSxHQUFHLFlBQVk7b0JBQ3BEQyxXQUFXb0YsZUFBZXBGLFNBQVMsR0FBRyxZQUFZO29CQUNsREMsY0FBY21GLGVBQWVuRixZQUFZLEdBQUcsWUFBWTtvQkFDeERDLGVBQWVrRixlQUFlbEYsYUFBYSxHQUFHLFlBQVk7Z0JBQzVEO2dCQUVBLDhCQUE4QjtnQkFDOUJxQyxRQUFRQyxHQUFHLENBQUM7Z0JBQ1pWLGVBQWV1RCx5QkFBeUIsQ0FBQ0Q7Z0JBRXpDLGlFQUFpRTtnQkFFakU1RSxjQUFjYSxvQkFBb0IsQ0FBQ1k7Z0JBQ25DekIsY0FBY2MsZUFBZSxDQUFDO2dCQUM5QmYsVUFBVXNFLGtCQUFrQixDQUFDNUM7WUFDL0I7UUFDRixPQUFPLElBQUlDLFdBQVcsVUFBVTtZQUM5QkssUUFBUUYsS0FBSyxDQUFDLGlCQUFpQkE7WUFFL0IsSUFBSUksZUFBY0UsY0FBYyxHQUFHO2dCQUNqQzNJLHlDQUFLQSxDQUFDcUksS0FBSyxDQUFDLG1CQUFrQyxPQUFmTSxhQUFhLEdBQUU7WUFDaEQsT0FBTztnQkFDTDNJLHlDQUFLQSxDQUFDcUksS0FBSyxDQUFDO2dCQUNaUCxlQUFlNkMsZUFBZSxDQUFDO2dCQUMvQnhELGdCQUFnQk8sd0JBQXdCLENBQUM7Z0JBQ3pDbEIsY0FBY1UsdUJBQXVCO2dCQUNyQ1ksZUFBZW1CLHFCQUFxQixDQUFDO2dCQUNyQywwREFBMEQ7Z0JBQzFELDBDQUEwQztnQkFDMUN6QyxjQUFjYyxlQUFlLENBQUM7Z0JBQzlCZixVQUFVc0Usa0JBQWtCLENBQUM1QztZQUMvQjtZQUVBekIsY0FBY2Esb0JBQW9CLENBQUNZO1FBQ3JDLE9BQU8sSUFBSUMsV0FBVyxhQUFhO1lBQ2pDSyxRQUFRK0MsSUFBSSxDQUFDLDREQUE0RHJEO1lBRXpFLCtCQUErQjtZQUMvQixJQUFJMUIsVUFBVWdGLGFBQWEsQ0FBQ0MsT0FBTyxLQUFLdkQsUUFBUTtnQkFDOUMxQixVQUFVZ0YsYUFBYSxDQUFDQyxPQUFPLEdBQUc7WUFDcEM7WUFFQSw2Q0FBNkM7WUFDN0MsSUFBSWhGLGNBQWNpRixZQUFZLEtBQUt4RCxRQUFRO2dCQUN6Q3pCLGNBQWNjLGVBQWUsQ0FBQztnQkFDOUJRLGVBQWU2QyxlQUFlLENBQUM7Z0JBQy9CeEQsZ0JBQWdCTyx3QkFBd0IsQ0FBQztnQkFDekNJLGVBQWVtQixxQkFBcUIsQ0FBQztnQkFDckMsMERBQTBEO2dCQUMxRCwwQ0FBMEM7Z0JBQzFDekMsY0FBY1UsdUJBQXVCO1lBQ3ZDO1lBRUEsbUJBQW1CO1lBQ25CVixjQUFjYSxvQkFBb0IsQ0FBQ1k7WUFDbkMxQixVQUFVc0Usa0JBQWtCLENBQUM1QztRQUMvQjtJQUNGLEdBQUc7UUFBQ2hHO1FBQXVCa0Y7UUFBaUJXO1FBQWdCdEI7UUFBZUQ7UUFBV3RDO0tBQWdCO0lBRXRHLHNDQUFzQztJQUN0Q3BFLGdEQUFTQSxDQUFDO1FBQ1IwRyxVQUFVbUYsbUJBQW1CLENBQUMzRDtJQUNoQyxHQUFHO1FBQUN4QjtRQUFXd0I7S0FBZ0I7SUFFL0Isc0RBQXNEO0lBQ3RELE1BQU00RCxvQkFBb0I1TCw2Q0FBTUEsQ0FBQztJQUVqQyxvRUFBb0U7SUFDcEVGLGdEQUFTQSxDQUFDO1FBQ1IsSUFBSSxDQUFDMEcsVUFBVXFGLGlCQUFpQixJQUMzQjlELENBQUFBLGVBQWUrRCxZQUFZLElBQUkxRSxnQkFBZ0J1RCxxQkFBcUIsS0FDckVuRSxVQUFVZ0YsYUFBYSxDQUFDQyxPQUFPLEVBQUU7WUFFbkMsbUVBQW1FO1lBQ25FLElBQUloRixjQUFjc0YsbUJBQW1CLEVBQUU7Z0JBQ3JDLE1BQU1DLFNBQVNwQyxLQUFLQyxHQUFHLEtBQUtwRCxjQUFjc0YsbUJBQW1CO2dCQUM3RCxJQUFJQyxTQUFTLElBQUksS0FBSyxNQUFNO29CQUMxQixJQUFJLENBQUNKLGtCQUFrQkgsT0FBTyxFQUFFO3dCQUM5QmpELFFBQVFDLEdBQUcsQ0FBQzt3QkFDWm1ELGtCQUFrQkgsT0FBTyxHQUFHO3dCQUU1QixxQkFBcUI7d0JBQ3JCLE1BQU1RLFFBQVF6RixVQUFVZ0YsYUFBYSxDQUFDQyxPQUFPO3dCQUM3QyxJQUFJUSxPQUFPOzRCQUNUekQsUUFBUUMsR0FBRyxDQUFDLHVDQUE2QndEOzRCQUV6QyxxREFBcUQ7NEJBQ3JELElBQUksQ0FBQ0EsTUFBTXRELFVBQVUsQ0FBQyxXQUFXO2dDQUMvQmxDLGNBQWNhLG9CQUFvQixDQUFDMkU7NEJBQ3JDOzRCQUVBLDBCQUEwQjs0QkFDMUJsRSxlQUFlNkMsZUFBZSxDQUFDOzRCQUMvQnhELGdCQUFnQk8sd0JBQXdCLENBQUM7NEJBQ3pDUCxnQkFBZ0JJLGNBQWMsQ0FBQzs0QkFDL0JKLGdCQUFnQkssYUFBYSxDQUFDLEVBQUU7NEJBQ2hDTCxnQkFBZ0JVLHVCQUF1QixDQUFDOzRCQUN4Q1YsZ0JBQWdCUyx1QkFBdUIsQ0FBQzs0QkFDeENwQixjQUFjYyxlQUFlLENBQUM7NEJBQzlCZCxjQUFjeUMscUJBQXFCLENBQUM7NEJBQ3BDLDBEQUEwRDs0QkFDaEUsMENBQTBDOzRCQUNwQ3pDLGNBQWNVLHVCQUF1Qjs0QkFFckMsdUJBQXVCOzRCQUN2QlgsVUFBVXNFLGtCQUFrQixDQUFDbUI7NEJBRTdCLG1CQUFtQjs0QkFDbkJoTSx5Q0FBS0EsQ0FBQ3FJLEtBQUssQ0FBQzt3QkFDZDtvQkFDRjtvQkFDQTtnQkFDRjtZQUNGO1lBRUFFLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU15RCxpQkFBaUJDLFdBQVc7Z0JBQ2hDM0YsVUFBVTRGLGdCQUFnQjtnQkFFMUIsaURBQWlEO2dCQUNqRCxNQUFNSCxRQUFRekYsVUFBVWdGLGFBQWEsQ0FBQ0MsT0FBTztnQkFDN0MsSUFBSVEsT0FBTztvQkFDVEUsV0FBVzt3QkFDVDNELFFBQVFDLEdBQUcsQ0FBQyx1REFBNkN3RDt3QkFDekR6RixVQUFVUSxjQUFjLENBQUNpRjtvQkFDM0IsR0FBRztnQkFDTDtZQUNGLEdBQUc7WUFFSCxPQUFPLElBQU1JLGFBQWFIO1FBQzVCO0lBQ0YsR0FBRztRQUFDMUY7UUFBV3VCLGVBQWUrRCxZQUFZO1FBQUUxRSxnQkFBZ0J1RCxxQkFBcUI7UUFBRWxFLGNBQWNzRixtQkFBbUI7S0FBQztJQUVySCw4Q0FBOEM7SUFDOUNqTSxnREFBU0EsQ0FBQztRQUNSLElBQUlpSSxlQUFlK0QsWUFBWSxJQUFJMUUsZ0JBQWdCdUQscUJBQXFCLEVBQUU7WUFDeEVpQixrQkFBa0JILE9BQU8sR0FBRztRQUM5QjtJQUNGLEdBQUc7UUFBQzFELGVBQWUrRCxZQUFZO1FBQUUxRSxnQkFBZ0J1RCxxQkFBcUI7S0FBQztJQUV2RSxnQ0FBZ0M7SUFDaEM3SyxnREFBU0EsQ0FBQztRQUNSLElBQUksQ0FBQ2lJLGVBQWUrRCxZQUFZLElBQUkxRSxnQkFBZ0J1RCxxQkFBcUIsS0FDckVuRSxVQUFVZ0YsYUFBYSxDQUFDQyxPQUFPLEVBQUU7WUFDbkMsTUFBTWEsZ0JBQWdCQyxZQUFZO2dCQUNoQyxNQUFNQyxzQkFBc0I1QyxLQUFLQyxHQUFHLEtBQUtyRCxVQUFVaUcsZ0JBQWdCLENBQUNoQixPQUFPO2dCQUMzRSxNQUFNUSxRQUFRekYsVUFBVWdGLGFBQWEsQ0FBQ0MsT0FBTztnQkFFN0MsaURBQWlEO2dCQUNqRCxJQUFJaEYsY0FBY2lHLGtCQUFrQixJQUFJLE1BQU1GLHNCQUFzQixNQUFNO29CQUN4RWhFLFFBQVErQyxJQUFJLENBQUMscUJBQWlFOUUsT0FBNUNrRyxLQUFLQyxLQUFLLENBQUNKLHNCQUFvQixPQUFNLFNBQXdDLE9BQWpDL0YsY0FBY2lHLGtCQUFrQixFQUFDO29CQUUvRyxJQUFJVCxPQUFPO3dCQUNULElBQUk7NEJBQ0YsTUFBTVksV0FBVyxNQUFNQyxNQUFNLG1CQUF5QixPQUFOYjs0QkFDaEQsSUFBSVksU0FBU0UsRUFBRSxFQUFFO2dDQUNmLE1BQU1DLFlBQVksTUFBTUgsU0FBU0ksSUFBSTtnQ0FDckN6RSxRQUFRQyxHQUFHLENBQUMseUNBQStCdUU7Z0NBRTNDLElBQUlBLFVBQVU3RSxNQUFNLEtBQUssZUFBZTZFLFVBQVUzRSxRQUFRLEVBQUU7b0NBQzFERyxRQUFRQyxHQUFHLENBQUM7b0NBQ1pULGdCQUFnQjt3Q0FDZEUsUUFBUStEO3dDQUNSOUQsUUFBUTt3Q0FDUkMsVUFBVTt3Q0FDVkMsVUFBVTJFLFVBQVUzRSxRQUFRO29DQUM5QjtvQ0FDQSxRQUFRLDJCQUEyQjtnQ0FDckM7NEJBQ0Y7d0JBQ0YsRUFBRSxPQUFPQyxPQUFPOzRCQUNkRSxRQUFRRixLQUFLLENBQUMsK0JBQStCQTt3QkFDL0M7b0JBQ0Y7Z0JBQ0YsT0FFSyxJQUFJN0IsY0FBY2lHLGtCQUFrQixJQUFJLE1BQU1GLHNCQUFzQixPQUFPO29CQUM5RWhFLFFBQVErQyxJQUFJLENBQUMscUJBQWlFOUUsT0FBNUNrRyxLQUFLQyxLQUFLLENBQUNKLHNCQUFvQixPQUFNLFNBQXdDLE9BQWpDL0YsY0FBY2lHLGtCQUFrQixFQUFDO29CQUUvRyxJQUFJVCxPQUFPO3dCQUNULElBQUk7NEJBQ0YsTUFBTVksV0FBVyxNQUFNQyxNQUFNLG1CQUF5QixPQUFOYjs0QkFDaEQsSUFBSVksU0FBU0UsRUFBRSxFQUFFO2dDQUNmLE1BQU1DLFlBQVksTUFBTUgsU0FBU0ksSUFBSTtnQ0FDckN6RSxRQUFRQyxHQUFHLENBQUMseUNBQStCdUU7Z0NBRTNDLElBQUlBLFVBQVU3RSxNQUFNLEtBQUssZUFBZTZFLFVBQVUzRSxRQUFRLEVBQUU7b0NBQzFERyxRQUFRQyxHQUFHLENBQUM7b0NBQ1pULGdCQUFnQjt3Q0FDZEUsUUFBUStEO3dDQUNSOUQsUUFBUTt3Q0FDUkMsVUFBVTt3Q0FDVkMsVUFBVTJFLFVBQVUzRSxRQUFRO29DQUM5QjtvQ0FDQSxRQUFRLDJCQUEyQjtnQ0FDckM7NEJBQ0Y7d0JBQ0YsRUFBRSxPQUFPQyxPQUFPOzRCQUNkRSxRQUFRRixLQUFLLENBQUMsK0JBQStCQTt3QkFDL0M7b0JBQ0Y7Z0JBQ0Y7Z0JBRUEsOEJBQThCO2dCQUM5QixJQUFJa0Usc0JBQXNCLE9BQU87b0JBQy9CaEUsUUFBUStDLElBQUksQ0FBQztvQkFFYixJQUFJLENBQUMvRSxVQUFVcUYsaUJBQWlCLEVBQUU7d0JBQ2hDckQsUUFBUUMsR0FBRyxDQUFDO3dCQUNaakMsVUFBVTRGLGdCQUFnQjtvQkFDNUIsT0FBTyxJQUFJSCxPQUFPO3dCQUNoQnpELFFBQVFDLEdBQUcsQ0FBQyw0REFBa0R3RDt3QkFDOUR6RixVQUFVUSxjQUFjLENBQUNpRjtvQkFDM0I7b0JBRUEsa0JBQWtCO29CQUNsQnpGLFVBQVVpRyxnQkFBZ0IsQ0FBQ2hCLE9BQU8sR0FBRzdCLEtBQUtDLEdBQUc7Z0JBQy9DO1lBQ0YsR0FBRyxPQUFPLDhEQUE4RDtZQUV4RSxPQUFPLElBQU1xRCxjQUFjWjtRQUM3QjtJQUNGLEdBQUc7UUFBQ3ZFLGVBQWUrRCxZQUFZO1FBQUUxRSxnQkFBZ0J1RCxxQkFBcUI7UUFDbEVuRTtRQUFXQyxjQUFjaUcsa0JBQWtCO1FBQUUxRTtLQUFnQjtJQUVqRSx1REFBdUQ7SUFDdkQsTUFBTW1GLG1CQUFtQnBOLGtEQUFXQSxDQUFDO1lBaUJYcU47UUFoQnhCNUUsUUFBUUMsR0FBRyxDQUFDO1FBQ1p0RSxtQkFBbUI7UUFFbkIsZ0NBQWdDO1FBQ2hDLE1BQU1pSixXQUFXcE0seURBQU9BLENBQUNxTSxXQUFXO1FBRXBDLElBQUksQ0FBQ0QsVUFBVTtZQUNiNUUsUUFBUUMsR0FBRyxDQUFDO1lBQ1p0RSxtQkFBbUI7WUFDbkI7UUFDRjtRQUVBcUUsUUFBUUMsR0FBRyxDQUFDLHFDQUEyQjJFO1FBRXZDLG1FQUFtRTtRQUNuRSwwREFBMEQ7UUFDMUQsTUFBTUUsbUJBQWtCRixrQkFBQUEsU0FBU25CLEtBQUssY0FBZG1CLHNDQUFBQSxnQkFBZ0J6RSxVQUFVLENBQUM7UUFFbkQsSUFBSTJFLGlCQUFpQjtZQUNuQjlFLFFBQVFDLEdBQUcsQ0FBQztZQUNaLHVEQUF1RDtZQUN2RCxpREFBaUQ7WUFDakR0RSxtQkFBbUI7WUFDbkI7UUFDRjtRQUVBLGtEQUFrRDtRQUNsRCxJQUFJb0osVUFBVWhFLE1BQU0sR0FBRyxHQUFHO1lBQ3hCZixRQUFRQyxHQUFHLENBQUMsc0JBQTZCLE9BQWpCOEUsVUFBVWhFLE1BQU0sRUFBQztZQUV6Qyw4Q0FBOEM7WUFDOUMsTUFBTWlFLGdCQUEwQyxJQUFJQyxNQUFNLEdBQUdDLElBQUksQ0FBQztZQUVsRSxLQUFLLE1BQU0sRUFBRUMsR0FBRyxFQUFFLElBQUlKLFVBQVc7Z0JBQy9CLElBQUlJLElBQUlyRCxVQUFVLElBQUltRCxNQUFNRyxPQUFPLENBQUNELElBQUlyRCxVQUFVLEtBQUtxRCxJQUFJckQsVUFBVSxDQUFDZixNQUFNLEdBQUcsR0FBRztvQkFDaEYsTUFBTUcsWUFBWWlFLElBQUlyRCxVQUFVLENBQUMsRUFBRSxFQUFFLDRCQUE0QjtvQkFDakUsTUFBTTFCLGFBQWErRSxJQUFJL0UsVUFBVTtvQkFFakMsSUFBSUEsY0FBYyxLQUFLQSxhQUFhLEdBQUc7d0JBQ3JDNEUsYUFBYSxDQUFDNUUsV0FBVyxHQUFHYztvQkFDOUI7Z0JBQ0Y7WUFDRjtZQUVBLG1DQUFtQztZQUNuQyxNQUFNbUUsZ0JBQWdCTCxjQUFjaEQsTUFBTSxDQUFDQztZQUUzQyxrQ0FBa0M7WUFDbEMsSUFBSW9ELGNBQWN0RSxNQUFNLEdBQUcsR0FBRztnQkFDNUJmLFFBQVFDLEdBQUcsQ0FBQywwQkFBeUQ4RSxPQUF6Q00sY0FBY3RFLE1BQU0sRUFBQyxzQkFBcUMsT0FBakJnRSxVQUFVaEUsTUFBTSxFQUFDO2dCQUN0RixnREFBZ0Q7Z0JBQ2hEZixRQUFRQyxHQUFHLENBQUM7Z0JBQ1pyQixnQkFBZ0JJLGNBQWMsQ0FBQztnQkFFL0Isc0VBQXNFO2dCQUN0RUosZ0JBQWdCSyxhQUFhLENBQUMrRjtnQkFDOUJwRyxnQkFBZ0JVLHVCQUF1QixDQUFDK0YsY0FBY3RFLE1BQU07Z0JBRTVELGlDQUFpQztnQkFDakMsSUFBSXNFLGNBQWN0RSxNQUFNLEtBQUssR0FBRztvQkFDOUJuQyxnQkFBZ0JTLHVCQUF1QixDQUFDO29CQUN4Q1QsZ0JBQWdCd0QsZUFBZSxDQUFDO29CQUNoQzdDLGVBQWU2QyxlQUFlLENBQUM7b0JBQy9CeEQsZ0JBQWdCOEIscUJBQXFCLENBQUM7b0JBQ3RDbkIsZUFBZW1CLHFCQUFxQixDQUFDO2dCQUNyQyw0Q0FBNEM7Z0JBQzlDLE9BQU87b0JBQ0w5QixnQkFBZ0J3RCxlQUFlLENBQUM7b0JBQ2hDN0MsZUFBZTZDLGVBQWUsQ0FBQztvQkFDL0IsTUFBTUYsY0FBYyxLQUFrRW1ELE9BQTdEQSxjQUFjdEUsTUFBTSxFQUFDLDBDQUE4RyxPQUF0RXNFLGNBQWN0RSxNQUFNLElBQUksSUFBSSx1Q0FBdUM7b0JBQ3pKbkMsZ0JBQWdCOEIscUJBQXFCLENBQUN3QjtvQkFDdEMzQyxlQUFlbUIscUJBQXFCLENBQUN3QjtnQkFDckMscUNBQXFDO2dCQUN2QztZQUNGO1lBRUEsNkVBQTZFO1lBQzdFLElBQUltRCxjQUFjdEUsTUFBTSxLQUFLLEtBQUtnRSxVQUFVaEUsTUFBTSxHQUFHLEdBQUc7Z0JBQ3REZixRQUFRQyxHQUFHLENBQUM7Z0JBQ1osdUVBQXVFO2dCQUN2RXJCLGdCQUFnQkksY0FBYyxDQUFDO2dCQUMvQkosZ0JBQWdCSyxhQUFhLENBQUM7b0JBQUM7b0JBQU07b0JBQU07b0JBQU07b0JBQU07aUJBQUs7Z0JBQzVETCxnQkFBZ0J3RCxlQUFlLENBQUM7Z0JBQ2hDN0MsZUFBZTZDLGVBQWUsQ0FBQztnQkFDL0J4RCxnQkFBZ0I4QixxQkFBcUIsQ0FBQztnQkFDdENuQixlQUFlbUIscUJBQXFCLENBQUM7WUFDckMsMERBQTBEO1lBQzFELDBDQUEwQztZQUM1QztZQUVBLHdDQUF3QztZQUN4QyxLQUFLLE1BQU0sRUFBRStDLEtBQUssRUFBRTBCLEdBQUcsRUFBRSxJQUFJSixVQUFXO2dCQUN0QyxNQUFNdkIsU0FBU3BDLEtBQUtDLEdBQUcsS0FBTThELENBQUFBLElBQUkzRCxTQUFTLElBQUlKLEtBQUtDLEdBQUcsRUFBQztnQkFDdkQsTUFBTWlFLFVBQVU5QixTQUFTLElBQUksS0FBSztnQkFFbEMsSUFBSSxDQUFDOEIsU0FBUzt3QkFDOENIO29CQUExRG5GLFFBQVFDLEdBQUcsQ0FBQywwQ0FBOENrRixPQUFkMUIsT0FBTSxVQUFvQyxPQUE1QjBCLEVBQUFBLGtCQUFBQSxJQUFJckQsVUFBVSxjQUFkcUQsc0NBQUFBLGdCQUFnQnBFLE1BQU0sS0FBSSxHQUFFO29CQUN0Ri9DLFVBQVVRLGNBQWMsQ0FBQ2lGO2dCQUMzQjtZQUNGO1FBQ0Y7UUFFQSxpREFBaUQ7UUFDakQsS0FBSyxNQUFNLEVBQUVBLEtBQUssRUFBRTBCLEdBQUcsRUFBRSxJQUFJSSxVQUFXO1lBQ3RDdkYsUUFBUUMsR0FBRyxDQUFDLCtCQUEyQixPQUFOd0QsT0FBTSxNQUFJO2dCQUN6QytCLFNBQVMvQixNQUFNdEQsVUFBVSxDQUFDO2dCQUMxQlIsUUFBUXdGLElBQUl4RixNQUFNO2dCQUNsQjhGLGFBQWEsQ0FBQyxDQUFDTixJQUFJTyxZQUFZO2dCQUMvQmxFLFdBQVcyRCxJQUFJM0QsU0FBUztZQUMxQjtZQUNBLGtFQUFrRTtZQUNsRSxNQUFNZ0MsU0FBU3BDLEtBQUtDLEdBQUcsS0FBTThELENBQUFBLElBQUkzRCxTQUFTLElBQUlKLEtBQUtDLEdBQUcsRUFBQztZQUN2RCxNQUFNaUUsVUFBVTlCLFNBQVMsSUFBSSxLQUFLLFFBQVEyQixJQUFJeEYsTUFBTSxLQUFLO1lBRXpELElBQUkyRixTQUFTO2dCQUNYdEYsUUFBUUMsR0FBRyxDQUFDLHVDQUE0Q2tFLE9BQWZWLE9BQU0sV0FBbUMsT0FBMUJVLEtBQUtDLEtBQUssQ0FBQ1osU0FBUyxPQUFNO2dCQUNsRnZGLGNBQWNhLG9CQUFvQixDQUFDMkU7Z0JBQ25DO1lBQ0Y7WUFFQSw2QkFBNkI7WUFDN0IsNkRBQTZEO1lBQzdELHdDQUF3QztZQUN4QywyREFBMkQ7WUFDM0QsNERBQTREO1lBQzVELDZEQUE2RDtZQUM3RCxJQUFJO1lBRUoseURBQXlEO1lBQ3pELDhFQUE4RTtZQUM5RSxJQUFJMEIsSUFBSVEsZ0JBQWdCLElBQUlSLElBQUl4RixNQUFNLEtBQUssYUFBYTtnQkFDdEQxQixjQUFjeUMscUJBQXFCLENBQUN5RSxJQUFJUSxnQkFBZ0I7Z0JBQ3hEcEcsZUFBZW1CLHFCQUFxQixDQUFDeUUsSUFBSVEsZ0JBQWdCO2dCQUN6RC9HLGdCQUFnQjhCLHFCQUFxQixDQUFDeUUsSUFBSVEsZ0JBQWdCO1lBQzVEO1lBRUEsc0NBQXNDO1lBQ3RDcEcsZUFBZTZDLGVBQWUsQ0FBQztZQUMvQnhELGdCQUFnQk8sd0JBQXdCLENBQUM7WUFFekMsMENBQTBDO1lBQzFDLElBQUlnRyxJQUFJUyxrQkFBa0IsS0FBS2hGLFdBQVc7Z0JBQ3hDaEMsZ0JBQWdCTSxxQkFBcUIsQ0FBQ2lHLElBQUlTLGtCQUFrQjtZQUM5RDtZQUVBM0gsY0FBY2MsZUFBZSxDQUFDMEU7WUFFOUIsMkNBQTJDO1lBQzNDLE1BQU1vQyxlQUFlVixJQUFJM0QsU0FBUyxJQUFJSixLQUFLQyxHQUFHO1lBQzlDLE1BQU15RSxvQkFBb0IsQ0FBQzFFLEtBQUtDLEdBQUcsS0FBS3dFLFlBQVcsSUFBSztZQUV4RCw4QkFBOEI7WUFDOUI1SCxjQUFjUyx3QkFBd0I7WUFFdEMsK0JBQStCO1lBQy9CVixVQUFVUSxjQUFjLENBQUNpRjtZQUV6QiwrQkFBK0I7WUFDL0IsSUFBSTtnQkFDRixNQUFNWSxXQUFXLE1BQU1DLE1BQU0sR0FBMENiLE9BQXZDc0Msc0JBQXFCLG9CQUF3QixPQUFOdEM7Z0JBQ3ZFLE1BQU11QyxTQUFTLE1BQU0zQixTQUFTSSxJQUFJO2dCQUVsQ3pFLFFBQVFDLEdBQUcsQ0FBQyxxQ0FBaUMsT0FBTndELE9BQU0sTUFBSTtvQkFDL0NjLElBQUlGLFNBQVNFLEVBQUU7b0JBQ2Y1RSxRQUFRMEUsU0FBUzFFLE1BQU07b0JBQ3ZCc0csY0FBY0QsT0FBT3JHLE1BQU07b0JBQzNCdUcsS0FBSyxHQUEwQ3pDLE9BQXZDc0Msc0JBQXFCLG9CQUF3QixPQUFOdEM7Z0JBQ2pEO2dCQUVBLElBQUl1QyxPQUFPckcsTUFBTSxLQUFLLGFBQWE7b0JBQ2pDLHlEQUF5RDtvQkFDekRLLFFBQVFDLEdBQUcsQ0FBQyxVQUFnQixPQUFOd0QsT0FBTTtvQkFDNUJ4RixjQUFjYSxvQkFBb0IsQ0FBQzJFO29CQUVuQyx5QkFBeUI7b0JBQ3pCLElBQUl2RCxZQUFZO3dCQUNkdEIsZ0JBQWdCd0QsZUFBZSxDQUFDO29CQUNsQyxPQUFPO3dCQUNMN0MsZUFBZTZDLGVBQWUsQ0FBQzt3QkFDL0J4RCxnQkFBZ0JPLHdCQUF3QixDQUFDO29CQUMzQztvQkFFQSwrQkFBK0I7b0JBQy9CMUgseUNBQUtBLENBQUNxSSxLQUFLLENBQ1QsWUFBMEMsT0FBOUJJLGFBQWEsVUFBVSxRQUFPLGlEQUMxQzt3QkFBRWlHLFVBQVU7b0JBQUs7b0JBRW5CO2dCQUNGLE9BQU87b0JBQ0wsb0NBQW9DO29CQUNwQzFPLHlDQUFLQSxDQUFDMk8sSUFBSSxDQUFDLFlBQTBDLE9BQTlCbEcsYUFBYSxVQUFVLFFBQU87Z0JBQ3ZEO1lBQ0YsRUFBRSxPQUFPSixPQUFPO2dCQUNkRSxRQUFRRixLQUFLLENBQUMsZ0NBQWdDQTtnQkFDOUMsNENBQTRDO2dCQUM1Q3JJLHlDQUFLQSxDQUFDMk8sSUFBSSxDQUFDLHdCQUFzRCxPQUE5QmxHLGFBQWEsVUFBVSxRQUFPO1lBQ25FO1FBQ0Y7UUFFQSxpRUFBaUU7UUFDakUsNERBQTREO1FBQzVEeUQsV0FBVztZQUNUM0QsUUFBUUMsR0FBRyxDQUFDO1lBQ1p0RSxtQkFBbUI7UUFDckIsR0FBRztJQUNMLEdBQUc7UUFBQ3NDO1FBQWVzQjtRQUFnQlg7UUFBaUJaO0tBQVU7SUFFOUQsd0NBQXdDO0lBQ3hDMUcsZ0RBQVNBLENBQUM7UUFDUjBJLFFBQVFDLEdBQUcsQ0FBQztRQUVaLGdDQUFnQztRQUNoQyxNQUFNMkUsV0FBV3BNLHlEQUFPQSxDQUFDcU0sV0FBVztRQUVwQyxJQUFJRCxVQUFVO1lBQ1o1RSxRQUFRQyxHQUFHLENBQUMsNkNBQW1DMkUsU0FBU25CLEtBQUs7WUFFN0QsNkNBQTZDO1lBQzdDeEYsY0FBY2MsZUFBZSxDQUFDNkYsU0FBU25CLEtBQUs7WUFDNUN6RixVQUFVUSxjQUFjLENBQUNvRyxTQUFTbkIsS0FBSztZQUV2Qyx1QkFBdUI7WUFDdkIsTUFBTStCLFVBQVVaLFNBQVNuQixLQUFLLENBQUN0RCxVQUFVLENBQUM7WUFDMUMsSUFBSXFGLFNBQVM7Z0JBQ1g1RyxnQkFBZ0JJLGNBQWMsQ0FBQztnQkFDL0JKLGdCQUFnQndELGVBQWUsQ0FBQztnQkFDaEM3QyxlQUFlNkMsZUFBZSxDQUFDO2dCQUMvQnhELGdCQUFnQjhCLHFCQUFxQixDQUFDO2dCQUN0Q25CLGVBQWVtQixxQkFBcUIsQ0FBQztZQUN2QyxPQUFPO2dCQUNMbkIsZUFBZTZDLGVBQWUsQ0FBQztnQkFDL0I3QyxlQUFlbUIscUJBQXFCLENBQUM7WUFDdkM7WUFFQSw4QkFBOEI7WUFDOUJ6QyxjQUFjUyx3QkFBd0IsQ0FBQzhHLFVBQVUsVUFBVTtRQUM3RDtRQUVBLHNDQUFzQztRQUN0QzdKLG1CQUFtQjtRQUVuQixtREFBbUQ7UUFDbkRnSSxXQUFXO1lBQ1RoSSxtQkFBbUI7UUFDckIsR0FBRztJQUNMLEdBQUcsRUFBRTtJQUVMLHVEQUF1RDtJQUN2RCxPQUFPO1FBQ0wsYUFBYTtRQUNiakQ7UUFDQUM7UUFDQTJGLGtCQUFrQkgsa0JBQWtCRyxnQkFBZ0I7UUFDcEQrSCxxQkFBcUJsSSxrQkFBa0JrSSxtQkFBbUI7UUFDMUR6TjtRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBK0osY0FBYy9ELGVBQWUrRCxZQUFZLElBQUkxRSxnQkFBZ0IwRSxZQUFZO1FBQ3pFbEIsaUJBQWlCN0MsZUFBZTZDLGVBQWU7UUFDL0NrRSxxQkFBcUJuSSxrQkFBa0JtSSxtQkFBbUI7UUFDMURDLHdCQUF3QnBJLGtCQUFrQm9JLHNCQUFzQjtRQUNoRUMsZUFBZWpILGVBQWVpSCxhQUFhO1FBQzNDQyxrQkFBa0JsSCxlQUFla0gsZ0JBQWdCO1FBQ2pEbk07UUFDQUM7UUFDQW1NLGdCQUFnQm5ILGVBQWVtSCxjQUFjO1FBQzdDQyxtQkFBbUJwSCxlQUFlb0gsaUJBQWlCO1FBQ25EQyxtQkFBbUJySCxlQUFlcUgsaUJBQWlCO1FBQ25EQyxzQkFBc0J0SCxlQUFlc0gsb0JBQW9CO1FBRXpELG1CQUFtQjtRQUNuQnJOO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBRUEsYUFBYTtRQUNidUcsYUFBYTVCLGdCQUFnQjRCLFdBQVc7UUFDeEN4QixnQkFBZ0JKLGdCQUFnQkksY0FBYztRQUM5QzhDLFlBQVlsRCxnQkFBZ0JrRCxVQUFVO1FBQ3RDN0MsZUFBZUwsZ0JBQWdCSyxhQUFhO1FBQzVDMkcsb0JBQW9CaEgsZ0JBQWdCZ0gsa0JBQWtCO1FBQ3REMUcsdUJBQXVCTixnQkFBZ0JNLHFCQUFxQjtRQUM1RGlELHVCQUF1QnZELGdCQUFnQnVELHFCQUFxQjtRQUM1RGhELDBCQUEwQlAsZ0JBQWdCTyx3QkFBd0I7UUFDbEUySCxzQkFBc0JsSSxnQkFBZ0JrSSxvQkFBb0I7UUFDMUQxSCx5QkFBeUJSLGdCQUFnQlEsdUJBQXVCO1FBQ2hFMkgsc0JBQXNCbkksZ0JBQWdCbUksb0JBQW9CO1FBQzFEMUgseUJBQXlCVCxnQkFBZ0JTLHVCQUF1QjtRQUNoRTJILHNCQUFzQnBJLGdCQUFnQm9JLG9CQUFvQjtRQUMxRDFILHlCQUF5QlYsZ0JBQWdCVSx1QkFBdUI7UUFFaEUsb0JBQW9CO1FBQ3BCMkgsb0JBQW9CckksZ0JBQWdCMEUsWUFBWSxHQUFHMUUsZ0JBQWdCcUksa0JBQWtCLEdBQUcxSCxlQUFlMEgsa0JBQWtCO1FBQ3pIdkcsdUJBQXVCbkIsZUFBZW1CLHFCQUFxQjtRQUMzRHdELG9CQUFvQmpHLGNBQWNpRyxrQkFBa0I7UUFDcERnRCxpQkFBaUIzSCxlQUFlMkgsZUFBZTtRQUMvQ0Msb0JBQW9CNUgsZUFBZTRILGtCQUFrQjtRQUVyRCw2QkFBNkI7UUFDN0JDLGlCQUFpQmxKLGFBQWFrSixlQUFlO1FBQzdDQyxvQkFBb0JuSixhQUFhbUosa0JBQWtCO1FBQ25Eakssb0JBQW9CYyxhQUFhZCxrQkFBa0I7UUFDbkRrSyx1QkFBdUJwSixhQUFhb0oscUJBQXFCO1FBQ3pEQyxxQkFBcUJySixhQUFhcUosbUJBQW1CO1FBQ3JEQyx3QkFBd0J0SixhQUFhc0osc0JBQXNCO1FBQzNEQyxhQUFhdkosYUFBYXVKLFdBQVc7UUFDckNDLGdCQUFnQnhKLGFBQWF3SixjQUFjO1FBRTNDLHFCQUFxQjtRQUNyQnROO1FBQ0FDO1FBQ0FHO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBQ0FDO1FBRUEsV0FBVztRQUNYQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUNBQztRQUVBLGtCQUFrQjtRQUNsQm9NLG9CQUFvQnBJLGVBQWVvSSxrQkFBa0I7UUFDckRDLHVCQUF1QnJJLGVBQWVxSSxxQkFBcUI7UUFDM0RDLG9CQUFvQjVKLGNBQWM0SixrQkFBa0I7UUFDcERDLHVCQUF1QjdKLGNBQWM2SixxQkFBcUI7UUFFMUQsbUJBQW1CO1FBQ25CM1Asb0JBQW9CQSx5RUFBQUE7UUFDcEJDLGVBQWVBLG9FQUFBQTtRQUNmQyxpQkFBaUJBLGtFQUFBQTtRQUNqQkMsVUFBVUEsMkRBQUFBO1FBQ1ZDLG1CQUFtQkEsb0VBQUFBO1FBRW5CLDBCQUEwQjtRQUMxQm1HLDBCQUEwQlQsY0FBY1Msd0JBQXdCO1FBQ2hFQyx5QkFBeUJWLGNBQWNVLHVCQUF1QjtRQUU5RCwwQkFBMEI7UUFDMUJvSixrQkFBa0I3SixhQUFhNkosZ0JBQWdCO1FBQy9DQyw0QkFBNEI5SixhQUFhOEosMEJBQTBCO1FBRW5FLDhCQUE4QjtRQUM5QjVKLGlCQUFpQkYsYUFBYUUsZUFBZTtRQUM3QzZKLG9CQUFvQi9KLGFBQWErSixrQkFBa0I7UUFDbkRDLHdCQUF3QmhLLGFBQWFnSyxzQkFBc0I7UUFFM0Qsb0JBQW9CO1FBQ3BCQyxzQkFBc0JoSyxrQkFBa0JnSyxvQkFBb0I7UUFDNURDLHFCQUFxQmpLLGtCQUFrQmlLLG1CQUFtQjtRQUMxREMsYUFBYWxLLGtCQUFrQmtLLFdBQVc7UUFDMUNDLGFBQWFuSyxrQkFBa0JtSyxXQUFXO1FBRTFDLGlCQUFpQjtRQUNqQi9KLGtCQUFrQk4sY0FBY00sZ0JBQWdCO1FBQ2hETyxzQkFBc0JiLGNBQWNhLG9CQUFvQjtRQUN4RDZGO1FBQ0FqSjtRQUVBLDRCQUE0QjtRQUM1QjZNLHlCQUF5QmhKLGVBQWVnSix1QkFBdUI7UUFDL0RDLDBCQUEwQjVKLGdCQUFnQjRKLHdCQUF3QjtRQUNsRUMsOEJBQThCN0osZ0JBQWdCNkosNEJBQTRCO1FBRTFFLDBDQUEwQztRQUMxQ0MsZ0JBQWdCdkssa0JBQWtCdUssY0FBYztRQUNoREMsbUJBQW1CeEssa0JBQWtCd0ssaUJBQWlCO1FBQ3REQyxxQkFBcUJ6SyxrQkFBa0J5SyxtQkFBbUI7UUFDMURDLHdCQUF3QjFLLGtCQUFrQjBLLHNCQUFzQjtRQUNoRUMsa0JBQWtCM0ssa0JBQWtCMkssZ0JBQWdCO1FBQ3BEQyxxQkFBcUI1SyxrQkFBa0I0SyxtQkFBbUI7UUFDMURDLG1CQUFtQjdLLGtCQUFrQjZLLGlCQUFpQjtRQUN0REMsc0JBQXNCOUssa0JBQWtCOEssb0JBQW9CO1FBQzVEQyxtQkFBbUIvSyxrQkFBa0IrSyxpQkFBaUI7UUFDdERDLHNCQUFzQmhMLGtCQUFrQmdMLG9CQUFvQjtRQUU1RCxpQkFBaUI7UUFDakIzTjtRQUNBQztRQUNBRztRQUNBQztRQUNBaUI7UUFDQUM7UUFDQWY7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFFQSxjQUFjO1FBQ2RDO1FBQ0FDO1FBRUEsOEJBQThCO1FBQzlCdU0sbUJBQW1CbEwsYUFBYWtMLGlCQUFpQjtRQUNqREMsc0JBQXNCbkwsYUFBYW1MLG9CQUFvQjtRQUN2REMsc0JBQXNCcEwsYUFBYW9MLG9CQUFvQjtRQUN2REMseUJBQXlCckwsYUFBYXFMLHVCQUF1QjtRQUc3RCxlQUFlO1FBQ2ZyRyxjQUFjakYsY0FBY2lGLFlBQVk7UUFDeENuRSxpQkFBaUJkLGNBQWNjLGVBQWU7UUFDOUNuQjtRQUNBQztRQUNBQztRQUNBQztRQUVBLHlCQUF5QjtRQUN6QlQ7UUFDQUM7UUFFQSxvQkFBb0I7UUFDcEJyRDtRQUNBQztRQUVBLHNCQUFzQjtRQUN0QnFQLGVBQWVqSyxlQUFlaUssYUFBYTtRQUMzQ0Msa0JBQWtCbEssZUFBZWtLLGdCQUFnQjtRQUNqRDNOO1FBQ0FDO1FBRUEsd0JBQXdCO1FBQ3hCd0gscUJBQXFCdEYsY0FBY3NGLG1CQUFtQjtRQUN0RG1HLHdCQUF3QnpMLGNBQWN5TCxzQkFBc0I7UUFDNURDLHFCQUFxQjFMLGNBQWMwTCxtQkFBbUI7UUFDdERDLHdCQUF3QjNMLGNBQWMyTCxzQkFBc0I7UUFFNUQsbUJBQW1CO1FBQ25CNVIsU0FBU0EsOERBQUFBO1FBQ1RDLGNBQWNBLG1FQUFBQTtRQUNkQyxVQUFVQSwrREFBQUE7UUFFVixnQ0FBZ0M7UUFDaENtTCxtQkFBbUJyRixVQUFVcUYsaUJBQWlCO1FBQzlDTyxrQkFBa0I1RixVQUFVNEYsZ0JBQWdCO1FBQzVDaUcscUJBQXFCN0wsVUFBVTZMLG1CQUFtQjtRQUNsRHJMLGdCQUFnQlIsVUFBVVEsY0FBYztRQUN4QzhELG9CQUFvQnRFLFVBQVVzRSxrQkFBa0I7UUFDaEQ5QztRQUNBc0QsMkJBQTJCdkQsZUFBZXVELHlCQUF5QjtJQUNyRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2hvb2tzL3VzZUNhcmRTdHVkaW9SZWZhY3RvcmVkLnRzPzljYzkiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrLCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHRvYXN0IH0gZnJvbSBcInNvbm5lclwiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5cbi8vIEltcG9ydCBtb2R1bGFyIGhvb2tzXG5pbXBvcnQgeyB1c2VXZWJTb2NrZXQgfSBmcm9tICcuL2NhcmRTdHVkaW8vdXNlV2ViU29ja2V0JztcbmltcG9ydCB7IHVzZUpvYk1hbmFnZW1lbnQgfSBmcm9tICcuL2NhcmRTdHVkaW8vdXNlSm9iTWFuYWdlbWVudFNpbXBsaWZpZWQnO1xuaW1wb3J0IHsgdXNlTWVzc2FnZUdlbmVyYXRpb24gfSBmcm9tICcuL2NhcmRTdHVkaW8vdXNlTWVzc2FnZUdlbmVyYXRpb24nO1xuaW1wb3J0IHsgdXNlRmlsZUhhbmRsaW5nIH0gZnJvbSAnLi9jYXJkU3R1ZGlvL3VzZUZpbGVIYW5kbGluZyc7XG5pbXBvcnQgeyB1c2VEcmFmdEdlbmVyYXRpb24gfSBmcm9tICcuL2NhcmRTdHVkaW8vdXNlRHJhZnRHZW5lcmF0aW9uJztcbmltcG9ydCB7IHVzZUNhcmRHZW5lcmF0aW9uIH0gZnJvbSAnLi9jYXJkU3R1ZGlvL3VzZUNhcmRHZW5lcmF0aW9uJztcblxuLy8gSW1wb3J0IGNvbnN0YW50cyBhbmQgdXRpbHNcbmltcG9ydCB7IFxuICBjYXJkVG9uZXMsIFxuICBhcnRpc3RpY1N0eWxlcywgXG4gIHBhcGVyU2l6ZXMsIFxuICBmb3JtYXRHZW5lcmF0aW9uVGltZSwgXG4gIGZvcm1hdENvdW50ZG93bixcbiAgR2VuZXJhdGVkQ2FyZCBcbn0gZnJvbSAnLi9jYXJkU3R1ZGlvL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBzZW5kVGhhbmtZb3VFbWFpbCwgY2hhdFdpdGhBSSwgc2Nyb2xsVG9DYXJkUHJldmlldyB9IGZyb20gJy4vY2FyZFN0dWRpby91dGlscyc7XG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnQC9saWIvc3RvcmFnZU1hbmFnZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FyZFN0dWRpbygpIHtcbiAgLy8gQ29yZSBmb3JtIHN0YXRlXG4gIGNvbnN0IFtwcm9tcHQsIHNldFByb21wdF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW3RvRmllbGQsIHNldFRvRmllbGRdID0gdXNlU3RhdGUoXCJcIik7XG4gIGNvbnN0IFtmcm9tRmllbGQsIHNldEZyb21GaWVsZF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW3JlbGF0aW9uc2hpcEZpZWxkLCBzZXRSZWxhdGlvbnNoaXBGaWVsZF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW3NlbGVjdGVkVHlwZSwgc2V0U2VsZWN0ZWRUeXBlXSA9IHVzZVN0YXRlPHN0cmluZz4oXCJiaXJ0aGRheVwiKTtcbiAgY29uc3QgW2N1c3RvbUNhcmRUeXBlLCBzZXRDdXN0b21DYXJkVHlwZV0gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiXCIpO1xuICBjb25zdCBbc2VsZWN0ZWRUb25lLCBzZXRTZWxlY3RlZFRvbmVdID0gdXNlU3RhdGU8c3RyaW5nPihcImZ1bm55XCIpO1xuICBcbiAgLy8gQWR2YW5jZWQgb3B0aW9ucyBzdGF0ZVxuICBjb25zdCBbc2hvd0FkdmFuY2VkLCBzZXRTaG93QWR2YW5jZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2VsZWN0ZWRBcnRpc3RpY1N0eWxlLCBzZXRTZWxlY3RlZEFydGlzdGljU3R5bGVdID0gdXNlU3RhdGU8c3RyaW5nPihcIndhdGVyY29sb3JcIik7XG4gIGNvbnN0IFtjdXN0b21TdHlsZURlc2NyaXB0aW9uLCBzZXRDdXN0b21TdHlsZURlc2NyaXB0aW9uXSA9IHVzZVN0YXRlPHN0cmluZz4oXCJcIik7XG4gIGNvbnN0IFtzZWxlY3RlZEltYWdlTW9kZWwsIHNldFNlbGVjdGVkSW1hZ2VNb2RlbF0gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiZ3B0LWltYWdlLTFcIik7XG4gIGNvbnN0IFtzZWxlY3RlZERyYWZ0TW9kZWwsIHNldFNlbGVjdGVkRHJhZnRNb2RlbF0gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiZ3B0LWltYWdlLTFcIik7XG4gIGNvbnN0IFtmYXN0UHJldmlld01vZGUsIHNldEZhc3RQcmV2aWV3TW9kZV0gPSB1c2VTdGF0ZTxib29sZWFuPih0cnVlKTtcbiAgXG4gIC8vIEVtYWlsIHN0YXRlXG4gIGNvbnN0IFt1c2VyRW1haWwsIHNldFVzZXJFbWFpbF0gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiXCIpO1xuICBcbiAgLy8gQ2FyZCBvcHRpb25zXG4gIGNvbnN0IFtudW1iZXJPZkNhcmRzLCBzZXROdW1iZXJPZkNhcmRzXSA9IHVzZVN0YXRlPG51bWJlcj4oMSk7XG4gIGNvbnN0IFtpc0hhbmR3cml0dGVuTWVzc2FnZSwgc2V0SXNIYW5kd3JpdHRlbk1lc3NhZ2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNGcm9udEJhY2tPbmx5LCBzZXRJc0Zyb250QmFja09ubHldID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2VsZWN0ZWRQYXBlclNpemUsIHNldFNlbGVjdGVkUGFwZXJTaXplXSA9IHVzZVN0YXRlPHN0cmluZz4oXCJzdGFuZGFyZFwiKTtcbiAgXG4gIC8vIFVJIHN0YXRlXG4gIGNvbnN0IFtpc1RleHRhcmVhRXhwYW5kZWQsIHNldElzVGV4dGFyZWFFeHBhbmRlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc01lc3NhZ2VFeHBhbmRlZCwgc2V0SXNNZXNzYWdlRXhwYW5kZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd1NldHRpbmdzLCBzZXRTaG93U2V0dGluZ3NdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd1RlbXBsYXRlR2FsbGVyeSwgc2V0U2hvd1RlbXBsYXRlR2FsbGVyeV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93UHJpbnRDb25maXJtYXRpb24sIHNldFNob3dQcmludENvbmZpcm1hdGlvbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93VGVtcGxhdGVDdXN0b21pemF0aW9uLCBzZXRTaG93VGVtcGxhdGVDdXN0b21pemF0aW9uXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgXG4gIC8vIFJlc3RvcmF0aW9uIHN0YXRlXG4gIGNvbnN0IFtpc1Jlc3RvcmluZ0pvYnMsIHNldElzUmVzdG9yaW5nSm9ic10gPSB1c2VTdGF0ZSh0cnVlKTtcbiAgY29uc3QgW3NlbGVjdGVkVGVtcGxhdGUsIHNldFNlbGVjdGVkVGVtcGxhdGVdID0gdXNlU3RhdGU8R2VuZXJhdGVkQ2FyZCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaXNJbml0aWFsTG9hZENvbXBsZXRlLCBzZXRJc0luaXRpYWxMb2FkQ29tcGxldGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBcbiAgLy8gVGVtcGxhdGUgc3RhdGVcbiAgY29uc3QgW3RlbXBsYXRlU2VhcmNoUXVlcnksIHNldFRlbXBsYXRlU2VhcmNoUXVlcnldID0gdXNlU3RhdGUoXCJcIik7XG4gIGNvbnN0IFtpc1NlYXJjaGluZ1RlbXBsYXRlcywgc2V0SXNTZWFyY2hpbmdUZW1wbGF0ZXNdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbYWlGaWx0ZXJlZENhcmRzLCBzZXRBaUZpbHRlcmVkQ2FyZHNdID0gdXNlU3RhdGU8YW55W10+KFtdKTtcbiAgY29uc3QgW3NlYXJjaE1vZGUsIHNldFNlYXJjaE1vZGVdID0gdXNlU3RhdGU8J3RleHQnIHwgJ2FpJyB8ICdoeWJyaWQnPigndGV4dCcpO1xuICBjb25zdCBbdGV4dEZpbHRlcmVkQ2FyZHMsIHNldFRleHRGaWx0ZXJlZENhcmRzXSA9IHVzZVN0YXRlPGFueVtdPihbXSk7XG4gIGNvbnN0IFtzaG93UHJvbXB0cywgc2V0U2hvd1Byb21wdHNdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcHJpbnRPcHRpb24sIHNldFByaW50T3B0aW9uXSA9IHVzZVN0YXRlPCdwaHlzaWNhbCcgfCAnZW1haWwnPigncGh5c2ljYWwnKTtcbiAgXG4gIC8vIFRlbXBsYXRlIGN1c3RvbWl6YXRpb24gc3RhdGVcbiAgY29uc3QgW3RlbXBsYXRlQ3VzdG9taXphdGlvbnMsIHNldFRlbXBsYXRlQ3VzdG9taXphdGlvbnNdID0gdXNlU3RhdGUoe1xuICAgIHByb21wdENoYW5nZXM6IFwiXCIsXG4gICAgbWVzc2FnZUNoYW5nZXM6IFwiXCIsXG4gICAgdXNlUmVmZXJlbmNlSW1hZ2U6IGZhbHNlLFxuICAgIHJlZmVyZW5jZUltYWdlRmlsZTogbnVsbCBhcyBGaWxlIHwgbnVsbCxcbiAgICByZWZlcmVuY2VJbWFnZVVybHM6IFtdIGFzIHN0cmluZ1tdLFxuICAgIHJlZmVyZW5jZUltYWdlVHJhbnNmb3JtYXRpb246IFwiXCJcbiAgfSk7XG4gIFxuICAvLyBTZWN0aW9uIGxvYWRpbmcgc3RhdGVzXG4gIGNvbnN0IFtzZWN0aW9uTG9hZGluZ1N0YXRlcywgc2V0U2VjdGlvbkxvYWRpbmdTdGF0ZXNdID0gdXNlU3RhdGU8e1xuICAgIGZyb250Q292ZXI6ICdpZGxlJyB8ICdsb2FkaW5nJyB8ICdjb21wbGV0ZWQnIHwgJ2Vycm9yJztcbiAgICBiYWNrQ292ZXI6ICdpZGxlJyB8ICdsb2FkaW5nJyB8ICdjb21wbGV0ZWQnIHwgJ2Vycm9yJztcbiAgICBsZWZ0SW50ZXJpb3I6ICdpZGxlJyB8ICdsb2FkaW5nJyB8ICdjb21wbGV0ZWQnIHwgJ2Vycm9yJztcbiAgICByaWdodEludGVyaW9yOiAnaWRsZScgfCAnbG9hZGluZycgfCAnY29tcGxldGVkJyB8ICdlcnJvcic7XG4gIH0+KHtcbiAgICBmcm9udENvdmVyOiAnaWRsZScsXG4gICAgYmFja0NvdmVyOiAnaWRsZScsXG4gICAgbGVmdEludGVyaW9yOiAnaWRsZScsXG4gICAgcmlnaHRJbnRlcmlvcjogJ2lkbGUnLFxuICB9KTtcbiAgXG4gIC8vIENvdW50ZG93biBzdGF0ZVxuICBjb25zdCBbY291bnRkb3duLCBzZXRDb3VudGRvd25dID0gdXNlU3RhdGU8bnVtYmVyPigwKTtcbiAgY29uc3QgW2NvdW50ZG93bkludGVydmFsLCBzZXRDb3VudGRvd25JbnRlcnZhbF0gPSB1c2VTdGF0ZTxOb2RlSlMuVGltZW91dCB8IG51bGw+KG51bGwpO1xuXG4gIC8vIFVzZSBtb2R1bGFyIGhvb2tzXG4gIGNvbnN0IHdlYlNvY2tldCA9IHVzZVdlYlNvY2tldCgpO1xuICBjb25zdCBqb2JNYW5hZ2VtZW50ID0gdXNlSm9iTWFuYWdlbWVudCgpO1xuICBjb25zdCBmaWxlSGFuZGxpbmcgPSB1c2VGaWxlSGFuZGxpbmcoKTtcbiAgY29uc3QgbWVzc2FnZUdlbmVyYXRpb24gPSB1c2VNZXNzYWdlR2VuZXJhdGlvbihcbiAgICBzZWxlY3RlZFR5cGUsXG4gICAgY3VzdG9tQ2FyZFR5cGUsXG4gICAgc2VsZWN0ZWRUb25lLFxuICAgIHByb21wdCxcbiAgICB0b0ZpZWxkLFxuICAgIGZyb21GaWVsZCxcbiAgICByZWxhdGlvbnNoaXBGaWVsZCxcbiAgICBmaWxlSGFuZGxpbmcucGhvdG9SZWZlcmVuY2VzXG4gICk7XG4gIFxuICAvLyBEcmFmdCBnZW5lcmF0aW9uIHByb3BzXG4gIGNvbnN0IGRyYWZ0R2VuZXJhdGlvblByb3BzID0ge1xuICAgIHNlbGVjdGVkVHlwZSxcbiAgICBjdXN0b21DYXJkVHlwZSxcbiAgICBzZWxlY3RlZFRvbmUsXG4gICAgc2VsZWN0ZWRBcnRpc3RpY1N0eWxlLFxuICAgIGN1c3RvbVN0eWxlRGVzY3JpcHRpb24sXG4gICAgc2VsZWN0ZWREcmFmdE1vZGVsLFxuICAgIHNlbGVjdGVkSW1hZ2VNb2RlbCxcbiAgICBzZWxlY3RlZFBhcGVyU2l6ZSxcbiAgICBwcm9tcHQsXG4gICAgdG9GaWVsZCxcbiAgICBmcm9tRmllbGQsXG4gICAgdXNlckVtYWlsLFxuICAgIGZpbmFsQ2FyZE1lc3NhZ2U6IG1lc3NhZ2VHZW5lcmF0aW9uLmZpbmFsQ2FyZE1lc3NhZ2UsXG4gICAgaXNIYW5kd3JpdHRlbk1lc3NhZ2UsXG4gICAgaXNGcm9udEJhY2tPbmx5LFxuICAgIHJlZmVyZW5jZUltYWdlVXJsczogZmlsZUhhbmRsaW5nLnJlZmVyZW5jZUltYWdlVXJscyxcbiAgICBwaG90b1JlZmVyZW5jZXM6IGZpbGVIYW5kbGluZy5waG90b1JlZmVyZW5jZXMsXG4gICAgcmVsYXRpb25zaGlwRmllbGQsXG4gICAgc2F2ZUpvYlRvU3RvcmFnZTogam9iTWFuYWdlbWVudC5zYXZlSm9iVG9TdG9yYWdlLFxuICAgIHN1YnNjcmliZVRvSm9iOiB3ZWJTb2NrZXQuc3Vic2NyaWJlVG9Kb2IsXG4gICAgdW5zdWJzY3JpYmVGcm9tQWxsSm9iczogd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUFsbEpvYnMsXG4gICAgc3RhcnRFbGFwc2VkVGltZVRyYWNraW5nOiBqb2JNYW5hZ2VtZW50LnN0YXJ0RWxhcHNlZFRpbWVUcmFja2luZyxcbiAgICBzdG9wRWxhcHNlZFRpbWVUcmFja2luZzogam9iTWFuYWdlbWVudC5zdG9wRWxhcHNlZFRpbWVUcmFja2luZyxcbiAgfTtcbiAgXG4gIGNvbnN0IGRyYWZ0R2VuZXJhdGlvbiA9IHVzZURyYWZ0R2VuZXJhdGlvbihkcmFmdEdlbmVyYXRpb25Qcm9wcyk7XG4gIFxuICAvLyBDYXJkIGdlbmVyYXRpb24gcHJvcHNcbiAgY29uc3QgY2FyZEdlbmVyYXRpb25Qcm9wcyA9IHtcbiAgICBzZWxlY3RlZFR5cGUsXG4gICAgY3VzdG9tQ2FyZFR5cGUsXG4gICAgc2VsZWN0ZWRUb25lLFxuICAgIHNlbGVjdGVkQXJ0aXN0aWNTdHlsZSxcbiAgICBjdXN0b21TdHlsZURlc2NyaXB0aW9uLFxuICAgIHNlbGVjdGVkSW1hZ2VNb2RlbCxcbiAgICBzZWxlY3RlZFBhcGVyU2l6ZSxcbiAgICBwcm9tcHQsXG4gICAgdG9GaWVsZCxcbiAgICBmcm9tRmllbGQsXG4gICAgdXNlckVtYWlsLFxuICAgIGZpbmFsQ2FyZE1lc3NhZ2U6IG1lc3NhZ2VHZW5lcmF0aW9uLmZpbmFsQ2FyZE1lc3NhZ2UsXG4gICAgaXNIYW5kd3JpdHRlbk1lc3NhZ2UsXG4gICAgaXNGcm9udEJhY2tPbmx5LFxuICAgIHJlZmVyZW5jZUltYWdlVXJsczogZmlsZUhhbmRsaW5nLnJlZmVyZW5jZUltYWdlVXJscyxcbiAgICBwaG90b1JlZmVyZW5jZXM6IGZpbGVIYW5kbGluZy5waG90b1JlZmVyZW5jZXMsXG4gICAgcmVsYXRpb25zaGlwRmllbGQsXG4gICAgbnVtYmVyT2ZDYXJkcyxcbiAgICBzYXZlSm9iVG9TdG9yYWdlOiBqb2JNYW5hZ2VtZW50LnNhdmVKb2JUb1N0b3JhZ2UsXG4gICAgcmVtb3ZlSm9iRnJvbVN0b3JhZ2U6IGpvYk1hbmFnZW1lbnQucmVtb3ZlSm9iRnJvbVN0b3JhZ2UsXG4gICAgc3Vic2NyaWJlVG9Kb2I6IHdlYlNvY2tldC5zdWJzY3JpYmVUb0pvYixcbiAgICBzdGFydEVsYXBzZWRUaW1lVHJhY2tpbmc6IGpvYk1hbmFnZW1lbnQuc3RhcnRFbGFwc2VkVGltZVRyYWNraW5nLFxuICAgIHN0b3BFbGFwc2VkVGltZVRyYWNraW5nOiBqb2JNYW5hZ2VtZW50LnN0b3BFbGFwc2VkVGltZVRyYWNraW5nLFxuICAgIHNldEN1cnJlbnRKb2JJZDogam9iTWFuYWdlbWVudC5zZXRDdXJyZW50Sm9iSWQsXG4gICAgc2V0SXNEcmFmdE1vZGU6IGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0RyYWZ0TW9kZSxcbiAgICBzZXREcmFmdENhcmRzOiBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDYXJkcyxcbiAgICBzZXRTZWxlY3RlZERyYWZ0SW5kZXg6IGRyYWZ0R2VuZXJhdGlvbi5zZXRTZWxlY3RlZERyYWZ0SW5kZXgsXG4gICAgc2V0SXNHZW5lcmF0aW5nRmluYWxDYXJkOiBkcmFmdEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nRmluYWxDYXJkLFxuICAgIHNldFByZXZpZXdpbmdEcmFmdEluZGV4OiBkcmFmdEdlbmVyYXRpb24uc2V0UHJldmlld2luZ0RyYWZ0SW5kZXgsXG4gICAgc2V0RHJhZnRDb21wbGV0aW9uU2hvd246IGRyYWZ0R2VuZXJhdGlvbi5zZXREcmFmdENvbXBsZXRpb25TaG93bixcbiAgICBzZXREcmFmdENvbXBsZXRpb25Db3VudDogZHJhZnRHZW5lcmF0aW9uLnNldERyYWZ0Q29tcGxldGlvbkNvdW50LFxuICB9O1xuICBcbiAgY29uc3QgY2FyZEdlbmVyYXRpb24gPSB1c2VDYXJkR2VuZXJhdGlvbihjYXJkR2VuZXJhdGlvblByb3BzKTtcblxuICAvLyBIYW5kbGUgam9iIHVwZGF0ZXMgZnJvbSBXZWJTb2NrZXRcbiAgY29uc3QgaGFuZGxlSm9iVXBkYXRlID0gdXNlQ2FsbGJhY2soKGRhdGE6IGFueSkgPT4ge1xuICAgIGNvbnN0IHsgam9iX2lkLCBzdGF0dXMsIHByb2dyZXNzLCBjYXJkRGF0YSwgZXJyb3IsIGNvbXBsZXRlZEF0IH0gPSBkYXRhO1xuICAgIFxuICAgIGlmICgham9iX2lkKSByZXR1cm47XG4gICAgXG4gICAgLy8gU2tpcCB1cGRhdGVzIGlmIHdlJ3JlIHN0aWxsIHJlc3RvcmluZyBqb2JzIGZyb20gbG9jYWxTdG9yYWdlXG4gICAgaWYgKGlzUmVzdG9yaW5nSm9icykge1xuICAgICAgY29uc29sZS5sb2coJ+KPsyBTa2lwcGluZyBqb2IgdXBkYXRlIGR1cmluZyByZXN0b3JhdGlvbjonLCBqb2JfaWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgZHJhZnQgam9iXG4gICAgY29uc3QgaXNEcmFmdEpvYiA9IGpvYl9pZC5zdGFydHNXaXRoKCdkcmFmdC0nKTtcbiAgICBjb25zdCBkcmFmdEluZGV4ID0gaXNEcmFmdEpvYiA/IHBhcnNlSW50KGpvYl9pZC5zcGxpdCgnLScpWzFdKSA6IC0xO1xuICAgIFxuICAgIC8vIEZpbHRlciBvdXQgdXBkYXRlcyBmcm9tIHdyb25nIGpvYiB0eXBlXG4gICAgLy8gSWYgd2UncmUgaW4gZHJhZnQgbW9kZSwgb25seSBwcm9jZXNzIGRyYWZ0IGpvYnNcbiAgICAvLyBJZiB3ZSdyZSBpbiBmaW5hbCBtb2RlLCBvbmx5IHByb2Nlc3Mgbm9uLWRyYWZ0IGpvYnNcbiAgICBjb25zdCBpc0luRHJhZnRNb2RlID0gZHJhZnRHZW5lcmF0aW9uLmlzRHJhZnRNb2RlO1xuICAgIGlmIChpc0luRHJhZnRNb2RlICYmICFpc0RyYWZ0Sm9iKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+aqyBJZ25vcmluZyBub24tZHJhZnQgam9iIHVwZGF0ZSBpbiBkcmFmdCBtb2RlOicsIGpvYl9pZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghaXNJbkRyYWZ0TW9kZSAmJiBpc0RyYWZ0Sm9iKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+aqyBJZ25vcmluZyBkcmFmdCBqb2IgdXBkYXRlIGluIGZpbmFsIG1vZGU6Jywgam9iX2lkKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflIQgUHJvY2Vzc2luZyBqb2IgdXBkYXRlOicsIHsgam9iX2lkLCBzdGF0dXMsIGlzRHJhZnRKb2IsIGRyYWZ0SW5kZXgsIHByb2dyZXNzIH0pO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBwcm9ncmVzcyBpZiBwcm92aWRlZFxuICAgIGlmIChwcm9ncmVzcykge1xuICAgICAgLy8gSU1QT1JUQU5UOiBEb24ndCBzaG93IFwiR2VuZXJhdGlvbiBjb21wbGV0ZSFcIiB1bnRpbCB3ZSd2ZSBhY3R1YWxseSBwcm9jZXNzZWQgdGhlIGNhcmRcbiAgICAgIC8vIFRoaXMgcHJldmVudHMgdGhlIFVJIGZyb20gc2hvd2luZyBjb21wbGV0aW9uIGJlZm9yZSB0aGUgY2FyZCBpcyByZWFkeVxuICAgICAgaWYgKHByb2dyZXNzLmluY2x1ZGVzKCdHZW5lcmF0aW9uIGNvbXBsZXRlIScpICYmIHN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgIWlzRHJhZnRKb2IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KPuO+4jyBIb2xkaW5nIFwiR2VuZXJhdGlvbiBjb21wbGV0ZSFcIiBtZXNzYWdlIHVudGlsIGNhcmQgaXMgcHJvY2Vzc2VkJyk7XG4gICAgICAgIC8vIERvbid0IHVwZGF0ZSB0aGUgcHJvZ3Jlc3MgbWVzc2FnZSB5ZXQgLSBpdCB3aWxsIGJlIHNldCBpbiBoYW5kbGVGaW5hbENhcmRDb21wbGV0aW9uXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3MocHJvZ3Jlc3MpO1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzKHByb2dyZXNzKTtcbiAgICAgICAgY29uc29sZS5sb2coYPCfk4ogUHJvZ3Jlc3MgbWVzc2FnZTogJHtwcm9ncmVzc31gKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgaWYgKHN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgY2FyZERhdGEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn46JIEpvYiBjb21wbGV0ZWQhIENhcmQgZGF0YTonLCBjYXJkRGF0YSwgJ2lzRHJhZnRKb2I6JywgaXNEcmFmdEpvYik7XG4gICAgICBcbiAgICAgIGlmIChpc0RyYWZ0Sm9iICYmIGRyYWZ0SW5kZXggPj0gMCkge1xuICAgICAgICAvLyBIYW5kbGUgZHJhZnQgY2FyZCBjb21wbGV0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn46oIERyYWZ0IHZhcmlhdGlvbiAke2RyYWZ0SW5kZXggKyAxfSBjb21wbGV0ZWQhYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgc3R5bGUgaW5mbyBmb3Igc21hcnQgc3R5bGUgbW9kZVxuICAgICAgICBsZXQgc3R5bGVJbmZvOiB7IHN0eWxlTmFtZTogc3RyaW5nOyBzdHlsZUxhYmVsOiBzdHJpbmcgfSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHNlbGVjdGVkQXJ0aXN0aWNTdHlsZSA9PT0gXCJhaS1zbWFydC1zdHlsZVwiKSB7XG4gICAgICAgICAgY29uc3QgcHJlZGVmaW5lZFN0eWxlcyA9IFtcbiAgICAgICAgICAgIFwid2F0ZXJjb2xvclwiLCBcImJvdGFuaWNhbFwiLCBcImNvbWljLWJvb2tcIiwgXCJkcmVhbXktZmFudGFzeVwiLCBcIm1pbmltYWxpc3RcIlxuICAgICAgICAgIF07XG4gICAgICAgICAgY29uc3Qgc3R5bGVMYWJlbHMgPSBbXG4gICAgICAgICAgICBcIvCfjqggV2F0ZXJjb2xvclwiLCBcIvCfjL8gQm90YW5pY2FsXCIsIFwi8J+SpSBDb21pYyBCb29rXCIsIFwi8J+MuCBEcmVhbXkgRmFudGFzeVwiLCBcIuKcqCBNaW5pbWFsaXN0XCJcbiAgICAgICAgICBdO1xuICAgICAgICAgIGlmIChkcmFmdEluZGV4ID49IDAgJiYgZHJhZnRJbmRleCA8IHByZWRlZmluZWRTdHlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzdHlsZUluZm8gPSB7XG4gICAgICAgICAgICAgIHN0eWxlTmFtZTogcHJlZGVmaW5lZFN0eWxlc1tkcmFmdEluZGV4XSxcbiAgICAgICAgICAgICAgc3R5bGVMYWJlbDogc3R5bGVMYWJlbHNbZHJhZnRJbmRleF1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZHJhZnRDYXJkOiBHZW5lcmF0ZWRDYXJkID0ge1xuICAgICAgICAgIGlkOiBgZHJhZnQtJHtkcmFmdEluZGV4ICsgMX0tJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgcHJvbXB0OiBjYXJkRGF0YS5wcm9tcHQgfHwgYERyYWZ0IFZhcmlhdGlvbiAke2RyYWZ0SW5kZXggKyAxfWAsXG4gICAgICAgICAgZnJvbnRDb3ZlcjogY2FyZERhdGEuZnJvbnRDb3ZlciB8fCBcIlwiLFxuICAgICAgICAgIGJhY2tDb3ZlcjogXCJcIixcbiAgICAgICAgICBsZWZ0UGFnZTogXCJcIixcbiAgICAgICAgICByaWdodFBhZ2U6IFwiXCIsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGdlbmVyYXRlZFByb21wdHM6IHtcbiAgICAgICAgICAgIGZyb250Q292ZXI6IGNhcmREYXRhLmdlbmVyYXRlZFByb21wdHM/LmZyb250Q292ZXIgfHwgXCJcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3R5bGVJbmZvOiBzdHlsZUluZm9cbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNpbXBsaWZpZWQgZHJhZnQgdHJhY2tpbmcgLSB1c2UgZml4ZWQgYXJyYXkgcG9zaXRpb25zXG4gICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXREcmFmdENhcmRzKHByZXYgPT4ge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBbLi4ucHJldl07XG4gICAgICAgICAgLy8gRW5zdXJlIGFycmF5IGhhcyA1IHNsb3RzXG4gICAgICAgICAgd2hpbGUgKHVwZGF0ZWQubGVuZ3RoIDwgNSkge1xuICAgICAgICAgICAgdXBkYXRlZC5wdXNoKG51bGwgYXMgYW55KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gUGxhY2UgZHJhZnQgYXQgaXRzIGNvcnJlY3QgaW5kZXhcbiAgICAgICAgICB1cGRhdGVkW2RyYWZ0SW5kZXhdID0gZHJhZnRDYXJkO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgRHJhZnQgJHtkcmFmdEluZGV4ICsgMX0gY29tcGxldGVkIGFuZCBzdG9yZWQgYXQgaW5kZXggJHtkcmFmdEluZGV4fWApO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE5vIGxvbmdlciBzYXZlIGluZGl2aWR1YWwgZHJhZnRzIHRvIGxvY2FsU3RvcmFnZVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNpbXBsaWZpZWQgY29tcGxldGlvbiB0cmFja2luZyAtIGNvdW50IHRoZSB1cGRhdGVkIGFycmF5IGluY2x1ZGluZyB0aGUgbmV3IGRyYWZ0XG4gICAgICAgIGNvbnN0IHVwZGF0ZWREcmFmdHMgPSBbLi4uZHJhZnRHZW5lcmF0aW9uLmRyYWZ0Q2FyZHNdO1xuICAgICAgICB1cGRhdGVkRHJhZnRzW2RyYWZ0SW5kZXhdID0gZHJhZnRDYXJkO1xuICAgICAgICBjb25zdCBjb21wbGV0ZWRDb3VudCA9IHVwZGF0ZWREcmFmdHMuZmlsdGVyKEJvb2xlYW4pLmxlbmd0aDtcbiAgICAgICAgY29uc29sZS5sb2coYPCfk4ogRHJhZnQgcHJvZ3Jlc3M6ICR7Y29tcGxldGVkQ291bnR9LzUgdmFyaWF0aW9ucyBjb21wbGV0ZWApO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHByb2dyZXNzXG4gICAgICAgIGNvbnN0IHByb2dyZXNzTXNnID0gY29tcGxldGVkQ291bnQgPT09IDUgXG4gICAgICAgICAgPyBcIkFsbCA1IHZhcmlhdGlvbnMgcmVhZHkhIENob29zZSB5b3VyIGZhdm9yaXRlIGJlbG93LlwiXG4gICAgICAgICAgOiBgJHtjb21wbGV0ZWRDb3VudH0vNSB2YXJpYXRpb25zIGNvbXBsZXRlLi4uJHtjb21wbGV0ZWRDb3VudCA+PSAyID8gXCIgWW91IGNhbiBzZWxlY3Qgb25lIG5vdyFcIiA6IFwiXCJ9YDtcbiAgICAgICAgXG4gICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3MocHJvZ3Jlc3NNc2cpO1xuICAgICAgICBcbiAgICAgICAgLy8gT3ZlcnJpZGUgdGltZS1iYXNlZCBwcm9ncmVzcyB3aXRoIHJlYWwgcHJvZ3Jlc3Mgd2hlbiBkcmFmdHMgY29tcGxldGVcbiAgICAgICAgLy8gRG9uJ3Qgb3ZlcnJpZGUgdGltZS1iYXNlZCBwcm9ncmVzc1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+OqCBEcmFmdCAke2NvbXBsZXRlZENvdW50fS81IGNvbXBsZXRlZGApO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIG1pbGVzdG9uZXNcbiAgICAgICAgaWYgKGNvbXBsZXRlZENvdW50ID09PSAxKSB7XG4gICAgICAgICAgc2Nyb2xsVG9DYXJkUHJldmlldygpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoY29tcGxldGVkQ291bnQgPT09IDUgJiYgIWRyYWZ0R2VuZXJhdGlvbi5pc0dlbmVyYXRpbmdGaW5hbENhcmQpIHtcbiAgICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nKGZhbHNlKTtcbiAgICAgICAgICBqb2JNYW5hZ2VtZW50LnN0b3BFbGFwc2VkVGltZVRyYWNraW5nKCk7XG4gICAgICAgICAgdG9hc3Quc3VjY2VzcyhcIvCfjqggQWxsIDUgZnJvbnQgY292ZXIgdmFyaWF0aW9ucyByZWFkeSEgQ2hvb3NlIHlvdXIgZmF2b3JpdGUgYmVsb3cuXCIpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBLZWVwIGRyYWZ0IGpvYnMgaW4gc3RvcmFnZSBmb3IgbGF0ZXIgcmV0cmlldmFsXG4gICAgICAgIC8vIE9ubHkgdW5zdWJzY3JpYmUgZnJvbSBXZWJTb2NrZXRcbiAgICAgICAgd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUpvYihqb2JfaWQpO1xuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEtlZXBpbmcgZHJhZnQgam9iICR7am9iX2lkfSBpbiBzdG9yYWdlIGZvciBmdXR1cmUgYWNjZXNzYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBIYW5kbGUgZmluYWwgY2FyZCBjb21wbGV0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZpbmFsIGNhcmQgY29tcGxldGlvbiBkZXRlY3RlZC4gQ2FyZCBkYXRhIHN0cnVjdHVyZTonLCB7XG4gICAgICAgICAgaGFzQ2FyZERhdGE6ICEhY2FyZERhdGEsXG4gICAgICAgICAgY2FyZERhdGFLZXlzOiBPYmplY3Qua2V5cyhjYXJkRGF0YSB8fCB7fSksXG4gICAgICAgICAgZnJvbnRDb3ZlcjogY2FyZERhdGE/LmZyb250Q292ZXIgPyAnUHJlc2VudCcgOiAnTWlzc2luZycsXG4gICAgICAgICAgYmFja0NvdmVyOiBjYXJkRGF0YT8uYmFja0NvdmVyID8gJ1ByZXNlbnQnIDogJ01pc3NpbmcnLFxuICAgICAgICAgIGxlZnRJbnRlcmlvcjogY2FyZERhdGE/LmxlZnRJbnRlcmlvciA/ICdQcmVzZW50JyA6ICdNaXNzaW5nJyxcbiAgICAgICAgICByaWdodEludGVyaW9yOiBjYXJkRGF0YT8ucmlnaHRJbnRlcmlvciA/ICdQcmVzZW50JyA6ICdNaXNzaW5nJyxcbiAgICAgICAgICBsZWZ0UGFnZTogY2FyZERhdGE/LmxlZnRQYWdlID8gJ1ByZXNlbnQnIDogJ01pc3NpbmcnLFxuICAgICAgICAgIHJpZ2h0UGFnZTogY2FyZERhdGE/LnJpZ2h0UGFnZSA/ICdQcmVzZW50JyA6ICdNaXNzaW5nJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OdIEZ1bGwgY2FyZCBkYXRhOicsIEpTT04uc3RyaW5naWZ5KGNhcmREYXRhLCBudWxsLCAyKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgYmFja2VuZCBmaWVsZCBuYW1lcyB0byBmcm9udGVuZCBmaWVsZCBuYW1lc1xuICAgICAgICBjb25zdCBtYXBwZWRDYXJkRGF0YSA9IHtcbiAgICAgICAgICAuLi5jYXJkRGF0YSxcbiAgICAgICAgICBsZWZ0SW50ZXJpb3I6IGNhcmREYXRhLmxlZnRJbnRlcmlvciB8fCBjYXJkRGF0YS5sZWZ0UGFnZSxcbiAgICAgICAgICByaWdodEludGVyaW9yOiBjYXJkRGF0YS5yaWdodEludGVyaW9yIHx8IGNhcmREYXRhLnJpZ2h0UGFnZSxcbiAgICAgICAgICAvLyBLZWVwIG9yaWdpbmFsIGZpZWxkcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgICAgIGxlZnRQYWdlOiBjYXJkRGF0YS5sZWZ0UGFnZSB8fCBjYXJkRGF0YS5sZWZ0SW50ZXJpb3IsXG4gICAgICAgICAgcmlnaHRQYWdlOiBjYXJkRGF0YS5yaWdodFBhZ2UgfHwgY2FyZERhdGEucmlnaHRJbnRlcmlvcixcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIE1hcHBlZCBjYXJkIGRhdGEgZm9yIGZyb250ZW5kIGNvbXBhdGliaWxpdHk6Jywge1xuICAgICAgICAgIGZyb250Q292ZXI6IG1hcHBlZENhcmREYXRhLmZyb250Q292ZXIgPyAnUHJlc2VudCcgOiAnTWlzc2luZycsXG4gICAgICAgICAgYmFja0NvdmVyOiBtYXBwZWRDYXJkRGF0YS5iYWNrQ292ZXIgPyAnUHJlc2VudCcgOiAnTWlzc2luZycsXG4gICAgICAgICAgbGVmdEludGVyaW9yOiBtYXBwZWRDYXJkRGF0YS5sZWZ0SW50ZXJpb3IgPyAnUHJlc2VudCcgOiAnTWlzc2luZycsXG4gICAgICAgICAgcmlnaHRJbnRlcmlvcjogbWFwcGVkQ2FyZERhdGEucmlnaHRJbnRlcmlvciA/ICdQcmVzZW50JyA6ICdNaXNzaW5nJyxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDYWxsIHRoZSBjb21wbGV0aW9uIGhhbmRsZXJcbiAgICAgICAgY29uc29sZS5sb2coJ/CfmoAgQ2FsbGluZyBoYW5kbGVGaW5hbENhcmRDb21wbGV0aW9uLi4uJyk7XG4gICAgICAgIGNhcmRHZW5lcmF0aW9uLmhhbmRsZUZpbmFsQ2FyZENvbXBsZXRpb24obWFwcGVkQ2FyZERhdGEpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2FyZCBpcyBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIHJlY2VudCBjYXJkcyBieSBtYXJrSm9iQ29tcGxldGVcbiAgICAgICAgXG4gICAgICAgIGpvYk1hbmFnZW1lbnQucmVtb3ZlSm9iRnJvbVN0b3JhZ2Uoam9iX2lkKTtcbiAgICAgICAgam9iTWFuYWdlbWVudC5zZXRDdXJyZW50Sm9iSWQobnVsbCk7XG4gICAgICAgIHdlYlNvY2tldC51bnN1YnNjcmliZUZyb21Kb2Ioam9iX2lkKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ2ZhaWxlZCcpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBKb2IgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIFxuICAgICAgaWYgKGlzRHJhZnRKb2IgJiYgZHJhZnRJbmRleCA+PSAwKSB7XG4gICAgICAgIHRvYXN0LmVycm9yKGBEcmFmdCB2YXJpYXRpb24gJHtkcmFmdEluZGV4ICsgMX0gZmFpbGVkLiBDb250aW51aW5nIHdpdGggb3RoZXJzLi4uYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2FzdC5lcnJvcihcIuKdjCBDYXJkIGdlbmVyYXRpb24gZmFpbGVkLiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgY2FyZEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nKGZhbHNlKTtcbiAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZ0ZpbmFsQ2FyZChmYWxzZSk7XG4gICAgICAgIGpvYk1hbmFnZW1lbnQuc3RvcEVsYXBzZWRUaW1lVHJhY2tpbmcoKTtcbiAgICAgICAgY2FyZEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzKFwiXCIpO1xuICAgICAgICAvLyBEb24ndCByZXNldCBwcm9ncmVzcyAtIGxldCB0aW1lLWJhc2VkIHByb2dyZXNzIGNvbnRpbnVlXG4gICAgICAgIC8vIGpvYk1hbmFnZW1lbnQuc2V0UHJvZ3Jlc3NQZXJjZW50YWdlKDApO1xuICAgICAgICBqb2JNYW5hZ2VtZW50LnNldEN1cnJlbnRKb2JJZChudWxsKTtcbiAgICAgICAgd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUpvYihqb2JfaWQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBqb2JNYW5hZ2VtZW50LnJlbW92ZUpvYkZyb21TdG9yYWdlKGpvYl9pZCk7XG4gICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdub3RfZm91bmQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBKb2Igbm90IGZvdW5kIG9uIHNlcnZlciwgY2xlYW5pbmcgdXAgc3RhbGUgcmVmZXJlbmNlOicsIGpvYl9pZCk7XG4gICAgICBcbiAgICAgIC8vIENsZWFuIHVwIHN0YWxlIGpvYiByZWZlcmVuY2VcbiAgICAgIGlmICh3ZWJTb2NrZXQuY3VycmVudEpvYlJlZi5jdXJyZW50ID09PSBqb2JfaWQpIHtcbiAgICAgICAgd2ViU29ja2V0LmN1cnJlbnRKb2JSZWYuY3VycmVudCA9IG51bGw7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFJlc2V0IFVJIHN0YXRlIGlmIHRoaXMgd2FzIHRoZSBjdXJyZW50IGpvYlxuICAgICAgaWYgKGpvYk1hbmFnZW1lbnQuY3VycmVudEpvYklkID09PSBqb2JfaWQpIHtcbiAgICAgICAgam9iTWFuYWdlbWVudC5zZXRDdXJyZW50Sm9iSWQobnVsbCk7XG4gICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZyhmYWxzZSk7XG4gICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQoZmFsc2UpO1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3MoXCJcIik7XG4gICAgICAgIC8vIERvbid0IHJlc2V0IHByb2dyZXNzIC0gbGV0IHRpbWUtYmFzZWQgcHJvZ3Jlc3MgY29udGludWVcbiAgICAgICAgLy8gam9iTWFuYWdlbWVudC5zZXRQcm9ncmVzc1BlcmNlbnRhZ2UoMCk7XG4gICAgICAgIGpvYk1hbmFnZW1lbnQuc3RvcEVsYXBzZWRUaW1lVHJhY2tpbmcoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2xlYW4gdXAgc3RvcmFnZVxuICAgICAgam9iTWFuYWdlbWVudC5yZW1vdmVKb2JGcm9tU3RvcmFnZShqb2JfaWQpO1xuICAgICAgd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUpvYihqb2JfaWQpO1xuICAgIH1cbiAgfSwgW3NlbGVjdGVkQXJ0aXN0aWNTdHlsZSwgZHJhZnRHZW5lcmF0aW9uLCBjYXJkR2VuZXJhdGlvbiwgam9iTWFuYWdlbWVudCwgd2ViU29ja2V0LCBpc1Jlc3RvcmluZ0pvYnNdKTtcblxuICAvLyBTZXQgdXAgV2ViU29ja2V0IGpvYiB1cGRhdGUgaGFuZGxlclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHdlYlNvY2tldC5zZXRKb2JVcGRhdGVIYW5kbGVyKGhhbmRsZUpvYlVwZGF0ZSk7XG4gIH0sIFt3ZWJTb2NrZXQsIGhhbmRsZUpvYlVwZGF0ZV0pO1xuXG4gIC8vIFRyYWNrIGlmIHdlJ3ZlIGFscmVhZHkgbG9nZ2VkIHRoZSBzdGFsZSBqb2IgbWVzc2FnZVxuICBjb25zdCBzdGFsZUpvYkxvZ2dlZFJlZiA9IHVzZVJlZihmYWxzZSk7XG5cbiAgLy8gQXV0by1yZWNvbm5lY3QgV2ViU29ja2V0IGlmIGRpc2Nvbm5lY3RlZCBkdXJpbmcgYWN0aXZlIGdlbmVyYXRpb25cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIXdlYlNvY2tldC5pc1NvY2tldENvbm5lY3RlZCAmJiBcbiAgICAgICAgKGNhcmRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZyB8fCBkcmFmdEdlbmVyYXRpb24uaXNHZW5lcmF0aW5nRmluYWxDYXJkKSAmJiBcbiAgICAgICAgd2ViU29ja2V0LmN1cnJlbnRKb2JSZWYuY3VycmVudCkge1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiB0aGUgZ2VuZXJhdGlvbiBoYXMgYmVlbiBydW5uaW5nIGZvciBtb3JlIHRoYW4gNSBtaW51dGVzXG4gICAgICBpZiAoam9iTWFuYWdlbWVudC5nZW5lcmF0aW9uU3RhcnRUaW1lKSB7XG4gICAgICAgIGNvbnN0IGpvYkFnZSA9IERhdGUubm93KCkgLSBqb2JNYW5hZ2VtZW50LmdlbmVyYXRpb25TdGFydFRpbWU7XG4gICAgICAgIGlmIChqb2JBZ2UgPiA1ICogNjAgKiAxMDAwKSB7IC8vIDUgbWludXRlc1xuICAgICAgICAgIGlmICghc3RhbGVKb2JMb2dnZWRSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KPsCBKb2IgaXMgb2xkZXIgdGhhbiA1IG1pbnV0ZXMsIHN0b3BwaW5nIHJlY29ubmVjdGlvbiBhdHRlbXB0cycpO1xuICAgICAgICAgICAgc3RhbGVKb2JMb2dnZWRSZWYuY3VycmVudCA9IHRydWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsZWFuIHVwIHN0YWxlIGpvYlxuICAgICAgICAgICAgY29uc3Qgam9iSWQgPSB3ZWJTb2NrZXQuY3VycmVudEpvYlJlZi5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKGpvYklkKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn6e5IENsZWFuaW5nIHVwIHN0YWxlIGpvYjonLCBqb2JJZCk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvLyBSZW1vdmUgZnJvbSBsb2NhbFN0b3JhZ2UgKG9ubHkgaWYgbm90IGEgZHJhZnQgam9iKVxuICAgICAgICAgICAgICBpZiAoIWpvYklkLnN0YXJ0c1dpdGgoJ2RyYWZ0LScpKSB7XG4gICAgICAgICAgICAgICAgam9iTWFuYWdlbWVudC5yZW1vdmVKb2JGcm9tU3RvcmFnZShqb2JJZCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIFJlc2V0IGdlbmVyYXRpb24gc3RhdGVzXG4gICAgICAgICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZyhmYWxzZSk7XG4gICAgICAgICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQoZmFsc2UpO1xuICAgICAgICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0SXNEcmFmdE1vZGUoZmFsc2UpO1xuICAgICAgICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDYXJkcyhbXSk7XG4gICAgICAgICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXREcmFmdENvbXBsZXRpb25Db3VudCgwKTtcbiAgICAgICAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldERyYWZ0Q29tcGxldGlvblNob3duKGZhbHNlKTtcbiAgICAgICAgICAgICAgam9iTWFuYWdlbWVudC5zZXRDdXJyZW50Sm9iSWQobnVsbCk7XG4gICAgICAgICAgICAgIGpvYk1hbmFnZW1lbnQuc2V0R2VuZXJhdGlvblByb2dyZXNzKCcnKTtcbiAgICAgICAgICAgICAgLy8gRG9uJ3QgcmVzZXQgcHJvZ3Jlc3MgLSBsZXQgdGltZS1iYXNlZCBwcm9ncmVzcyBjb250aW51ZVxuICAgICAgICAvLyBqb2JNYW5hZ2VtZW50LnNldFByb2dyZXNzUGVyY2VudGFnZSgwKTtcbiAgICAgICAgICAgICAgam9iTWFuYWdlbWVudC5zdG9wRWxhcHNlZFRpbWVUcmFja2luZygpO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgLy8gVW5zdWJzY3JpYmUgZnJvbSBqb2JcbiAgICAgICAgICAgICAgd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUpvYihqb2JJZCk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvLyBTaG93IGVycm9yIHRvYXN0XG4gICAgICAgICAgICAgIHRvYXN0LmVycm9yKCdDYXJkIGdlbmVyYXRpb24gdGltZWQgb3V0LiBQbGVhc2UgdHJ5IGFnYWluLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/CflIQgV2ViU29ja2V0IGRpc2Nvbm5lY3RlZCBkdXJpbmcgZ2VuZXJhdGlvbiwgYXR0ZW1wdGluZyByZWNvbm5lY3QuLi4nKTtcbiAgICAgIGNvbnN0IHJlY29ubmVjdFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHdlYlNvY2tldC5jb25uZWN0V2ViU29ja2V0KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZS1zdWJzY3JpYmUgdG8gY3VycmVudCBqb2IgYWZ0ZXIgcmVjb25uZWN0aW9uXG4gICAgICAgIGNvbnN0IGpvYklkID0gd2ViU29ja2V0LmN1cnJlbnRKb2JSZWYuY3VycmVudDtcbiAgICAgICAgaWYgKGpvYklkKSB7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+ToSBSZS1zdWJzY3JpYmluZyB0byBqb2IgYWZ0ZXIgcmVjb25uZWN0OicsIGpvYklkKTtcbiAgICAgICAgICAgIHdlYlNvY2tldC5zdWJzY3JpYmVUb0pvYihqb2JJZCk7XG4gICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDIwMDApO1xuICAgICAgXG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHJlY29ubmVjdFRpbWVyKTtcbiAgICB9XG4gIH0sIFt3ZWJTb2NrZXQsIGNhcmRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZywgZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCwgam9iTWFuYWdlbWVudC5nZW5lcmF0aW9uU3RhcnRUaW1lXSk7XG5cbiAgLy8gUmVzZXQgc3RhbGUgam9iIGZsYWcgd2hlbiBnZW5lcmF0aW9uIHN0YXJ0c1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChjYXJkR2VuZXJhdGlvbi5pc0dlbmVyYXRpbmcgfHwgZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCkge1xuICAgICAgc3RhbGVKb2JMb2dnZWRSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgIH1cbiAgfSwgW2NhcmRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZywgZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZF0pO1xuXG4gIC8vIE1vbml0b3IgZm9yIHN0YWxlIGpvYiB1cGRhdGVzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKChjYXJkR2VuZXJhdGlvbi5pc0dlbmVyYXRpbmcgfHwgZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCkgJiYgXG4gICAgICAgIHdlYlNvY2tldC5jdXJyZW50Sm9iUmVmLmN1cnJlbnQpIHtcbiAgICAgIGNvbnN0IGNoZWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHRpbWVTaW5jZUxhc3RVcGRhdGUgPSBEYXRlLm5vdygpIC0gd2ViU29ja2V0Lmxhc3RKb2JVcGRhdGVSZWYuY3VycmVudDtcbiAgICAgICAgY29uc3Qgam9iSWQgPSB3ZWJTb2NrZXQuY3VycmVudEpvYlJlZi5jdXJyZW50O1xuICAgICAgICBcbiAgICAgICAgLy8gVmVyeSBhZ2dyZXNzaXZlIGNoZWNraW5nIHdoZW4gYXQgOTUlKyBwcm9ncmVzc1xuICAgICAgICBpZiAoam9iTWFuYWdlbWVudC5wcm9ncmVzc1BlcmNlbnRhZ2UgPj0gOTUgJiYgdGltZVNpbmNlTGFzdFVwZGF0ZSA+IDUwMDApIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBObyB1cGRhdGVzIGZvciAke01hdGgucm91bmQodGltZVNpbmNlTGFzdFVwZGF0ZS8xMDAwKX1zIGF0ICR7am9iTWFuYWdlbWVudC5wcm9ncmVzc1BlcmNlbnRhZ2V9JSBwcm9ncmVzcyAtIGNoZWNraW5nIGpvYiBzdGF0dXMuLi5gKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoam9iSWQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvam9iLXN0YXR1cy8ke2pvYklkfWApO1xuICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCBqb2JTdGF0dXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/Cfk4ogRGlyZWN0IGpvYiBzdGF0dXMgY2hlY2s6Jywgam9iU3RhdHVzKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoam9iU3RhdHVzLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgam9iU3RhdHVzLmNhcmREYXRhKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIEpvYiBpcyBhY3R1YWxseSBjb21wbGV0ZWQhIFByb2Nlc3NpbmcgcmVzdWx0Li4uJyk7XG4gICAgICAgICAgICAgICAgICBoYW5kbGVKb2JVcGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBqb2JfaWQ6IGpvYklkLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzczogJ0NhcmQgZ2VuZXJhdGlvbiBjb21wbGV0ZSEnLFxuICAgICAgICAgICAgICAgICAgICBjYXJkRGF0YTogam9iU3RhdHVzLmNhcmREYXRhXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gRXhpdCBlYXJseSBvbiBjb21wbGV0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2hlY2sgam9iIHN0YXR1czonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIE1vcmUgYWdncmVzc2l2ZSBjaGVja2luZyB3aGVuIGF0IGhpZ2ggcHJvZ3Jlc3NcbiAgICAgICAgZWxzZSBpZiAoam9iTWFuYWdlbWVudC5wcm9ncmVzc1BlcmNlbnRhZ2UgPj0gOTAgJiYgdGltZVNpbmNlTGFzdFVwZGF0ZSA+IDEwMDAwKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gTm8gdXBkYXRlcyBmb3IgJHtNYXRoLnJvdW5kKHRpbWVTaW5jZUxhc3RVcGRhdGUvMTAwMCl9cyBhdCAke2pvYk1hbmFnZW1lbnQucHJvZ3Jlc3NQZXJjZW50YWdlfSUgcHJvZ3Jlc3NgKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoam9iSWQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvam9iLXN0YXR1cy8ke2pvYklkfWApO1xuICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCBqb2JTdGF0dXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/Cfk4ogRGlyZWN0IGpvYiBzdGF0dXMgY2hlY2s6Jywgam9iU3RhdHVzKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoam9iU3RhdHVzLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgJiYgam9iU3RhdHVzLmNhcmREYXRhKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIEpvYiBpcyBhY3R1YWxseSBjb21wbGV0ZWQhIFByb2Nlc3NpbmcgcmVzdWx0Li4uJyk7XG4gICAgICAgICAgICAgICAgICBoYW5kbGVKb2JVcGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBqb2JfaWQ6IGpvYklkLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzczogJ0NhcmQgZ2VuZXJhdGlvbiBjb21wbGV0ZSEnLFxuICAgICAgICAgICAgICAgICAgICBjYXJkRGF0YTogam9iU3RhdHVzLmNhcmREYXRhXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gRXhpdCBlYXJseSBvbiBjb21wbGV0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2hlY2sgam9iIHN0YXR1czonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTdGFuZGFyZCBzdGFsZSB1cGRhdGUgY2hlY2tcbiAgICAgICAgaWYgKHRpbWVTaW5jZUxhc3RVcGRhdGUgPiAzMDAwMCkgeyAvLyAzMCBzZWNvbmRzIHdpdGhvdXQgdXBkYXRlXG4gICAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gam9iIHVwZGF0ZXMgZm9yIDMwIHNlY29uZHMsIGNoZWNraW5nIGNvbm5lY3Rpb24uLi4nKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIXdlYlNvY2tldC5pc1NvY2tldENvbm5lY3RlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgV2ViU29ja2V0IGRpc2Nvbm5lY3RlZCwgcmVjb25uZWN0aW5nLi4uJyk7XG4gICAgICAgICAgICB3ZWJTb2NrZXQuY29ubmVjdFdlYlNvY2tldCgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoam9iSWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5OhIFJlLXN1YnNjcmliaW5nIHRvIGpvYiBkdWUgdG8gc3RhbGUgdXBkYXRlczonLCBqb2JJZCk7XG4gICAgICAgICAgICB3ZWJTb2NrZXQuc3Vic2NyaWJlVG9Kb2Ioam9iSWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBSZXNldCB0aGUgdGltZXJcbiAgICAgICAgICB3ZWJTb2NrZXQubGFzdEpvYlVwZGF0ZVJlZi5jdXJyZW50ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgfVxuICAgICAgfSwgMzAwMCk7IC8vIENoZWNrIGV2ZXJ5IDMgc2Vjb25kcyBmb3IgZmFzdGVyIGRldGVjdGlvbiBhdCBoaWdoIHByb2dyZXNzXG4gICAgICBcbiAgICAgIHJldHVybiAoKSA9PiBjbGVhckludGVydmFsKGNoZWNrSW50ZXJ2YWwpO1xuICAgIH1cbiAgfSwgW2NhcmRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZywgZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCwgXG4gICAgICB3ZWJTb2NrZXQsIGpvYk1hbmFnZW1lbnQucHJvZ3Jlc3NQZXJjZW50YWdlLCBoYW5kbGVKb2JVcGRhdGVdKTtcblxuICAvLyBTaW1wbGlmaWVkIGpvYiByZXN0b3JhdGlvbiB1c2luZyBuZXcgc3RvcmFnZSBtYW5hZ2VyXG4gIGNvbnN0IGNoZWNrUGVuZGluZ0pvYnMgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgQ2hlY2tpbmcgZm9yIHJlY292ZXJ5IGRhdGEuLi4nKTtcbiAgICBzZXRJc1Jlc3RvcmluZ0pvYnModHJ1ZSk7XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIGFjdGl2ZSByZWNvdmVyeSBqb2JcbiAgICBjb25zdCByZWNvdmVyeSA9IHN0b3JhZ2UuZ2V0UmVjb3ZlcnkoKTtcbiAgICBcbiAgICBpZiAoIXJlY292ZXJ5KSB7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIE5vIGFjdGl2ZSBqb2IgdG8gcmVjb3ZlcicpO1xuICAgICAgc2V0SXNSZXN0b3JpbmdKb2JzKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflIQgRm91bmQgcmVjb3ZlcnkgZGF0YTonLCByZWNvdmVyeSk7XG4gICAgXG4gICAgLy8gSW4gb3VyIHNpbXBsaWZpZWQgc3lzdGVtLCB3ZSBvbmx5IHRyYWNrIG9uZSBhY3RpdmUgam9iIGF0IGEgdGltZVxuICAgIC8vIFJlY292ZXJ5IGlzIG1lYW50IGZvciBicm93c2VyIGNyYXNoZXMgZHVyaW5nIGdlbmVyYXRpb25cbiAgICBjb25zdCBpc1JlY292ZXJ5RHJhZnQgPSByZWNvdmVyeS5qb2JJZD8uc3RhcnRzV2l0aCgnZHJhZnQtJyk7XG4gICAgXG4gICAgaWYgKGlzUmVjb3ZlcnlEcmFmdCkge1xuICAgICAgY29uc29sZS5sb2coJ/CfjqggUmVjb3ZlcmluZyBmcm9tIGRyYWZ0IGdlbmVyYXRpb24nKTtcbiAgICAgIC8vIEZvciBkcmFmdCByZWNvdmVyeSwgd2UgY2FuJ3QgcmVzdG9yZSB0aGUgZXhhY3Qgc3RhdGVcbiAgICAgIC8vIFVzZXIgd2lsbCBuZWVkIHRvIHJlc3RhcnQgdGhlIGRyYWZ0IGdlbmVyYXRpb25cbiAgICAgIHNldElzUmVzdG9yaW5nSm9icyhmYWxzZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIFByb2Nlc3MgZHJhZnQgam9icyBmaXJzdCB0byByZXN0b3JlIGRyYWZ0IHN0YXRlXG4gICAgaWYgKGRyYWZ0Sm9icy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OqCBGb3VuZCAke2RyYWZ0Sm9icy5sZW5ndGh9IGRyYWZ0IGpvYnMgdG8gcmVzdG9yZWApO1xuICAgICAgXG4gICAgICAvLyBDb2xsZWN0IGFsbCBkcmFmdCBjYXJkcyBmcm9tIGFsbCBkcmFmdCBqb2JzXG4gICAgICBjb25zdCBkcmFmdHNCeUluZGV4OiAoR2VuZXJhdGVkQ2FyZCB8IG51bGwpW10gPSBuZXcgQXJyYXkoNSkuZmlsbChudWxsKTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCB7IGpvYiB9IG9mIGRyYWZ0Sm9icykge1xuICAgICAgICBpZiAoam9iLmRyYWZ0Q2FyZHMgJiYgQXJyYXkuaXNBcnJheShqb2IuZHJhZnRDYXJkcykgJiYgam9iLmRyYWZ0Q2FyZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGRyYWZ0Q2FyZCA9IGpvYi5kcmFmdENhcmRzWzBdOyAvLyBFYWNoIGpvYiBzdG9yZXMgb25lIGRyYWZ0XG4gICAgICAgICAgY29uc3QgZHJhZnRJbmRleCA9IGpvYi5kcmFmdEluZGV4O1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChkcmFmdEluZGV4ID49IDAgJiYgZHJhZnRJbmRleCA8IDUpIHtcbiAgICAgICAgICAgIGRyYWZ0c0J5SW5kZXhbZHJhZnRJbmRleF0gPSBkcmFmdENhcmQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEdldCBub24tbnVsbCBkcmFmdHMgZm9yIGNvdW50aW5nXG4gICAgICBjb25zdCBhbGxEcmFmdENhcmRzID0gZHJhZnRzQnlJbmRleC5maWx0ZXIoQm9vbGVhbikgYXMgR2VuZXJhdGVkQ2FyZFtdO1xuICAgICAgXG4gICAgICAvLyBSZXN0b3JlIGFsbCBkcmFmdCBjYXJkcyBhdCBvbmNlXG4gICAgICBpZiAoYWxsRHJhZnRDYXJkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJlc3RvcmluZyAke2FsbERyYWZ0Q2FyZHMubGVuZ3RofSBkcmFmdCBjYXJkcyBmcm9tICR7ZHJhZnRKb2JzLmxlbmd0aH0gam9ic2ApO1xuICAgICAgICAvLyBPbmx5IHNldCBkcmFmdCBtb2RlIHdoZW4gd2UgaGF2ZSBhY3R1YWwgY2FyZHNcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfjq8gU2V0dGluZyBpc0RyYWZ0TW9kZSB0byB0cnVlIC0gZHJhZnQgY2FyZHMgZm91bmQnKTtcbiAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldElzRHJhZnRNb2RlKHRydWUpO1xuICAgICAgICBcbiAgICAgICAgLy8gVXNlIHRoZSBkcmFmdHNCeUluZGV4IHdoaWNoIGFscmVhZHkgaGFzIGRyYWZ0cyBhdCBjb3JyZWN0IHBvc2l0aW9uc1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDYXJkcyhkcmFmdHNCeUluZGV4KTtcbiAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldERyYWZ0Q29tcGxldGlvbkNvdW50KGFsbERyYWZ0Q2FyZHMubGVuZ3RoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCBhcHByb3ByaWF0ZSBwcm9ncmVzcyBzdGF0ZVxuICAgICAgICBpZiAoYWxsRHJhZnRDYXJkcy5sZW5ndGggPT09IDUpIHtcbiAgICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDb21wbGV0aW9uU2hvd24odHJ1ZSk7XG4gICAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZyhmYWxzZSk7XG4gICAgICAgICAgY2FyZEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nKGZhbHNlKTtcbiAgICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzKFwiXCIpO1xuICAgICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25Qcm9ncmVzcyhcIlwiKTtcbiAgICAgICAgICAvLyBUaW1lLWJhc2VkIHByb2dyZXNzIHdpbGwgYmUgY2xlYXJlZCBhYm92ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcodHJ1ZSk7XG4gICAgICAgICAgY2FyZEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nKHRydWUpO1xuICAgICAgICAgIGNvbnN0IHByb2dyZXNzTXNnID0gYOKcqCAke2FsbERyYWZ0Q2FyZHMubGVuZ3RofS81IGZyb250IGNvdmVyIHZhcmlhdGlvbnMgY29tcGxldGUuLi4gJHthbGxEcmFmdENhcmRzLmxlbmd0aCA+PSAyID8gXCJZb3UgY2FuIHNlbGVjdCBvbmUgbm93IHRvIHByb2NlZWQhXCIgOiBcIlwifWA7XG4gICAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25Qcm9ncmVzcyhwcm9ncmVzc01zZyk7XG4gICAgICAgICAgY2FyZEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzKHByb2dyZXNzTXNnKTtcbiAgICAgICAgICAvLyBEb24ndCBvdmVycmlkZSB0aW1lLWJhc2VkIHByb2dyZXNzXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgbm8gZHJhZnQgY2FyZHMgd2VyZSBmb3VuZCBidXQgd2UgaGF2ZSBkcmFmdCBqb2JzLCBzZXQgYXBwcm9wcmlhdGUgc3RhdGVcbiAgICAgIGlmIChhbGxEcmFmdENhcmRzLmxlbmd0aCA9PT0gMCAmJiBkcmFmdEpvYnMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+UhCBEcmFmdCBqb2JzIGZvdW5kIGJ1dCBubyBjYXJkcyB5ZXQgLSBzZXR0aW5nIGdlbmVyYXRpb24gc3RhdGUnKTtcbiAgICAgICAgLy8gU2V0IGRyYWZ0IG1vZGUgYW5kIGluaXRpYWxpemUgZW1wdHkgYXJyYXkgZm9yIGRyYWZ0IGpvYnMgaW4gcHJvZ3Jlc3NcbiAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldElzRHJhZnRNb2RlKHRydWUpO1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDYXJkcyhbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF0pO1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nKHRydWUpO1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcodHJ1ZSk7XG4gICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3MoXCLwn46oIENyZWF0aW5nIDUgZnJvbnQgY292ZXIgdmFyaWF0aW9ucyBmb3IgeW91IHRvIGNob29zZSBmcm9tLi4uXCIpO1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3MoXCLwn46oIENyZWF0aW5nIDUgZnJvbnQgY292ZXIgdmFyaWF0aW9ucyBmb3IgeW91IHRvIGNob29zZSBmcm9tLi4uXCIpO1xuICAgICAgICAvLyBEb24ndCByZXNldCBwcm9ncmVzcyAtIGxldCB0aW1lLWJhc2VkIHByb2dyZXNzIGNvbnRpbnVlXG4gICAgICAgIC8vIGpvYk1hbmFnZW1lbnQuc2V0UHJvZ3Jlc3NQZXJjZW50YWdlKDApO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTdWJzY3JpYmUgdG8gYWxsIG5vbi1zdGFsZSBkcmFmdCBqb2JzXG4gICAgICBmb3IgKGNvbnN0IHsgam9iSWQsIGpvYiB9IG9mIGRyYWZ0Sm9icykge1xuICAgICAgICBjb25zdCBqb2JBZ2UgPSBEYXRlLm5vdygpIC0gKGpvYi5jcmVhdGVkQXQgfHwgRGF0ZS5ub3coKSk7XG4gICAgICAgIGNvbnN0IGlzU3RhbGUgPSBqb2JBZ2UgPiA1ICogNjAgKiAxMDAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFpc1N0YWxlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYPCfk6EgU3Vic2NyaWJpbmcgdG8gZHJhZnQgam9iOiAke2pvYklkfSAoaGFzICR7am9iLmRyYWZ0Q2FyZHM/Lmxlbmd0aCB8fCAwfSBjYXJkcylgKTtcbiAgICAgICAgICB3ZWJTb2NrZXQuc3Vic2NyaWJlVG9Kb2Ioam9iSWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFByb2Nlc3MgcmVtYWluaW5nIGpvYnMgKGZpbmFsIGNhcmQgZ2VuZXJhdGlvbilcbiAgICBmb3IgKGNvbnN0IHsgam9iSWQsIGpvYiB9IG9mIGZpbmFsSm9icykge1xuICAgICAgY29uc29sZS5sb2coYPCfk4sgUHJvY2Vzc2luZyBqb2IgJHtqb2JJZH06YCwge1xuICAgICAgICBpc0RyYWZ0OiBqb2JJZC5zdGFydHNXaXRoKCdkcmFmdC0nKSxcbiAgICAgICAgc3RhdHVzOiBqb2Iuc3RhdHVzLFxuICAgICAgICBoYXNQcm9ncmVzczogISFqb2IubGFzdFByb2dyZXNzLFxuICAgICAgICBjcmVhdGVkQXQ6IGpvYi5jcmVhdGVkQXRcbiAgICAgIH0pO1xuICAgICAgLy8gQ2hlY2sgaWYgam9iIGlzIHN0YWxlIChvbGRlciB0aGFuIDUgbWludXRlcyB3aXRob3V0IGNvbXBsZXRpb24pXG4gICAgICBjb25zdCBqb2JBZ2UgPSBEYXRlLm5vdygpIC0gKGpvYi5jcmVhdGVkQXQgfHwgRGF0ZS5ub3coKSk7XG4gICAgICBjb25zdCBpc1N0YWxlID0gam9iQWdlID4gNSAqIDYwICogMTAwMCAmJiBqb2Iuc3RhdHVzICE9PSAnY29tcGxldGVkJztcbiAgICAgIFxuICAgICAgaWYgKGlzU3RhbGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coYPCfp7kgQ2xlYW5pbmcgdXAgc3RhbGUgam9iOiAke2pvYklkfSAoYWdlOiAke01hdGgucm91bmQoam9iQWdlIC8gMTAwMCl9cylgKTtcbiAgICAgICAgam9iTWFuYWdlbWVudC5yZW1vdmVKb2JGcm9tU3RvcmFnZShqb2JJZCk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBSZXN0b3JlIHByb2dyZXNzIGFuZCBzdGF0ZVxuICAgICAgLy8gRG9uJ3QgcmVzdG9yZSBwcm9ncmVzcyAtIGxldCB0aW1lLWJhc2VkIHByb2dyZXNzIGhhbmRsZSBpdFxuICAgICAgLy8gaWYgKGpvYi5sYXN0UHJvZ3Jlc3MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gICBqb2JNYW5hZ2VtZW50LnNldFByb2dyZXNzUGVyY2VudGFnZShqb2IubGFzdFByb2dyZXNzKTtcbiAgICAgIC8vICAgY2FyZEdlbmVyYXRpb24uc2V0UHJvZ3Jlc3NQZXJjZW50YWdlKGpvYi5sYXN0UHJvZ3Jlc3MpO1xuICAgICAgLy8gICBkcmFmdEdlbmVyYXRpb24uc2V0UHJvZ3Jlc3NQZXJjZW50YWdlKGpvYi5sYXN0UHJvZ3Jlc3MpO1xuICAgICAgLy8gfVxuICAgICAgXG4gICAgICAvLyBPbmx5IHJlc3RvcmUgcHJvZ3Jlc3MgdGV4dCBpZiB0aGUgam9iIGlzIG5vdCBjb21wbGV0ZWRcbiAgICAgIC8vIFRoaXMgcHJldmVudHMgc2hvd2luZyBcIkdlbmVyYXRpb24gY29tcGxldGUhICgxMDAlKVwiIGZyb20gb2xkIGNvbXBsZXRlZCBqb2JzXG4gICAgICBpZiAoam9iLmxhc3RQcm9ncmVzc1RleHQgJiYgam9iLnN0YXR1cyAhPT0gJ2NvbXBsZXRlZCcpIHtcbiAgICAgICAgam9iTWFuYWdlbWVudC5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3Moam9iLmxhc3RQcm9ncmVzc1RleHQpO1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRHZW5lcmF0aW9uUHJvZ3Jlc3Moam9iLmxhc3RQcm9ncmVzc1RleHQpO1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzKGpvYi5sYXN0UHJvZ3Jlc3NUZXh0KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmVzdG9yZSBmaW5hbCBjYXJkIGdlbmVyYXRpb24gc3RhdGVcbiAgICAgIGNhcmRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZyh0cnVlKTtcbiAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQodHJ1ZSk7XG4gICAgICBcbiAgICAgIC8vIElmIHdlIGhhdmUgYSBzZWxlY3RlZCBkcmFmdCwgcmVzdG9yZSBpdFxuICAgICAgaWYgKGpvYi5zZWxlY3RlZERyYWZ0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0U2VsZWN0ZWREcmFmdEluZGV4KGpvYi5zZWxlY3RlZERyYWZ0SW5kZXgpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBqb2JNYW5hZ2VtZW50LnNldEN1cnJlbnRKb2JJZChqb2JJZCk7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBlbGFwc2VkIHRpbWUgc2luY2Ugam9iIHN0YXJ0ZWRcbiAgICAgIGNvbnN0IGpvYlN0YXJ0VGltZSA9IGpvYi5jcmVhdGVkQXQgfHwgRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGVsYXBzZWRTaW5jZVN0YXJ0ID0gKERhdGUubm93KCkgLSBqb2JTdGFydFRpbWUpIC8gMTAwMDtcbiAgICAgIFxuICAgICAgLy8gU3RhcnQgZWxhcHNlZCB0aW1lIHRyYWNraW5nXG4gICAgICBqb2JNYW5hZ2VtZW50LnN0YXJ0RWxhcHNlZFRpbWVUcmFja2luZygpO1xuICAgICAgXG4gICAgICAvLyBTdWJzY3JpYmUgdG8gdGhlIGpvYiB1cGRhdGVzXG4gICAgICB3ZWJTb2NrZXQuc3Vic2NyaWJlVG9Kb2Ioam9iSWQpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgam9iIGV4aXN0cyBvbiBiYWNrZW5kXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0JBQ0tFTkRfQVBJX0JBU0VfVVJMfS9hcGkvam9iLXN0YXR1cy8ke2pvYklkfWApO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhg8J+ToSBKb2Igc3RhdHVzIGNoZWNrIGZvciAke2pvYklkfTpgLCB7XG4gICAgICAgICAgb2s6IHJlc3BvbnNlLm9rLFxuICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHJlc3VsdFN0YXR1czogcmVzdWx0LnN0YXR1cyxcbiAgICAgICAgICB1cmw6IGAke0JBQ0tFTkRfQVBJX0JBU0VfVVJMfS9hcGkvam9iLXN0YXR1cy8ke2pvYklkfWBcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ25vdF9mb3VuZCcpIHtcbiAgICAgICAgICAvLyBKb2IgZG9lc24ndCBleGlzdCBvbiBiYWNrZW5kLCBjbGVhbiB1cCBhbmQgbm90aWZ5IHVzZXJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIEpvYiAke2pvYklkfSBub3QgZm91bmQgb24gYmFja2VuZCwgY2xlYW5pbmcgdXAuLi5gKTtcbiAgICAgICAgICBqb2JNYW5hZ2VtZW50LnJlbW92ZUpvYkZyb21TdG9yYWdlKGpvYklkKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBSZXNldCBnZW5lcmF0aW9uIHN0YXRlXG4gICAgICAgICAgaWYgKGlzRHJhZnRKb2IpIHtcbiAgICAgICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcoZmFsc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZ0ZpbmFsQ2FyZChmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3cgaGVscGZ1bCBtZXNzYWdlIHRvIHVzZXJcbiAgICAgICAgICB0b2FzdC5lcnJvcihcbiAgICAgICAgICAgIGBQcmV2aW91cyAke2lzRHJhZnRKb2IgPyAnZHJhZnQnIDogJ2NhcmQnfSBnZW5lcmF0aW9uIGV4cGlyZWQuIFBsZWFzZSBzdGFydCBhIG5ldyBvbmUuYCxcbiAgICAgICAgICAgIHsgZHVyYXRpb246IDUwMDAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSm9iIGV4aXN0cywgc2hvdyByZXN1bWluZyBtZXNzYWdlXG4gICAgICAgICAgdG9hc3QuaW5mbyhgUmVzdW1pbmcgJHtpc0RyYWZ0Sm9iID8gJ2RyYWZ0JyA6ICdjYXJkJ30gZ2VuZXJhdGlvbi4uLmApO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gdmVyaWZ5IGpvYiBzdGF0dXM6JywgZXJyb3IpO1xuICAgICAgICAvLyBDb250aW51ZSBhbnl3YXksIFdlYlNvY2tldCB3aWxsIGhhbmRsZSBpdFxuICAgICAgICB0b2FzdC5pbmZvKGBBdHRlbXB0aW5nIHRvIHJlc3VtZSAke2lzRHJhZnRKb2IgPyAnZHJhZnQnIDogJ2NhcmQnfSBnZW5lcmF0aW9uLi4uYCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFJlc3RvcmF0aW9uIGNvbXBsZXRlIC0gYWxsb3cgV2ViU29ja2V0IHVwZGF0ZXMgdG8gYmUgcHJvY2Vzc2VkXG4gICAgLy8gQWRkIGEgc21hbGwgZGVsYXkgdG8gZW5zdXJlIHN0YXRlIHVwZGF0ZXMgaGF2ZSBwcm9wYWdhdGVkXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIEpvYiByZXN0b3JhdGlvbiBjb21wbGV0ZSwgYWxsb3dpbmcgV2ViU29ja2V0IHVwZGF0ZXMnKTtcbiAgICAgIHNldElzUmVzdG9yaW5nSm9icyhmYWxzZSk7XG4gICAgfSwgMTAwKTtcbiAgfSwgW2pvYk1hbmFnZW1lbnQsIGNhcmRHZW5lcmF0aW9uLCBkcmFmdEdlbmVyYXRpb24sIHdlYlNvY2tldF0pO1xuXG4gIC8vIExvYWQgcmVjb3ZlcnkgZGF0YSBvbiBjb21wb25lbnQgbW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygn8J+agCB1c2VDYXJkU3R1ZGlvIG1vdW50ZWQsIGNoZWNraW5nIGZvciByZWNvdmVyeS4uLicpO1xuICAgIFxuICAgIC8vIENoZWNrIGZvciBhY3RpdmUgcmVjb3Zlcnkgam9iXG4gICAgY29uc3QgcmVjb3ZlcnkgPSBzdG9yYWdlLmdldFJlY292ZXJ5KCk7XG4gICAgXG4gICAgaWYgKHJlY292ZXJ5KSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBGb3VuZCBhY3RpdmUgam9iIHRvIHJlY292ZXI6JywgcmVjb3Zlcnkuam9iSWQpO1xuICAgICAgXG4gICAgICAvLyBSZXN0b3JlIGpvYiBzdGF0ZSBhbmQgc3Vic2NyaWJlIHRvIHVwZGF0ZXNcbiAgICAgIGpvYk1hbmFnZW1lbnQuc2V0Q3VycmVudEpvYklkKHJlY292ZXJ5LmpvYklkKTtcbiAgICAgIHdlYlNvY2tldC5zdWJzY3JpYmVUb0pvYihyZWNvdmVyeS5qb2JJZCk7XG4gICAgICBcbiAgICAgIC8vIFNldCBnZW5lcmF0aW9uIHN0YXRlXG4gICAgICBjb25zdCBpc0RyYWZ0ID0gcmVjb3Zlcnkuam9iSWQuc3RhcnRzV2l0aCgnZHJhZnQtJyk7XG4gICAgICBpZiAoaXNEcmFmdCkge1xuICAgICAgICBkcmFmdEdlbmVyYXRpb24uc2V0SXNEcmFmdE1vZGUodHJ1ZSk7XG4gICAgICAgIGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcodHJ1ZSk7XG4gICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldElzR2VuZXJhdGluZyh0cnVlKTtcbiAgICAgICAgZHJhZnRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25Qcm9ncmVzcygn8J+OqCBSZXN1bWluZyBkcmFmdCBnZW5lcmF0aW9uLi4uJyk7XG4gICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25Qcm9ncmVzcygn8J+OqCBSZXN1bWluZyBkcmFmdCBnZW5lcmF0aW9uLi4uJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYXJkR2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmcodHJ1ZSk7XG4gICAgICAgIGNhcmRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25Qcm9ncmVzcygn8J+OqCBSZXN1bWluZyBjYXJkIGdlbmVyYXRpb24uLi4nKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU3RhcnQgZWxhcHNlZCB0aW1lIHRyYWNraW5nXG4gICAgICBqb2JNYW5hZ2VtZW50LnN0YXJ0RWxhcHNlZFRpbWVUcmFja2luZyhpc0RyYWZ0ID8gJ2RyYWZ0JyA6ICdmaW5hbCcpO1xuICAgIH1cbiAgICBcbiAgICAvLyBBbHdheXMgbWFyayByZXN0b3JhdGlvbiBhcyBjb21wbGV0ZVxuICAgIHNldElzUmVzdG9yaW5nSm9icyhmYWxzZSk7XG4gICAgXG4gICAgLy8gTWFyayByZXN0b3JhdGlvbiBhcyBjb21wbGV0ZSBhZnRlciBhIHNtYWxsIGRlbGF5XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBzZXRJc1Jlc3RvcmluZ0pvYnMoZmFsc2UpO1xuICAgIH0sIDEwMCk7XG4gIH0sIFtdKTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBzdGF0ZSBhbmQgZnVuY3Rpb25zIHRoYXQgdGhlIFVJIG5lZWRzXG4gIHJldHVybiB7XG4gICAgLy8gQ29yZSBzdGF0ZVxuICAgIHByb21wdCxcbiAgICBzZXRQcm9tcHQsXG4gICAgZmluYWxDYXJkTWVzc2FnZTogbWVzc2FnZUdlbmVyYXRpb24uZmluYWxDYXJkTWVzc2FnZSxcbiAgICBzZXRGaW5hbENhcmRNZXNzYWdlOiBtZXNzYWdlR2VuZXJhdGlvbi5zZXRGaW5hbENhcmRNZXNzYWdlLFxuICAgIHRvRmllbGQsXG4gICAgc2V0VG9GaWVsZCxcbiAgICBmcm9tRmllbGQsXG4gICAgc2V0RnJvbUZpZWxkLFxuICAgIHJlbGF0aW9uc2hpcEZpZWxkLFxuICAgIHNldFJlbGF0aW9uc2hpcEZpZWxkLFxuICAgIHNlbGVjdGVkVHlwZSxcbiAgICBzZXRTZWxlY3RlZFR5cGUsXG4gICAgY3VzdG9tQ2FyZFR5cGUsXG4gICAgc2V0Q3VzdG9tQ2FyZFR5cGUsXG4gICAgc2VsZWN0ZWRUb25lLFxuICAgIHNldFNlbGVjdGVkVG9uZSxcbiAgICBpc0dlbmVyYXRpbmc6IGNhcmRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZyB8fCBkcmFmdEdlbmVyYXRpb24uaXNHZW5lcmF0aW5nLFxuICAgIHNldElzR2VuZXJhdGluZzogY2FyZEdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nLFxuICAgIGlzR2VuZXJhdGluZ01lc3NhZ2U6IG1lc3NhZ2VHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ01lc3NhZ2UsXG4gICAgc2V0SXNHZW5lcmF0aW5nTWVzc2FnZTogbWVzc2FnZUdlbmVyYXRpb24uc2V0SXNHZW5lcmF0aW5nTWVzc2FnZSxcbiAgICBnZW5lcmF0ZWRDYXJkOiBjYXJkR2VuZXJhdGlvbi5nZW5lcmF0ZWRDYXJkLFxuICAgIHNldEdlbmVyYXRlZENhcmQ6IGNhcmRHZW5lcmF0aW9uLnNldEdlbmVyYXRlZENhcmQsXG4gICAgbnVtYmVyT2ZDYXJkcyxcbiAgICBzZXROdW1iZXJPZkNhcmRzLFxuICAgIGdlbmVyYXRlZENhcmRzOiBjYXJkR2VuZXJhdGlvbi5nZW5lcmF0ZWRDYXJkcyxcbiAgICBzZXRHZW5lcmF0ZWRDYXJkczogY2FyZEdlbmVyYXRpb24uc2V0R2VuZXJhdGVkQ2FyZHMsXG4gICAgc2VsZWN0ZWRDYXJkSW5kZXg6IGNhcmRHZW5lcmF0aW9uLnNlbGVjdGVkQ2FyZEluZGV4LFxuICAgIHNldFNlbGVjdGVkQ2FyZEluZGV4OiBjYXJkR2VuZXJhdGlvbi5zZXRTZWxlY3RlZENhcmRJbmRleCxcbiAgICBcbiAgICAvLyBBZHZhbmNlZCBvcHRpb25zXG4gICAgc2hvd0FkdmFuY2VkLFxuICAgIHNldFNob3dBZHZhbmNlZCxcbiAgICBzZWxlY3RlZEFydGlzdGljU3R5bGUsXG4gICAgc2V0U2VsZWN0ZWRBcnRpc3RpY1N0eWxlLFxuICAgIGN1c3RvbVN0eWxlRGVzY3JpcHRpb24sXG4gICAgc2V0Q3VzdG9tU3R5bGVEZXNjcmlwdGlvbixcbiAgICBzZWxlY3RlZEltYWdlTW9kZWwsXG4gICAgc2V0U2VsZWN0ZWRJbWFnZU1vZGVsLFxuICAgIHNlbGVjdGVkRHJhZnRNb2RlbCxcbiAgICBzZXRTZWxlY3RlZERyYWZ0TW9kZWwsXG4gICAgXG4gICAgLy8gRHJhZnQgbW9kZVxuICAgIGlzRHJhZnRNb2RlOiBkcmFmdEdlbmVyYXRpb24uaXNEcmFmdE1vZGUsXG4gICAgc2V0SXNEcmFmdE1vZGU6IGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0RyYWZ0TW9kZSxcbiAgICBkcmFmdENhcmRzOiBkcmFmdEdlbmVyYXRpb24uZHJhZnRDYXJkcyxcbiAgICBzZXREcmFmdENhcmRzOiBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDYXJkcyxcbiAgICBzZWxlY3RlZERyYWZ0SW5kZXg6IGRyYWZ0R2VuZXJhdGlvbi5zZWxlY3RlZERyYWZ0SW5kZXgsXG4gICAgc2V0U2VsZWN0ZWREcmFmdEluZGV4OiBkcmFmdEdlbmVyYXRpb24uc2V0U2VsZWN0ZWREcmFmdEluZGV4LFxuICAgIGlzR2VuZXJhdGluZ0ZpbmFsQ2FyZDogZHJhZnRHZW5lcmF0aW9uLmlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCxcbiAgICBzZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQ6IGRyYWZ0R2VuZXJhdGlvbi5zZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQsXG4gICAgcHJldmlld2luZ0RyYWZ0SW5kZXg6IGRyYWZ0R2VuZXJhdGlvbi5wcmV2aWV3aW5nRHJhZnRJbmRleCxcbiAgICBzZXRQcmV2aWV3aW5nRHJhZnRJbmRleDogZHJhZnRHZW5lcmF0aW9uLnNldFByZXZpZXdpbmdEcmFmdEluZGV4LFxuICAgIGRyYWZ0Q29tcGxldGlvblNob3duOiBkcmFmdEdlbmVyYXRpb24uZHJhZnRDb21wbGV0aW9uU2hvd24sXG4gICAgc2V0RHJhZnRDb21wbGV0aW9uU2hvd246IGRyYWZ0R2VuZXJhdGlvbi5zZXREcmFmdENvbXBsZXRpb25TaG93bixcbiAgICBkcmFmdENvbXBsZXRpb25Db3VudDogZHJhZnRHZW5lcmF0aW9uLmRyYWZ0Q29tcGxldGlvbkNvdW50LFxuICAgIHNldERyYWZ0Q29tcGxldGlvbkNvdW50OiBkcmFmdEdlbmVyYXRpb24uc2V0RHJhZnRDb21wbGV0aW9uQ291bnQsXG4gICAgXG4gICAgLy8gUHJvZ3Jlc3MgdHJhY2tpbmdcbiAgICBnZW5lcmF0aW9uUHJvZ3Jlc3M6IGRyYWZ0R2VuZXJhdGlvbi5pc0dlbmVyYXRpbmcgPyBkcmFmdEdlbmVyYXRpb24uZ2VuZXJhdGlvblByb2dyZXNzIDogY2FyZEdlbmVyYXRpb24uZ2VuZXJhdGlvblByb2dyZXNzLFxuICAgIHNldEdlbmVyYXRpb25Qcm9ncmVzczogY2FyZEdlbmVyYXRpb24uc2V0R2VuZXJhdGlvblByb2dyZXNzLFxuICAgIHByb2dyZXNzUGVyY2VudGFnZTogam9iTWFuYWdlbWVudC5wcm9ncmVzc1BlcmNlbnRhZ2UsIC8vIFNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggYmFzZWQgb24gZWxhcHNlZCB0aW1lXG4gICAgaXNDYXJkQ29tcGxldGVkOiBjYXJkR2VuZXJhdGlvbi5pc0NhcmRDb21wbGV0ZWQsXG4gICAgc2V0SXNDYXJkQ29tcGxldGVkOiBjYXJkR2VuZXJhdGlvbi5zZXRJc0NhcmRDb21wbGV0ZWQsXG4gICAgXG4gICAgLy8gVXBsb2FkIGFuZCBwZXJzb25hbGl6YXRpb25cbiAgICByZWZlcmVuY2VJbWFnZXM6IGZpbGVIYW5kbGluZy5yZWZlcmVuY2VJbWFnZXMsXG4gICAgc2V0UmVmZXJlbmNlSW1hZ2VzOiBmaWxlSGFuZGxpbmcuc2V0UmVmZXJlbmNlSW1hZ2VzLFxuICAgIHJlZmVyZW5jZUltYWdlVXJsczogZmlsZUhhbmRsaW5nLnJlZmVyZW5jZUltYWdlVXJscyxcbiAgICBzZXRSZWZlcmVuY2VJbWFnZVVybHM6IGZpbGVIYW5kbGluZy5zZXRSZWZlcmVuY2VJbWFnZVVybHMsXG4gICAgaW1hZ2VUcmFuc2Zvcm1hdGlvbjogZmlsZUhhbmRsaW5nLmltYWdlVHJhbnNmb3JtYXRpb24sXG4gICAgc2V0SW1hZ2VUcmFuc2Zvcm1hdGlvbjogZmlsZUhhbmRsaW5nLnNldEltYWdlVHJhbnNmb3JtYXRpb24sXG4gICAgaXNVcGxvYWRpbmc6IGZpbGVIYW5kbGluZy5pc1VwbG9hZGluZyxcbiAgICBzZXRJc1VwbG9hZGluZzogZmlsZUhhbmRsaW5nLnNldElzVXBsb2FkaW5nLFxuICAgIFxuICAgIC8vIEVtYWlsIGFuZCBzZXR0aW5nc1xuICAgIHVzZXJFbWFpbCxcbiAgICBzZXRVc2VyRW1haWwsXG4gICAgaXNIYW5kd3JpdHRlbk1lc3NhZ2UsXG4gICAgc2V0SXNIYW5kd3JpdHRlbk1lc3NhZ2UsXG4gICAgaXNGcm9udEJhY2tPbmx5LFxuICAgIHNldElzRnJvbnRCYWNrT25seSxcbiAgICBzZWxlY3RlZFBhcGVyU2l6ZSxcbiAgICBzZXRTZWxlY3RlZFBhcGVyU2l6ZSxcbiAgICBcbiAgICAvLyBVSSBzdGF0ZVxuICAgIGlzVGV4dGFyZWFFeHBhbmRlZCxcbiAgICBzZXRJc1RleHRhcmVhRXhwYW5kZWQsXG4gICAgaXNNZXNzYWdlRXhwYW5kZWQsXG4gICAgc2V0SXNNZXNzYWdlRXhwYW5kZWQsXG4gICAgc2hvd1NldHRpbmdzLFxuICAgIHNldFNob3dTZXR0aW5ncyxcbiAgICBzaG93VGVtcGxhdGVHYWxsZXJ5LFxuICAgIHNldFNob3dUZW1wbGF0ZUdhbGxlcnksXG4gICAgc2hvd1ByaW50Q29uZmlybWF0aW9uLFxuICAgIHNldFNob3dQcmludENvbmZpcm1hdGlvbixcbiAgICBcbiAgICAvLyBHZW5lcmF0aW9uIHRpbWVcbiAgICBnZW5lcmF0aW9uRHVyYXRpb246IGNhcmRHZW5lcmF0aW9uLmdlbmVyYXRpb25EdXJhdGlvbixcbiAgICBzZXRHZW5lcmF0aW9uRHVyYXRpb246IGNhcmRHZW5lcmF0aW9uLnNldEdlbmVyYXRpb25EdXJhdGlvbixcbiAgICBjdXJyZW50RWxhcHNlZFRpbWU6IGpvYk1hbmFnZW1lbnQuY3VycmVudEVsYXBzZWRUaW1lLFxuICAgIHNldEN1cnJlbnRFbGFwc2VkVGltZTogam9iTWFuYWdlbWVudC5zZXRDdXJyZW50RWxhcHNlZFRpbWUsXG4gICAgXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uc1xuICAgIGZvcm1hdEdlbmVyYXRpb25UaW1lLFxuICAgIGZvcm1hdENvdW50ZG93bixcbiAgICBzZW5kVGhhbmtZb3VFbWFpbCxcbiAgICBjaGF0V2l0aEFJLFxuICAgIHNjcm9sbFRvQ2FyZFByZXZpZXcsXG4gICAgXG4gICAgLy8gVGltZSB0cmFja2luZyBmdW5jdGlvbnNcbiAgICBzdGFydEVsYXBzZWRUaW1lVHJhY2tpbmc6IGpvYk1hbmFnZW1lbnQuc3RhcnRFbGFwc2VkVGltZVRyYWNraW5nLFxuICAgIHN0b3BFbGFwc2VkVGltZVRyYWNraW5nOiBqb2JNYW5hZ2VtZW50LnN0b3BFbGFwc2VkVGltZVRyYWNraW5nLFxuICAgIFxuICAgIC8vIEZpbGUgaGFuZGxpbmcgZnVuY3Rpb25zXG4gICAgaGFuZGxlRmlsZVVwbG9hZDogZmlsZUhhbmRsaW5nLmhhbmRsZUZpbGVVcGxvYWQsXG4gICAgaGFuZGxlUmVtb3ZlUmVmZXJlbmNlSW1hZ2U6IGZpbGVIYW5kbGluZy5oYW5kbGVSZW1vdmVSZWZlcmVuY2VJbWFnZSxcbiAgICBcbiAgICAvLyBTaW1wbGlmaWVkIHBob3RvIHJlZmVyZW5jZXNcbiAgICBwaG90b1JlZmVyZW5jZXM6IGZpbGVIYW5kbGluZy5waG90b1JlZmVyZW5jZXMsXG4gICAgc2V0UGhvdG9SZWZlcmVuY2VzOiBmaWxlSGFuZGxpbmcuc2V0UGhvdG9SZWZlcmVuY2VzLFxuICAgIHVwZGF0ZVBob3RvRGVzY3JpcHRpb246IGZpbGVIYW5kbGluZy51cGRhdGVQaG90b0Rlc2NyaXB0aW9uLFxuICAgIFxuICAgIC8vIE1lc3NhZ2UgZnVuY3Rpb25zXG4gICAgaGFuZGxlR2V0TWVzc2FnZUhlbHA6IG1lc3NhZ2VHZW5lcmF0aW9uLmhhbmRsZUdldE1lc3NhZ2VIZWxwLFxuICAgIGFkZE1lc3NhZ2VUb0hpc3Rvcnk6IG1lc3NhZ2VHZW5lcmF0aW9uLmFkZE1lc3NhZ2VUb0hpc3RvcnksXG4gICAgdW5kb01lc3NhZ2U6IG1lc3NhZ2VHZW5lcmF0aW9uLnVuZG9NZXNzYWdlLFxuICAgIHJlZG9NZXNzYWdlOiBtZXNzYWdlR2VuZXJhdGlvbi5yZWRvTWVzc2FnZSxcbiAgICBcbiAgICAvLyBKb2IgbWFuYWdlbWVudFxuICAgIHNhdmVKb2JUb1N0b3JhZ2U6IGpvYk1hbmFnZW1lbnQuc2F2ZUpvYlRvU3RvcmFnZSxcbiAgICByZW1vdmVKb2JGcm9tU3RvcmFnZTogam9iTWFuYWdlbWVudC5yZW1vdmVKb2JGcm9tU3RvcmFnZSxcbiAgICBjaGVja1BlbmRpbmdKb2JzLFxuICAgIGlzUmVzdG9yaW5nSm9icyxcbiAgICBcbiAgICAvLyBNYWluIGdlbmVyYXRpb24gZnVuY3Rpb25zXG4gICAgaGFuZGxlR2VuZXJhdGVDYXJkQXN5bmM6IGNhcmRHZW5lcmF0aW9uLmhhbmRsZUdlbmVyYXRlQ2FyZEFzeW5jLFxuICAgIGhhbmRsZUdlbmVyYXRlRHJhZnRDYXJkczogZHJhZnRHZW5lcmF0aW9uLmhhbmRsZUdlbmVyYXRlRHJhZnRDYXJkcyxcbiAgICBoYW5kbGVHZW5lcmF0ZUZpbmFsRnJvbURyYWZ0OiBkcmFmdEdlbmVyYXRpb24uaGFuZGxlR2VuZXJhdGVGaW5hbEZyb21EcmFmdCxcbiAgICBcbiAgICAvLyBBZGRpdGlvbmFsIHN0YXRlIGZvciBtZXNzYWdlIHJlZmluZW1lbnRcbiAgICBtZXNzYWdlSGlzdG9yeTogbWVzc2FnZUdlbmVyYXRpb24ubWVzc2FnZUhpc3RvcnksXG4gICAgc2V0TWVzc2FnZUhpc3Rvcnk6IG1lc3NhZ2VHZW5lcmF0aW9uLnNldE1lc3NhZ2VIaXN0b3J5LFxuICAgIGN1cnJlbnRNZXNzYWdlSW5kZXg6IG1lc3NhZ2VHZW5lcmF0aW9uLmN1cnJlbnRNZXNzYWdlSW5kZXgsXG4gICAgc2V0Q3VycmVudE1lc3NhZ2VJbmRleDogbWVzc2FnZUdlbmVyYXRpb24uc2V0Q3VycmVudE1lc3NhZ2VJbmRleCxcbiAgICByZWZpbmVtZW50UHJvbXB0OiBtZXNzYWdlR2VuZXJhdGlvbi5yZWZpbmVtZW50UHJvbXB0LFxuICAgIHNldFJlZmluZW1lbnRQcm9tcHQ6IG1lc3NhZ2VHZW5lcmF0aW9uLnNldFJlZmluZW1lbnRQcm9tcHQsXG4gICAgaXNSZWZpbmluZ01lc3NhZ2U6IG1lc3NhZ2VHZW5lcmF0aW9uLmlzUmVmaW5pbmdNZXNzYWdlLFxuICAgIHNldElzUmVmaW5pbmdNZXNzYWdlOiBtZXNzYWdlR2VuZXJhdGlvbi5zZXRJc1JlZmluaW5nTWVzc2FnZSxcbiAgICBzaG93UmVmaW5lbWVudEJveDogbWVzc2FnZUdlbmVyYXRpb24uc2hvd1JlZmluZW1lbnRCb3gsXG4gICAgc2V0U2hvd1JlZmluZW1lbnRCb3g6IG1lc3NhZ2VHZW5lcmF0aW9uLnNldFNob3dSZWZpbmVtZW50Qm94LFxuICAgIFxuICAgIC8vIFRlbXBsYXRlIHN0YXRlXG4gICAgc2hvd1RlbXBsYXRlQ3VzdG9taXphdGlvbixcbiAgICBzZXRTaG93VGVtcGxhdGVDdXN0b21pemF0aW9uLFxuICAgIHNlbGVjdGVkVGVtcGxhdGUsXG4gICAgc2V0U2VsZWN0ZWRUZW1wbGF0ZSxcbiAgICB0ZW1wbGF0ZUN1c3RvbWl6YXRpb25zLFxuICAgIHNldFRlbXBsYXRlQ3VzdG9taXphdGlvbnMsXG4gICAgdGVtcGxhdGVTZWFyY2hRdWVyeSxcbiAgICBzZXRUZW1wbGF0ZVNlYXJjaFF1ZXJ5LFxuICAgIGlzU2VhcmNoaW5nVGVtcGxhdGVzLFxuICAgIHNldElzU2VhcmNoaW5nVGVtcGxhdGVzLFxuICAgIGFpRmlsdGVyZWRDYXJkcyxcbiAgICBzZXRBaUZpbHRlcmVkQ2FyZHMsXG4gICAgc2VhcmNoTW9kZSxcbiAgICBzZXRTZWFyY2hNb2RlLFxuICAgIHRleHRGaWx0ZXJlZENhcmRzLFxuICAgIHNldFRleHRGaWx0ZXJlZENhcmRzLFxuICAgIHNob3dQcm9tcHRzLFxuICAgIHNldFNob3dQcm9tcHRzLFxuICAgIFxuICAgIC8vIFByaW50IHN0YXRlXG4gICAgcHJpbnRPcHRpb24sXG4gICAgc2V0UHJpbnRPcHRpb24sXG4gICAgXG4gICAgLy8gQWRkaXRpb25hbCBkcmFmdCBtb2RlIHN0YXRlXG4gICAgaGFuZHdyaXRpbmdTYW1wbGU6IGZpbGVIYW5kbGluZy5oYW5kd3JpdGluZ1NhbXBsZSxcbiAgICBzZXRIYW5kd3JpdGluZ1NhbXBsZTogZmlsZUhhbmRsaW5nLnNldEhhbmR3cml0aW5nU2FtcGxlLFxuICAgIGhhbmR3cml0aW5nU2FtcGxlVXJsOiBmaWxlSGFuZGxpbmcuaGFuZHdyaXRpbmdTYW1wbGVVcmwsXG4gICAgc2V0SGFuZHdyaXRpbmdTYW1wbGVVcmw6IGZpbGVIYW5kbGluZy5zZXRIYW5kd3JpdGluZ1NhbXBsZVVybCxcbiAgICBcbiAgICBcbiAgICAvLyBKb2IgdHJhY2tpbmdcbiAgICBjdXJyZW50Sm9iSWQ6IGpvYk1hbmFnZW1lbnQuY3VycmVudEpvYklkLFxuICAgIHNldEN1cnJlbnRKb2JJZDogam9iTWFuYWdlbWVudC5zZXRDdXJyZW50Sm9iSWQsXG4gICAgY291bnRkb3duLFxuICAgIHNldENvdW50ZG93bixcbiAgICBjb3VudGRvd25JbnRlcnZhbCxcbiAgICBzZXRDb3VudGRvd25JbnRlcnZhbCxcbiAgICBcbiAgICAvLyBTZWN0aW9uIGxvYWRpbmcgc3RhdGVzXG4gICAgc2VjdGlvbkxvYWRpbmdTdGF0ZXMsXG4gICAgc2V0U2VjdGlvbkxvYWRpbmdTdGF0ZXMsXG4gICAgXG4gICAgLy8gRmFzdCBwcmV2aWV3IG1vZGVcbiAgICBmYXN0UHJldmlld01vZGUsXG4gICAgc2V0RmFzdFByZXZpZXdNb2RlLFxuICAgIFxuICAgIC8vIEFkZGl0aW9uYWwgdHJhY2tpbmdcbiAgICBjdXJyZW50Q2FyZElkOiBjYXJkR2VuZXJhdGlvbi5jdXJyZW50Q2FyZElkLFxuICAgIHNldEN1cnJlbnRDYXJkSWQ6IGNhcmRHZW5lcmF0aW9uLnNldEN1cnJlbnRDYXJkSWQsXG4gICAgaXNJbml0aWFsTG9hZENvbXBsZXRlLFxuICAgIHNldElzSW5pdGlhbExvYWRDb21wbGV0ZSxcbiAgICBcbiAgICAvLyBFbGFwc2VkIHRpbWUgdHJhY2tpbmdcbiAgICBnZW5lcmF0aW9uU3RhcnRUaW1lOiBqb2JNYW5hZ2VtZW50LmdlbmVyYXRpb25TdGFydFRpbWUsXG4gICAgc2V0R2VuZXJhdGlvblN0YXJ0VGltZTogam9iTWFuYWdlbWVudC5zZXRHZW5lcmF0aW9uU3RhcnRUaW1lLFxuICAgIGVsYXBzZWRUaW1lSW50ZXJ2YWw6IGpvYk1hbmFnZW1lbnQuZWxhcHNlZFRpbWVJbnRlcnZhbCxcbiAgICBzZXRFbGFwc2VkVGltZUludGVydmFsOiBqb2JNYW5hZ2VtZW50LnNldEVsYXBzZWRUaW1lSW50ZXJ2YWwsXG4gICAgXG4gICAgLy8gQ29uc3RhbnRzIGZvciBVSVxuICAgIGNhcmRUb25lcyxcbiAgICBhcnRpc3RpY1N0eWxlcyxcbiAgICBwYXBlclNpemVzLFxuICAgIFxuICAgIC8vIFdlYlNvY2tldCBmdW5jdGlvbnMgYW5kIHN0YXRlXG4gICAgaXNTb2NrZXRDb25uZWN0ZWQ6IHdlYlNvY2tldC5pc1NvY2tldENvbm5lY3RlZCxcbiAgICBjb25uZWN0V2ViU29ja2V0OiB3ZWJTb2NrZXQuY29ubmVjdFdlYlNvY2tldCxcbiAgICBkaXNjb25uZWN0V2ViU29ja2V0OiB3ZWJTb2NrZXQuZGlzY29ubmVjdFdlYlNvY2tldCxcbiAgICBzdWJzY3JpYmVUb0pvYjogd2ViU29ja2V0LnN1YnNjcmliZVRvSm9iLFxuICAgIHVuc3Vic2NyaWJlRnJvbUpvYjogd2ViU29ja2V0LnVuc3Vic2NyaWJlRnJvbUpvYixcbiAgICBoYW5kbGVKb2JVcGRhdGUsXG4gICAgaGFuZGxlRmluYWxDYXJkQ29tcGxldGlvbjogY2FyZEdlbmVyYXRpb24uaGFuZGxlRmluYWxDYXJkQ29tcGxldGlvbixcbiAgfTtcbn0iXSwibmFtZXMiOlsidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJ1c2VDYWxsYmFjayIsInVzZVJlZiIsInRvYXN0IiwidXNlV2ViU29ja2V0IiwidXNlSm9iTWFuYWdlbWVudCIsInVzZU1lc3NhZ2VHZW5lcmF0aW9uIiwidXNlRmlsZUhhbmRsaW5nIiwidXNlRHJhZnRHZW5lcmF0aW9uIiwidXNlQ2FyZEdlbmVyYXRpb24iLCJjYXJkVG9uZXMiLCJhcnRpc3RpY1N0eWxlcyIsInBhcGVyU2l6ZXMiLCJmb3JtYXRHZW5lcmF0aW9uVGltZSIsImZvcm1hdENvdW50ZG93biIsInNlbmRUaGFua1lvdUVtYWlsIiwiY2hhdFdpdGhBSSIsInNjcm9sbFRvQ2FyZFByZXZpZXciLCJzdG9yYWdlIiwidXNlQ2FyZFN0dWRpbyIsInByb21wdCIsInNldFByb21wdCIsInRvRmllbGQiLCJzZXRUb0ZpZWxkIiwiZnJvbUZpZWxkIiwic2V0RnJvbUZpZWxkIiwicmVsYXRpb25zaGlwRmllbGQiLCJzZXRSZWxhdGlvbnNoaXBGaWVsZCIsInNlbGVjdGVkVHlwZSIsInNldFNlbGVjdGVkVHlwZSIsImN1c3RvbUNhcmRUeXBlIiwic2V0Q3VzdG9tQ2FyZFR5cGUiLCJzZWxlY3RlZFRvbmUiLCJzZXRTZWxlY3RlZFRvbmUiLCJzaG93QWR2YW5jZWQiLCJzZXRTaG93QWR2YW5jZWQiLCJzZWxlY3RlZEFydGlzdGljU3R5bGUiLCJzZXRTZWxlY3RlZEFydGlzdGljU3R5bGUiLCJjdXN0b21TdHlsZURlc2NyaXB0aW9uIiwic2V0Q3VzdG9tU3R5bGVEZXNjcmlwdGlvbiIsInNlbGVjdGVkSW1hZ2VNb2RlbCIsInNldFNlbGVjdGVkSW1hZ2VNb2RlbCIsInNlbGVjdGVkRHJhZnRNb2RlbCIsInNldFNlbGVjdGVkRHJhZnRNb2RlbCIsImZhc3RQcmV2aWV3TW9kZSIsInNldEZhc3RQcmV2aWV3TW9kZSIsInVzZXJFbWFpbCIsInNldFVzZXJFbWFpbCIsIm51bWJlck9mQ2FyZHMiLCJzZXROdW1iZXJPZkNhcmRzIiwiaXNIYW5kd3JpdHRlbk1lc3NhZ2UiLCJzZXRJc0hhbmR3cml0dGVuTWVzc2FnZSIsImlzRnJvbnRCYWNrT25seSIsInNldElzRnJvbnRCYWNrT25seSIsInNlbGVjdGVkUGFwZXJTaXplIiwic2V0U2VsZWN0ZWRQYXBlclNpemUiLCJpc1RleHRhcmVhRXhwYW5kZWQiLCJzZXRJc1RleHRhcmVhRXhwYW5kZWQiLCJpc01lc3NhZ2VFeHBhbmRlZCIsInNldElzTWVzc2FnZUV4cGFuZGVkIiwic2hvd1NldHRpbmdzIiwic2V0U2hvd1NldHRpbmdzIiwic2hvd1RlbXBsYXRlR2FsbGVyeSIsInNldFNob3dUZW1wbGF0ZUdhbGxlcnkiLCJzaG93UHJpbnRDb25maXJtYXRpb24iLCJzZXRTaG93UHJpbnRDb25maXJtYXRpb24iLCJzaG93VGVtcGxhdGVDdXN0b21pemF0aW9uIiwic2V0U2hvd1RlbXBsYXRlQ3VzdG9taXphdGlvbiIsImlzUmVzdG9yaW5nSm9icyIsInNldElzUmVzdG9yaW5nSm9icyIsInNlbGVjdGVkVGVtcGxhdGUiLCJzZXRTZWxlY3RlZFRlbXBsYXRlIiwiaXNJbml0aWFsTG9hZENvbXBsZXRlIiwic2V0SXNJbml0aWFsTG9hZENvbXBsZXRlIiwidGVtcGxhdGVTZWFyY2hRdWVyeSIsInNldFRlbXBsYXRlU2VhcmNoUXVlcnkiLCJpc1NlYXJjaGluZ1RlbXBsYXRlcyIsInNldElzU2VhcmNoaW5nVGVtcGxhdGVzIiwiYWlGaWx0ZXJlZENhcmRzIiwic2V0QWlGaWx0ZXJlZENhcmRzIiwic2VhcmNoTW9kZSIsInNldFNlYXJjaE1vZGUiLCJ0ZXh0RmlsdGVyZWRDYXJkcyIsInNldFRleHRGaWx0ZXJlZENhcmRzIiwic2hvd1Byb21wdHMiLCJzZXRTaG93UHJvbXB0cyIsInByaW50T3B0aW9uIiwic2V0UHJpbnRPcHRpb24iLCJ0ZW1wbGF0ZUN1c3RvbWl6YXRpb25zIiwic2V0VGVtcGxhdGVDdXN0b21pemF0aW9ucyIsInByb21wdENoYW5nZXMiLCJtZXNzYWdlQ2hhbmdlcyIsInVzZVJlZmVyZW5jZUltYWdlIiwicmVmZXJlbmNlSW1hZ2VGaWxlIiwicmVmZXJlbmNlSW1hZ2VVcmxzIiwicmVmZXJlbmNlSW1hZ2VUcmFuc2Zvcm1hdGlvbiIsInNlY3Rpb25Mb2FkaW5nU3RhdGVzIiwic2V0U2VjdGlvbkxvYWRpbmdTdGF0ZXMiLCJmcm9udENvdmVyIiwiYmFja0NvdmVyIiwibGVmdEludGVyaW9yIiwicmlnaHRJbnRlcmlvciIsImNvdW50ZG93biIsInNldENvdW50ZG93biIsImNvdW50ZG93bkludGVydmFsIiwic2V0Q291bnRkb3duSW50ZXJ2YWwiLCJ3ZWJTb2NrZXQiLCJqb2JNYW5hZ2VtZW50IiwiZmlsZUhhbmRsaW5nIiwibWVzc2FnZUdlbmVyYXRpb24iLCJwaG90b1JlZmVyZW5jZXMiLCJkcmFmdEdlbmVyYXRpb25Qcm9wcyIsImZpbmFsQ2FyZE1lc3NhZ2UiLCJzYXZlSm9iVG9TdG9yYWdlIiwic3Vic2NyaWJlVG9Kb2IiLCJ1bnN1YnNjcmliZUZyb21BbGxKb2JzIiwic3RhcnRFbGFwc2VkVGltZVRyYWNraW5nIiwic3RvcEVsYXBzZWRUaW1lVHJhY2tpbmciLCJkcmFmdEdlbmVyYXRpb24iLCJjYXJkR2VuZXJhdGlvblByb3BzIiwicmVtb3ZlSm9iRnJvbVN0b3JhZ2UiLCJzZXRDdXJyZW50Sm9iSWQiLCJzZXRJc0RyYWZ0TW9kZSIsInNldERyYWZ0Q2FyZHMiLCJzZXRTZWxlY3RlZERyYWZ0SW5kZXgiLCJzZXRJc0dlbmVyYXRpbmdGaW5hbENhcmQiLCJzZXRQcmV2aWV3aW5nRHJhZnRJbmRleCIsInNldERyYWZ0Q29tcGxldGlvblNob3duIiwic2V0RHJhZnRDb21wbGV0aW9uQ291bnQiLCJjYXJkR2VuZXJhdGlvbiIsImhhbmRsZUpvYlVwZGF0ZSIsImRhdGEiLCJqb2JfaWQiLCJzdGF0dXMiLCJwcm9ncmVzcyIsImNhcmREYXRhIiwiZXJyb3IiLCJjb21wbGV0ZWRBdCIsImNvbnNvbGUiLCJsb2ciLCJpc0RyYWZ0Sm9iIiwic3RhcnRzV2l0aCIsImRyYWZ0SW5kZXgiLCJwYXJzZUludCIsInNwbGl0IiwiaXNJbkRyYWZ0TW9kZSIsImlzRHJhZnRNb2RlIiwiaW5jbHVkZXMiLCJzZXRHZW5lcmF0aW9uUHJvZ3Jlc3MiLCJzdHlsZUluZm8iLCJ1bmRlZmluZWQiLCJwcmVkZWZpbmVkU3R5bGVzIiwic3R5bGVMYWJlbHMiLCJsZW5ndGgiLCJzdHlsZU5hbWUiLCJzdHlsZUxhYmVsIiwiZHJhZnRDYXJkIiwiaWQiLCJEYXRlIiwibm93IiwibGVmdFBhZ2UiLCJyaWdodFBhZ2UiLCJjcmVhdGVkQXQiLCJnZW5lcmF0ZWRQcm9tcHRzIiwicHJldiIsInVwZGF0ZWQiLCJwdXNoIiwidXBkYXRlZERyYWZ0cyIsImRyYWZ0Q2FyZHMiLCJjb21wbGV0ZWRDb3VudCIsImZpbHRlciIsIkJvb2xlYW4iLCJwcm9ncmVzc01zZyIsImlzR2VuZXJhdGluZ0ZpbmFsQ2FyZCIsInNldElzR2VuZXJhdGluZyIsInN1Y2Nlc3MiLCJ1bnN1YnNjcmliZUZyb21Kb2IiLCJoYXNDYXJkRGF0YSIsImNhcmREYXRhS2V5cyIsIk9iamVjdCIsImtleXMiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwcGVkQ2FyZERhdGEiLCJoYW5kbGVGaW5hbENhcmRDb21wbGV0aW9uIiwid2FybiIsImN1cnJlbnRKb2JSZWYiLCJjdXJyZW50IiwiY3VycmVudEpvYklkIiwic2V0Sm9iVXBkYXRlSGFuZGxlciIsInN0YWxlSm9iTG9nZ2VkUmVmIiwiaXNTb2NrZXRDb25uZWN0ZWQiLCJpc0dlbmVyYXRpbmciLCJnZW5lcmF0aW9uU3RhcnRUaW1lIiwiam9iQWdlIiwiam9iSWQiLCJyZWNvbm5lY3RUaW1lciIsInNldFRpbWVvdXQiLCJjb25uZWN0V2ViU29ja2V0IiwiY2xlYXJUaW1lb3V0IiwiY2hlY2tJbnRlcnZhbCIsInNldEludGVydmFsIiwidGltZVNpbmNlTGFzdFVwZGF0ZSIsImxhc3RKb2JVcGRhdGVSZWYiLCJwcm9ncmVzc1BlcmNlbnRhZ2UiLCJNYXRoIiwicm91bmQiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJqb2JTdGF0dXMiLCJqc29uIiwiY2xlYXJJbnRlcnZhbCIsImNoZWNrUGVuZGluZ0pvYnMiLCJyZWNvdmVyeSIsImdldFJlY292ZXJ5IiwiaXNSZWNvdmVyeURyYWZ0IiwiZHJhZnRKb2JzIiwiZHJhZnRzQnlJbmRleCIsIkFycmF5IiwiZmlsbCIsImpvYiIsImlzQXJyYXkiLCJhbGxEcmFmdENhcmRzIiwiaXNTdGFsZSIsImZpbmFsSm9icyIsImlzRHJhZnQiLCJoYXNQcm9ncmVzcyIsImxhc3RQcm9ncmVzcyIsImxhc3RQcm9ncmVzc1RleHQiLCJzZWxlY3RlZERyYWZ0SW5kZXgiLCJqb2JTdGFydFRpbWUiLCJlbGFwc2VkU2luY2VTdGFydCIsIkJBQ0tFTkRfQVBJX0JBU0VfVVJMIiwicmVzdWx0IiwicmVzdWx0U3RhdHVzIiwidXJsIiwiZHVyYXRpb24iLCJpbmZvIiwic2V0RmluYWxDYXJkTWVzc2FnZSIsImlzR2VuZXJhdGluZ01lc3NhZ2UiLCJzZXRJc0dlbmVyYXRpbmdNZXNzYWdlIiwiZ2VuZXJhdGVkQ2FyZCIsInNldEdlbmVyYXRlZENhcmQiLCJnZW5lcmF0ZWRDYXJkcyIsInNldEdlbmVyYXRlZENhcmRzIiwic2VsZWN0ZWRDYXJkSW5kZXgiLCJzZXRTZWxlY3RlZENhcmRJbmRleCIsInByZXZpZXdpbmdEcmFmdEluZGV4IiwiZHJhZnRDb21wbGV0aW9uU2hvd24iLCJkcmFmdENvbXBsZXRpb25Db3VudCIsImdlbmVyYXRpb25Qcm9ncmVzcyIsImlzQ2FyZENvbXBsZXRlZCIsInNldElzQ2FyZENvbXBsZXRlZCIsInJlZmVyZW5jZUltYWdlcyIsInNldFJlZmVyZW5jZUltYWdlcyIsInNldFJlZmVyZW5jZUltYWdlVXJscyIsImltYWdlVHJhbnNmb3JtYXRpb24iLCJzZXRJbWFnZVRyYW5zZm9ybWF0aW9uIiwiaXNVcGxvYWRpbmciLCJzZXRJc1VwbG9hZGluZyIsImdlbmVyYXRpb25EdXJhdGlvbiIsInNldEdlbmVyYXRpb25EdXJhdGlvbiIsImN1cnJlbnRFbGFwc2VkVGltZSIsInNldEN1cnJlbnRFbGFwc2VkVGltZSIsImhhbmRsZUZpbGVVcGxvYWQiLCJoYW5kbGVSZW1vdmVSZWZlcmVuY2VJbWFnZSIsInNldFBob3RvUmVmZXJlbmNlcyIsInVwZGF0ZVBob3RvRGVzY3JpcHRpb24iLCJoYW5kbGVHZXRNZXNzYWdlSGVscCIsImFkZE1lc3NhZ2VUb0hpc3RvcnkiLCJ1bmRvTWVzc2FnZSIsInJlZG9NZXNzYWdlIiwiaGFuZGxlR2VuZXJhdGVDYXJkQXN5bmMiLCJoYW5kbGVHZW5lcmF0ZURyYWZ0Q2FyZHMiLCJoYW5kbGVHZW5lcmF0ZUZpbmFsRnJvbURyYWZ0IiwibWVzc2FnZUhpc3RvcnkiLCJzZXRNZXNzYWdlSGlzdG9yeSIsImN1cnJlbnRNZXNzYWdlSW5kZXgiLCJzZXRDdXJyZW50TWVzc2FnZUluZGV4IiwicmVmaW5lbWVudFByb21wdCIsInNldFJlZmluZW1lbnRQcm9tcHQiLCJpc1JlZmluaW5nTWVzc2FnZSIsInNldElzUmVmaW5pbmdNZXNzYWdlIiwic2hvd1JlZmluZW1lbnRCb3giLCJzZXRTaG93UmVmaW5lbWVudEJveCIsImhhbmR3cml0aW5nU2FtcGxlIiwic2V0SGFuZHdyaXRpbmdTYW1wbGUiLCJoYW5kd3JpdGluZ1NhbXBsZVVybCIsInNldEhhbmR3cml0aW5nU2FtcGxlVXJsIiwiY3VycmVudENhcmRJZCIsInNldEN1cnJlbnRDYXJkSWQiLCJzZXRHZW5lcmF0aW9uU3RhcnRUaW1lIiwiZWxhcHNlZFRpbWVJbnRlcnZhbCIsInNldEVsYXBzZWRUaW1lSW50ZXJ2YWwiLCJkaXNjb25uZWN0V2ViU29ja2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./hooks/useCardStudioRefactored.ts\n"));

/***/ })

});